
## Keyboard

æºç 		ctrl + /

ç›®å½•		[toc]

æ ‡é¢˜		ctrl + æ•°å­—

è¡¨æ ¼		ctrl+t 

æ ‡ç­¾		`code`

ä»£ç å—		ctrl + shift + k

æ°´å¹³çº¿		*** 

è¶…é“¾æ¥		ctrl+k [ç™¾åº¦][www.badu.com] <www.baidu.com>

ä¸‹åˆ’çº¿		ctrl+u

è¡¨æƒ…		ğŸ˜„ 

é«˜äº®		==é«˜äº®==

åŠ ç²—   		 **å†…å®¹**	Ctrl+B 

å€¾æ–œ		*å†…å®¹*  	Ctrl+I 

åˆ é™¤çº¿		~~å†…å®¹~~ 	 Alt+Shift+5 

æ’å…¥å›¾ç‰‡		ctrl+shift+i

æœ‰åºåˆ—è¡¨		æ•°å­—+è‹±æ–‡å°æ•°ç‚¹(.)+ç©ºæ ¼ 

æ— åºåˆ—è¡¨		+ã€- ã€* + ç©ºæ ¼åˆ›å»º



### #IDEAå¿«æ·é”®



Ctrl + R, å¯ä»¥æ›¿æ¢	

Ctrl + H,  æ˜¾ç¤ºç±»ç»“æ„å›¾

Ctrlï¼‹Nï¼Œå¯ä»¥å¿«é€Ÿæ‰“å¼€ç±»

Ctrlï¼‹Eï¼Œå¯ä»¥æ˜¾ç¤ºæœ€è¿‘ç¼–è¾‘çš„æ–‡ä»¶åˆ—è¡¨

Ctrlï¼‹F12ï¼Œå¯ä»¥æ˜¾ç¤ºå½“å‰æ–‡ä»¶çš„ç»“æ„

Ctrlï¼‹Altï¼‹L æ•´ç†ä»£ç 

Ctrl + Alt + R æ•´ä¸ªé¡¹ç›®æœç´¢

Alt+ left/right åˆ‡æ¢ä»£ç è§†å›¾







## æ•°æ®åº“

### äº‹åŠ¡ç‰¹æ€§å’Œéš”ç¦»çº§åˆ«

å‚è€ƒï¼š[äº‹åŠ¡ç‰¹æ€§å’Œéš”ç¦»çº§åˆ«](https://www.cnblogs.com/lztkdr/p/Transaction.html)  [èµ„æ–™è¡¥å……](https://blog.csdn.net/qq_33290787/article/details/51924963)  [å¦‚ä½•ç†è§£ä¸€è‡´æ€§ æ¨åˆ°å‡ºå¦‚ä½•ç†è§£éš”ç¦»æ€§](https://blog.csdn.net/qq_37997523/article/details/83188003)



### SQL	ACID

```
A	åŸå­æ€§
C 	ä¸€è‡´æ€§
I 	éš”ç¦»æ€§
D 	æŒä¹…æ€§

åŸå­æ€§å…³æ³¨çŠ¶æ€ï¼Œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ï¼Œä¸å­˜åœ¨éƒ¨åˆ†æˆåŠŸçš„çŠ¶æ€ã€‚
è€Œä¸€è‡´æ€§å…³æ³¨æ•°æ®çš„å¯è§æ€§ï¼Œä¸­é—´çŠ¶æ€çš„æ•°æ®å¯¹å¤–éƒ¨ä¸å¯è§ï¼Œåªæœ‰æœ€åˆçŠ¶æ€å’Œæœ€ç»ˆçŠ¶æ€çš„æ•°æ®å¯¹å¤–å¯è§
```



### NoSQL	CAP + BASE

```
C	å¼ºä¸€è‡´æ€§
A	é«˜å¯ç”¨æ€§
P	åˆ†åŒºå®¹é”™æ€§
BASE	åŸºæœ¬å¯ç”¨ è½¯çŠ¶æ€ æœ€ç»ˆä¸€è‡´

å®ƒçš„æ€æƒ³æ˜¯é€šè¿‡ç³»ç»Ÿæ”¾æ¾æŸä¸€æ—¶åˆ»æ•°æ®ä¸€è‡´æ€§çš„è¦æ±‚ï¼Œæ¥æ¢å–ç³»ç»Ÿæ•´ä½“ä¼¸ç¼©æ€§å’Œæ€§èƒ½ä¸Šæ”¹è§‚
```



### CAP

å‚è€ƒï¼š[CAP å®šç†çš„å«ä¹‰](http://www.ruanyifeng.com/blog/2018/07/cap.html)

```
C:
ä¸€è‡´æ€§ï¼ŒåŸæ–‡ç¿»è¯‘è¿‡æ¥æ˜¯è¯´ï¼Œå¯¹äºä»»ä½•ä»å®¢æˆ·ç«¯å‘è¾¾åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ•°æ®è¯»å–è¯·æ±‚ï¼Œè¦ä¹ˆè¯»åˆ°æœ€æ–°çš„æ•°æ®è¦ä¹ˆå¤±è´¥ã€‚æ¢å¥è¯è¯´ï¼Œä¸€è‡´æ€§æ˜¯ç«™åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„è§’åº¦ï¼Œå¯¹è®¿é—®æœ¬ç³»ç»Ÿçš„å®¢æˆ·ç«¯çš„ä¸€ç§æ‰¿è¯ºï¼šè¦ä¹ˆæˆ‘ç»™æ‚¨è¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œè¦ä¹ˆæˆ‘ç»™ä½ è¿”å›ç»å¯¹ä¸€è‡´çš„æœ€æ–°æ•°æ®ï¼Œä¸éš¾çœ‹å‡ºï¼Œå…¶å¼ºè°ƒçš„æ˜¯æ•°æ®æ­£ç¡®ã€‚


A:
å¯¹äºä»»ä½•è¯·æ±‚ä»å®¢æˆ·ç«¯å‘è¾¾åˆ°åˆ†å¸ƒå¼ç³»ç»Ÿçš„æ•°æ®è¯»å–è¯·æ±‚ï¼Œéƒ½ä¸€å®šä¼šæ”¶åˆ°æ•°æ®ï¼Œä¸ä¼šæ”¶åˆ°é”™è¯¯ï¼Œä½†ä¸ä¿è¯å®¢æˆ·ç«¯æ”¶åˆ°çš„æ•°æ®ä¸€å®šæ˜¯æœ€æ–°çš„æ•°æ®ã€‚æ¢å¥è¯è¯´ï¼Œå¯ç”¨æ€§æ˜¯ç«™åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„è§’åº¦ï¼Œå¯¹è®¿é—®æœ¬ç³»ç»Ÿçš„å®¢æˆ·çš„å¦ä¸€ç§æ‰¿è¯ºï¼šæˆ‘ä¸€å®šä¼šç»™æ‚¨è¿”å›æ•°æ®ï¼Œä¸ä¼šç»™ä½ è¿”å›é”™è¯¯ï¼Œä½†ä¸ä¿è¯æ•°æ®æœ€æ–°ï¼Œå¼ºè°ƒçš„æ˜¯ä¸å‡ºé”™ã€‚


P:
åˆ†å¸ƒå¼ç³»ç»Ÿåº”è¯¥ä¸€ç›´æŒç»­è¿è¡Œï¼Œå³ä½¿åœ¨ä¸åŒèŠ‚ç‚¹é—´åŒæ­¥æ•°æ®çš„æ—¶å€™ï¼Œå‡ºç°äº†å¤§é‡çš„æ•°æ®ä¸¢å¤±æˆ–è€…æ•°æ®åŒæ­¥å»¶è¿Ÿã€‚åˆ†åŒºå®¹å¿æ€§æ˜¯ç«™åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿçš„è§’åº¦ï¼Œå¯¹è®¿é—®æœ¬ç³»ç»Ÿçš„å®¢æˆ·ç«¯çš„å†ä¸€ç§æ‰¿è¯ºï¼šæˆ‘ä¼šä¸€ç›´è¿è¡Œï¼Œä¸ç®¡æˆ‘çš„å†…éƒ¨å‡ºç°ä½•ç§æ•°æ®åŒæ­¥é—®é¢˜ï¼Œå¼ºè°ƒçš„æ˜¯ä¸æŒ‚æ‰ã€‚

å¯¹äºä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿè€Œè¨€ï¼ŒPæ˜¯å‰æï¼Œå¿…é¡»ä¿è¯ï¼Œå› ä¸ºåªè¦æœ‰ç½‘ç»œäº¤äº’å°±ä¸€å®šä¼šæœ‰å»¶è¿Ÿå’Œæ•°æ®ä¸¢å¤±ï¼Œè¿™ç§çŠ¶å†µæˆ‘ä»¬å¿…é¡»æ¥å—ï¼Œå¿…é¡»ä¿è¯ç³»ç»Ÿä¸èƒ½æŒ‚æ‰ã€‚è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœç¨å¾®å‡ºç°ç‚¹æ•°æ®ä¸¢åŒ…ï¼Œæˆ‘ä»¬çš„æ•´ä¸ªç³»ç»Ÿå°±æŒ‚æ‰çš„è¯ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¿˜è¦åšåˆ†å¸ƒå¼å‘¢ï¼Ÿæ‰€ä»¥ï¼ŒæŒ‰ç…§CAPç†è®ºä¸‰è€…ä¸­æœ€å¤šåªèƒ½åŒæ—¶ä¿è¯ä¸¤è€…çš„è®ºæ–­ï¼Œå¯¹äºä»»ä½•åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œè®¾è®¡æ—¶æ¶æ„å¸ˆèƒ½å¤Ÿé€‰æ‹©çš„åªæœ‰Cæˆ–è€…Aï¼Œè¦ä¹ˆä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼ˆä¿è¯æ•°æ®ç»å¯¹æ­£ç¡®ï¼‰ï¼Œè¦ä¹ˆä¿è¯å¯ç”¨æ€§ï¼ˆä¿è¯ç³»ç»Ÿä¸å‡ºé”™ï¼‰ã€‚


å½“ä¸ºäº†æ»¡è¶³åˆ†åŒºå®¹å¿ï¼ˆå¤šæ•°æ®èŠ‚ç‚¹ä¹‹é—´å¤‡ä»½ï¼‰ï¼›è¦ä¹ˆä¿è¯å¼ºä¸€è‡´æ€§ï¼Œè¦ä¹ˆä¿è¯å¯ç”¨æ€§ï¼›ä¿è¯å¼ºä¸€è‡´æ€§æ—¶ï¼Œåˆ™åœ¨æ•°æ®åŒæ­¥ç»™å…¶å®ƒèŠ‚ç‚¹å‰ï¼Œæ˜¯ä¸å¯ç”¨çš„ï¼›è€Œä¿è¯å¯ç”¨æ€§ï¼Œåœ¨æ•°æ®åŒæ­¥ç»™å…¶å®ƒèŠ‚ç‚¹å‰ï¼Œä¹Ÿæ˜¯å¯ä»¥è¯»å–åˆ°çš„ï¼Œä½†æ˜¯å¯èƒ½æ•°æ®ä¸æ˜¯æœ€æ–°çš„è€Œå·²ã€‚å¦‚æœæ—¢ä¿è¯ä¸€è‡´æ€§åˆä¿è¯å¯ç”¨æ€§ï¼Œä¹Ÿå°±æ˜¯æ”¾å¼ƒåˆ†åŒºå®¹å¿ï¼Œé‚£ä¹ˆå°±æ˜¯æ•°æ®åªå­˜åœ¨ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œé‚£ä¹ˆå½“è¿™ä¸ªæ•°æ®èŠ‚ç‚¹ä¸ç½‘ç»œä¸­å…¶å®ƒæœåŠ¡å‡ºç°é€šä¿¡æ•…éšœï¼Œä¹Ÿå°±æ˜¯å‡ºç°ç½‘ç»œåˆ†åŒºæ—¶ï¼Œé‚£ä¹ˆå…¶å®ƒæœåŠ¡å°±è¯»å–ä¸åˆ°æ•°æ®èŠ‚ç‚¹äº†ï¼Œé‚£ä¹ˆæ­¤æ—¶å¯ç”¨æ€§ä¹Ÿæ— æ³•ä¿è¯äº†ï¼Œå› ä¸ºä¸å¯ç”¨äº†
```



16ä¸ªåº“

select 0-15 	åˆ‡æ¢

DBSIZE		 æŸ¥çœ‹å½“å‰åº“æœ‰å¤šå°‘key

plushDB	æ¸…é™¤å½“å‰åº“çš„key

plushALL	 æ¸…é™¤æ‰€æœ‰åº“çš„key



### ç´¢å¼•é¢è¯•é¢˜

å‚è€ƒ: [ç´¢å¼•é¢è¯•é¢˜](https://www.cnblogs.com/Brambling/p/6754993.html)



### SQL Server å¸¸ç”¨SQL

```sql
-- è”è¡¨æ›´æ–°
update u set u.money= u.money+10
from user u
inner join dept d on d.id = u.deptId 
where d.deptName = 'å¼€å‘'

-- è”è¡¨åˆ é™¤
delete u 
from user u
inner join dept d on d.id = u.deptId
where d.deptName = 'å¼€å‘'

-- è”è¡¨æ’å…¥
insert into user_new(id,name)
select id,name 
from user

-- å¤åˆ¶è¡¨æ•°æ®åˆ›å»ºæ–°è¡¨
select id,name 
into user_new 
from user
```



### ROW_NUMBER() OVER()

å‚è€ƒï¼š[ROW_NUMBER() OVER()å‡½æ•°ç”¨æ³•è¯¦è§£](https://blog.csdn.net/qq_25221835/article/details/82762416)

```sql
-- æ ¹æ®dept_idåˆ†ç»„
select 
    name,
    dept_id,
    salary,
    row_number() over (partition by dept_id order by salary desc) rank
from user t
```



### SQL Server çŸ¥è¯†ç‚¹

```sql
ä¸‰å…ƒè¿ç®—

	iif(å¸ƒå°”,å€¼1,å€¼2)		

æˆªå–
	substring(å€¼ï¼Œå¼€å§‹ä½ç½®ï¼Œé•¿åº¦)
	select substring('123456',2,2)

```



### SQL Server JSONè½¬è¡¨

```sql
declare @users varchar(max) = '[{"id":1,"name":"Cps"},{"id":2,"name":"Xy"}]'		

SELECT *  INTO #users
FROM OPENJSON(@users)
WITH (
    id  INT,
    name varchar(200)
)
```


### SQL Server è¡¨æ‹¼æ¥SQL

```sql
-- éœ€è¦ä¿®æ”¹çš„æ’ç­ï¼ˆé‚£äº›å­˜åœ¨çš„æ•°æ®ï¼‰
DECLARE @update_update VARCHAR(MAX)=''
SELECT @update_update+='UPDATE kt_paiba SET '+col_name+'='''+isnull(value,'')+''',gly_no = '''+@operator+''' WHERE rq='''+year_month+''' AND user_serial='+CAST(user_serial AS VARCHAR(10))+';'
FROM #result_update a

-- æ‰§è¡Œæ‹¼æ¥çš„SQL
EXEC(@update_update)	
```



### SQL Server è¡Œä¸“åˆ—

å‚è€ƒï¼š[SQL Server è¡Œä¸“åˆ—](https://www.cnblogs.com/Rawls/p/11027413.html)



### SQL Server å­—æ®µè¡Œè½¬åˆ—

```sql
-- æ‹†åˆ†æ•°æ®ï¼Œè¡Œè½¬åˆ—
-- APPLYæœ‰ä¸¤ç§å½¢å¼ï¼Œä¸€ä¸ªæ˜¯OUTER APPLYï¼Œä¸€ä¸ªæ˜¯CROSS APPLYï¼ŒåŒºåˆ«åœ¨äºæŒ‡å®šOUTERï¼Œæ„å‘³ç€ç»“æœé›†ä¸­å°†åŒ…å«ä½¿å³è¡¨è¡¨è¾¾å¼ä¸ºç©ºçš„å·¦è¡¨è¡¨è¾¾å¼ä¸­çš„è¡Œï¼Œè€ŒæŒ‡å®šCROSSï¼Œåˆ™ç›¸åï¼Œç»“æœé›†ä¸­ä¸åŒ…å«ä½¿å³è¡¨è¡¨è¾¾å¼ä¸ºç©ºçš„å·¦è¡¨è¡¨è¾¾å¼ä¸­çš„è¡Œã€‚

SELECT
	v.value
FROM zt_glbc t
CROSS APPLY STRING_SPLIT(CAST(t.Valuse AS VARCHAR(MAX)), ',') v
WHERE bh = 13
```



### SQL Server åˆ¤æ–­è¡¨æˆ–å­˜å‚¨è¿‡ç¨‹

```sql
--åˆ¤æ–­è¡¨
if   object_id('tb_table') is not null  
	print 'exist' 
else 
	print'not exist' 

--åˆ¤æ–­å­˜å‚¨è¿‡ç¨‹
if exists (select 1
          from sysobjects
          where  id = object_id('bdSettlementDept')
          and type in ('P','PC'))
   drop procedure bdSettlementDept
go
```



### SQL Serverå­˜å‚¨è¿‡ç¨‹

```sql
USE scm_main;
-- éœ€è¦å…ˆåˆ›å»ºæ‹†åˆ†å­—ç¬¦ä¸²å­˜å‚¨è¿‡ç¨‹ï¼ˆsplit_strï¼‰
if exists (select 1
          from sysobjects
          where  id = object_id('bd_proc_schedule_gui_lv')
          and type in ('P','PC'))
DROP PROCEDURE bd_proc_schedule_gui_lv
GO
CREATE PROCEDURE bd_proc_schedule_gui_lv
	@user_serial_str varchar(max),
	@begin_date date,
	@end_date date,
	@ban_ci int,
	@ip varchar(max),
	@operator varchar(max)
as
BEGIN

-- å…³é—­æ‰“å°å—å½±å“è¡Œæ•°
SET NOCOUNT ON;


-- å®šä¹‰è¿”å›å—å½±å“è¡Œæ•°ç»“æœ
	declare @result int = 0;


	--  å¼‚å¸¸æ‰‘æ‰æœºåˆ¶
		BEGIN TRY

			CREATE TABLE #ban_ci(
				id INT IDENTITY,
				name VARCHAR(20)
			)

			CREATE TABLE #user_serial(
				id INT IDENTITY,
				user_serial VARCHAR(20)
			)

			CREATE TABLE #result(
			  user_serial  INT,
			  col_name VARCHAR(20),
			  value VARCHAR(100),
			  date DATE,
			  year_month VARCHAR(10)
			)

			CREATE TABLE #result_insert(
			  user_serial  INT,
			  col_name VARCHAR(20),
			  value VARCHAR(100),
			  date DATE,
			  year_month VARCHAR(10)
			)

			CREATE TABLE #result_update(
			  user_serial  INT,
			  col_name VARCHAR(20),
			  value VARCHAR(100),
			  date DATE,
			  year_month VARCHAR(10)
			)


			CREATE TABLE #kt_paiba (
			  user_serial bigint NOT NULL,
			  rq nvarchar(10) NOT NULL,
			  d1 varchar(100) NULL,
			  d2 varchar(100) NULL,
			  d3 varchar(100) NULL,
			  d4 varchar(100) NULL,
			  d5 varchar(100) NULL,
			  d6 varchar(100) NULL,
			  d7 varchar(100) NULL,
			  d8 varchar(100) NULL,
			  d9 varchar(100) NULL,
			  d10 varchar(100) NULL,
			  d11 varchar(100) NULL,
			  d12 varchar(100) NULL,
			  d13 varchar(100) NULL,
			  d14 varchar(100) NULL,
			  d15 varchar(100) NULL,
			  d16 varchar(100) NULL,
			  d17 varchar(100) NULL,
			  d18 varchar(100) NULL,
			  d19 varchar(100) NULL,
			  d20 varchar(100) NULL,
			  d21 varchar(100) NULL,
			  d22 varchar(100) NULL,
			  d23 varchar(100) NULL,
			  d24 varchar(100) NULL,
			  d25 varchar(100) NULL,
			  d26 varchar(100) NULL,
			  d27 varchar(100) NULL,
			  d28 varchar(100) NULL,
			  d29 varchar(100) NULL,
			  d30 varchar(100) NULL,
			  d31 varchar(100) NULL,
			  gly_no nvarchar(10) NULL,
			  year int ,
			  month int ,
			)


		-- å¼€å¯äº‹åŠ¡
			BEGIN TRAN


				-- æ‹†åˆ†ç”¨æˆ·ç¼–å·ä¿å­˜ä¸´æ—¶è¡¨ä¸­
				insert into #user_serial
				select * from string_split(@user_serial_str,',');

				-- å…ˆæ¸…é™¤è¡¨ä¸­å­˜åœ¨çš„æ•°æ®
				--delete a
				--from kt_paiba a
				--inner join #user_serial b on a.user_serial = b.user_serial
				--where a.rq = CONVERT(varchar(7),@begin_date,120) or a.rq = CONVERT(varchar(7),@end_date,120)


				-- æ‹†åˆ†ç­æ¬¡ä¿å­˜ä¸´æ—¶è¡¨ä¸­
				INSERT INTO #ban_ci
				SELECT v.value FROM zt_glbc t CROSS APPLY STRING_SPLIT(CAST(t.Valuse AS VARCHAR(MAX)), ',') v WHERE bh = @ban_ci

				declare @lx int;
				select @lx = lx from zt_glbc where bh = @ban_ci;

				-- è§„å¾‹ç­æ¬¡ç±»å‹ï¼šå‘¨
				IF @lx = 1 BEGIN
					INSERT INTO #result (user_serial, col_name, value, date, year_month)
					select t1.user_serial,t2.* from  (select * from #user_serial) t1,
					(
						SELECT 'd'+CAST(d.date_day AS VARCHAR(2)) colName, b.name,d.date,CONVERT(VARCHAR(7),date,120) date_month
						FROM bd_sys_dim_date d
						LEFT JOIN #ban_ci b ON b.id=d.date_week
						WHERE date >= @begin_date AND date <= @end_date
					) t2
				END
				-- æŒ‰æœˆæˆ–è€…æ—¥
				ELSE BEGIN
					INSERT INTO #result (user_serial, col_name, value, date, year_month)
					select t1.user_serial,t2.* from  (select * from #user_serial) t1,
					(
						SELECT 'd'+CAST(d.date_day AS VARCHAR(2)) colName, b.name,d.date,CONVERT(VARCHAR(7),date,120) date_month
						FROM bd_sys_dim_date d
						LEFT JOIN #ban_ci b ON b.id=d.date_day
						WHERE date >= @begin_date AND date <= @end_date
					) t2
				END


				-- select * from A,B ä¸æŒ‡å®šæ¡ä»¶é‚£ä¹ˆä¼šäº§ç”ŸAçš„æ‰€æœ‰Bæ•°æ®ï¼Œåˆšå¥½æ»¡è¶³éœ€æ±‚
				--INSERT INTO #result (user_serial, col_name, value, date, year_month)
				--select t1.user_serial,t2.* from  (select * from #user_serial) t1,
				--(
				--	SELECT 'd'+CAST(d.date_day AS VARCHAR(2)) colName, b.name,d.date,CONVERT(VARCHAR(7),date,120) date_month
				--	FROM bd_sys_dim_date d
				--	LEFT JOIN #ban_ci b ON b.id=d.date_week
				--	WHERE date >= @begin_date AND date <= @end_date
				--) t2


				-- éœ€è¦æ–°å¢çš„æ•°æ® #result_insert
				insert into #result_insert(user_serial,col_name,value,date,year_month)
				select a.user_serial,a.col_name,a.value,a.date,a.year_month
				from #result a
				inner join (
					select user_serial,convert(varchar(7),date,120) year_month from #result
					except
					select user_serial,rq as year_month from kt_paiba
				) b on a.user_serial = b.user_serial and a.year_month = b.year_month


				-- éœ€è¦ä¿®æ”¹çš„æ•°æ® #result_update
				insert into #result_update(user_serial,col_name,value,date,year_month)
				select a.user_serial,a.col_name,a.value,a.date,a.year_month
				from #result a
				inner join (
					select user_serial,convert(varchar(7),date,120) year_month from #result
					Intersect
					select user_serial,rq as year_month from kt_paiba
				) b on a.user_serial = b.user_serial and a.year_month = b.year_month


				-- select * from #result_insert
				-- select * from #result_update
				-- select * from #result

				-- å°†æ’å…¥çš„æ•°æ®å­˜å…¥åˆ°ä¸´æ—¶æ’ç­è¡¨ä¸­
				-- ä¸‹é¢ä¸¤æ®µä»£ç å°†ç«–ç€çš„æ•°æ®è½¬ä¸ºäº†æ¨ªç€çš„æ•°æ®
				INSERT INTO #kt_paiba (user_serial, rq, gly_no, year, month)
				SELECT distinct a.user_serial,CONVERT(VARCHAR(7),date,120),@operator,YEAR(date),MONTH(date)
				FROM #result_insert a


				-- å¾ªç¯æ‹¼æ¥éœ€è¦æ›´æ–°ä¸´æ—¶è¡¨ä¸­çš„å­—æ®µ
				-- æŸ¥è¯¢ï¼ˆå¾ªç¯ï¼‰æ‹¼æ¥æ•°æ®ï¼ˆç«–ç€å¾ªç¯ï¼‰
				DECLARE @update_insert VARCHAR(MAX)=''
				SELECT @update_insert+='UPDATE #kt_paiba SET '+col_name+'='''+value+''',gly_no = '''+@operator+''' WHERE rq='''+year_month+''' AND user_serial='+CAST(a.user_serial AS VARCHAR(10))+';'
				FROM #result_insert a


				-- æ‰§è¡Œæ‹¼æ¥çš„è¯­å¥
				EXEC(@update_insert)


				-- ä»ä¸´æ—¶è¡¨æ’å…¥åˆ°çœŸå®è¡¨ä¸­
				insert into kt_paiba
				select * from #kt_paiba


				-- éœ€è¦ä¿®æ”¹çš„æ’ç­ï¼ˆé‚£äº›å­˜åœ¨çš„æ•°æ®ï¼‰
				DECLARE @update_update VARCHAR(MAX)=''
				SELECT @update_update+='UPDATE kt_paiba SET '+col_name+'='''+value+''',gly_no = '''+@operator+''' WHERE rq='''+year_month+''' AND user_serial='+CAST(user_serial AS VARCHAR(10))+';'
				FROM #result_update a


				-- æ‰§è¡Œæ‹¼æ¥çš„SQL
				EXEC(@update_update)


				-- æ–°å¢çš„ç”Ÿæˆæ—¥å¿—è®°å½•
				insert into wt_log(log_fun,log_type,log_detail,gly_no,log_time,log_computer,log_ip,regserial)
				select distinct 13,1,isnull(@operator,'')+'å½•å…¥'+isnull(b.user_lname,'')+isnull(a.year_month,'')+'æ’ç­',isnull(@operator,''),getdate(),'',isnull(@ip,''),''
				from #result_insert a
				inner join dt_user b on a.user_serial = b.user_serial

				set @result = @result + @@ROWCOUNT;


				--æ›´æ–°çš„ç”Ÿæˆæ—¥å¿—è®°å½•
				insert into wt_log(log_fun,log_type,log_detail,gly_no,log_time,log_computer,log_ip,regserial)
				select distinct 13,1,isnull(@operator,'')+'æ›´æ–°'+isnull(b.user_lname,'')+isnull(a.year_month,'')+'æ’ç­',isnull(@operator,''),getdate(),'',isnull(@ip,''),''
				from #result_update a
				inner join dt_user b on a.user_serial = b.user_serial


				set @result = @result + @@ROWCOUNT;


		--  æäº¤äº‹åŠ¡
			COMMIT TRAN

	--  ç»“æŸå¼‚å¸¸æ•æ‰
		END TRY

	--  å¼‚å¸¸å¤„ç†
		BEGIN CATCH
			DECLARE @errStr VARCHAR(MAX) = ERROR_MESSAGE();
			IF XACT_STATE() <> 0
			BEGIN
			  ROLLBACK TRANSACTION;
			  RAISERROR (@errStr, 16, 1);
			END;
			ROLLBACK TRAN;
		END CATCH



--  æ¸…é™¤ä¸´æ—¶è¡¨
	select @result as result
	DROP TABLE #ban_ci
	DROP TABLE #user_serial
	DROP TABLE #kt_paiba

-- æ‰“å¼€æ‰“å°å—å½±å“è¡Œæ•°
SET NOCOUNT OFF;
END;

```



### SQL Server ç•™ä¸‹çš„å‘

```
å¾ªç¯æŸ¥è¯¢æ•°æ®èµ‹ç»™å˜é‡æ—¶ï¼Œä¸€å®šè¦åŠ ä¸Š isnull(å­—æ®µ,'') ï¼Œè¿™æ ·å³ä½¿å½“å‰æ²¡æœ‰æŸ¥åˆ°ï¼Œä¹Ÿä¸ä¼šå½±å“ä¸‹æ¬¡éå†çš„æ•°æ®
```



### SQL Server Mergeç”¨æ³•

å‚è€ƒï¼š[Merge](https://www.cnblogs.com/Vincent-yuan/p/11521229.html)

```sql

MERGE target_table USING source_table
ON merge_condition
WHEN MATCHED
    THEN update_statement
WHEN NOT MATCHED
    THEN insert_statement
WHEN NOT MATCHED BY SOURCE
    THEN DELETE;
------------------------------------------------
MERGE sales.category t 
    USING sales.category_staging s
ON (s.category_id = t.category_id)
WHEN MATCHED
    THEN UPDATE SET 
        t.category_name = s.category_name,
        t.amount = s.amount
WHEN NOT MATCHED BY TARGET 
    THEN INSERT (category_id, category_name, amount)
         VALUES (s.category_id, s.category_name, s.amount)
WHEN NOT MATCHED BY SOURCE 
    THEN DELETE;
    
```



### SQL Serverã€My SQLã€Oracle æ•°æ®åº“åˆ†é¡µ

å–å‡ºsqlè¡¨ä¸­ç¬¬31åˆ°40çš„è®°å½•ï¼ˆä»¥è‡ªåŠ¨å¢é•¿IDä¸ºä¸»é”®ï¼‰

> MySQL

```sql
select * from t order by id limit 0,10
```



> Oracle

```sql
select * from (select rownum r,* from t where r<=40) where r>30
```

â€‹	

> SQL Server

```sql
select top 10 * from t where id not in (select top 30 id from t order by id ) orde by id

select top 10 * from t where id in (select top 40 id from t order by id) order by id desc


select * from t order by id
offset (4-1) * 10 rows
fetch next @pageSize rows only;
```



### MySQL å¸¸ç”¨SQL

```sql
-- è”è¡¨æ›´æ–°
UPDATE `ana` a 
INNER JOIN `user` b ON a.user_id = b.id
SET a.comment_num = 66
WHERE b.user_nick_name = 'é‡‡å…ˆç”Ÿi'


-- è”è¡¨åˆ é™¤
DELETE a
FROM `ana` a
INNER JOIN `user` b ON a.user_id = b.id
WHERE b.user_nick_name = 'é‡‡å…ˆç”Ÿi'

-- è”è¡¨æ’å…¥
INSERT INTO ana_new(id,title)
SELECT id,title
FROM ana

-- å¤åˆ¶è¡¨æ•°æ®åˆ›å»ºæ–°è¡¨
CREATE TABLE ana_back 
SELECT * FROM ana
```



>Mysql GROUP_CONCATè·å–åˆ†ç»„çš„å‰å‡ å

å‚è€ƒï¼š[mysql GROUP_CONCATè·å–åˆ†ç»„çš„å‰å‡ å](https://blog.csdn.net/qq_34471305/article/details/83347994)



### Oracle ä½¿ç”¨SQLå¤‡ä»½ä¸æ¢å¤

```sql
1.1 å®Œå…¨å¤‡ä»½
exp demo/demo@orcl buffer=1024 file=dï¼š\back.dmp full=y

1.2 å®Œå…¨è¿˜åŸ
imp demo/demo@orcl file=d:\back.dmp full=y ignore=y log=D:\implog.txt

2.1 å¯¼å‡ºæŒ‡å®šè¡¨
exp demo/demo@orcl file=d:\backup2.dmp tables=(teachers,students)

2.2 å¯¼å…¥æŒ‡å®šè¡¨
imp demo/demo@orcl file=d:\backup2.dmp tables=(teachers,students)
```

è¯¦æƒ…ï¼šhttps://blog.csdn.net/yztezhl/article/details/80451046



## Linux



### CentOS 7å®‰è£…

å‚è€ƒï¼š[Centos7å®‰è£…](https://www.cnblogs.com/set-config/p/9040407.html)  [ç½‘ç»œé…ç½®ä»¥åŠå®‰è£…å›¾å½¢åŒ–ç•Œé¢](https://www.cnblogs.com/zqyw/p/11202560.html)  [æ²¡æœ‰ç½‘ç»œ](https://www.cnblogs.com/Vincent-yuan/p/10802023.html)



### NATå’Œæ¡¥æ¥æ¨¡å¼

å‚è€ƒï¼š[NATå’Œæ¡¥æ¥æ¨¡å¼](https://www.cnblogs.com/huhuxixi/p/11527837.html )



### é…ç½®é˜²ç«å¢™ç«¯å£

```sh
#CentOS 6
vi /etc/sysconfig/iptables         //é˜²ç«å¢™é…ç½®

-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT //å…è®¸22ç«¯å£é€šè¿‡
-A INPUT -m state --state NEW -m tcp -p tcp --dport 3306 -j ACCEPT //å…è®¸3306ç«¯å£é€šè¿‡

service iptables restart        //é‡å¯é˜²ç«å¢™


#CentOS 7

# æŸ¥è¯¢ç«¯å£æ˜¯å¦å¼€æ”¾
firewall-cmd --query-port=8080/tcp
# å¼€æ”¾80ç«¯å£
firewall-cmd --permanent --add-port=80/tcp
# ç§»é™¤ç«¯å£
firewall-cmd --permanent --remove-port=8080/tcp

#æŸ¥çœ‹firewalldæœåŠ¡çŠ¶æ€
systemctl status firewalld
#å…³é—­firewalld
systemctl stop firewalld
#ç¦æ­¢firewallå¼€æœºå¯åŠ¨
systemctl disable firewalld 
#è®¾ç½®firewallå¼€æœºå¯åŠ¨
systemctl enable firewalld

# å¼€å¯
service firewalld start
# å…³é—­
service firewalld stop
# é‡å¯
service firewalld restart

#åˆ›å»ºè½¯é“¾æ¥
ln -s æºæ–‡ä»¶ ç›®æ ‡æ–‡ä»¶
```



### Linuxå¸¸ç”¨å‘½ä»¤

```sh
chmod 777 xx #æˆæƒ
tar -zxvf æ–‡ä»¶å #è§£å‹
tar -cvf 123.tar file1 file2 #å‹ç¼©
ps -ef | grep tomcat
ps -ef | grep java
kill -9 #è¿›ç¨‹å·
vi æ–‡ä»¶å	#ç¼–è¾‘(ddåˆ é™¤æ–‡æœ¬å½“å‰è¡Œ)
df -h #æŸ¥è¯¢ç£ç›˜çš„ç©ºé—´ä½¿ç”¨æƒ…å†µ
whereis æ–‡ä»¶å #æŸ¥æ‰¾æ–‡ä»¶

vim æ–‡ä»¶å #ç¼–è¾‘æ–‡ä»¶
	dd #åˆ é™¤å½“å‰è¡Œ
	/å­—ç¬¦ #é«˜äº®æ˜¾ç¤ºå­—ç¬¦ï¼ŒæŒ‰nåˆ™æŸ¥çœ‹ä¸‹ä¸€ä¸ªï¼Œ:noh å–æ¶ˆé«˜äº®
	:set nu #æŸ¥çœ‹è¡Œå·
	
	
#æŸ¥çœ‹å†…å­˜ä½¿ç”¨æƒ…å†µ
free -m 

#æ˜¾ç¤ºè¿›ç¨‹ä¿¡æ¯(åŒ…æ‹¬CPUã€å†…å­˜ä½¿ç”¨ç­‰ä¿¡æ¯)
top

#æ˜¾ç¤ºç£ç›˜ç©ºé—´ä½¿ç”¨æƒ…å†µ
df --block-size=M

#æŸ¥çœ‹è¯¦ç»†çš„è¿›ç¨‹
ps 6832

#åŠ¨æ€æŸ¥è¯¢
tail -99f text.txt

#æ˜¾ç¤ºtcpï¼Œudpçš„ç«¯å£å’Œè¿›ç¨‹ç­‰ç›¸å…³æƒ…å†µ
netstat -tunplp
netstat -tunplp | grep ç«¯å£å·

#æŸ¥çœ‹æŸä¸ªç«¯å£
lsof -i :8080 
#åˆ—å‡ºæŸä¸ªç¨‹åºæ‰€æ‰“å¼€çš„æ–‡ä»¶ä¿¡æ¯
lsof -c java 
```



### Linuxåå°è¿è¡Œé¡¹ç›®

```linux
#å¦‚æœè®©ç¨‹åºå§‹ç»ˆåœ¨åå°æ‰§è¡Œï¼Œå³ä½¿å…³é—­å½“å‰çš„ç»ˆç«¯ä¹Ÿæ‰§è¡Œï¼ˆä¹‹å‰çš„&åšä¸åˆ°ï¼‰ï¼Œè¿™æ—¶å€™éœ€è¦nohupã€‚è¯¥å‘½ä»¤å¯ä»¥åœ¨ä½ é€€å‡ºå¸æˆ·/å…³é—­ç»ˆç«¯ä¹‹åç»§ç»­è¿è¡Œç›¸åº”çš„è¿›ç¨‹ã€‚å…³é—­ä¸­æ–­åï¼Œåœ¨å¦ä¸€ä¸ªç»ˆç«¯jobså·²ç»æ— æ³•çœ‹åˆ°åå°è·‘å¾—ç¨‹åºäº†ï¼Œæ­¤æ—¶åˆ©ç”¨psï¼ˆè¿›ç¨‹æŸ¥çœ‹å‘½ä»¤ï¼‰
nohup ./startup.sh &
nohup java -jar weChat.jar &

ps -aux | grep "test.sh"  
#a:æ˜¾ç¤ºæ‰€æœ‰ç¨‹åº u:ä»¥ç”¨æˆ·ä¸ºä¸»çš„æ ¼å¼æ¥æ˜¾ç¤º x:æ˜¾ç¤ºæ‰€æœ‰ç¨‹åºï¼Œä¸ä»¥ç»ˆç«¯æœºæ¥åŒºåˆ†
```



### Linuxé…ç½®JDK

/etc/profile æ–‡ä»¶

```sh
#ç¼–è¾‘etc/profileæ–‡ä»¶
---------------------------------
#JAVAçš„JDKé…ç½®
export JAVA_HOME=/usr/local/java/jdk1.8.0_251
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
#å°†JDKé…ç½®åˆ°ç¯å¢ƒå˜é‡ä¸­ï¼Œå¦‚æœè¿˜æœ‰å…¶ä»–å˜é‡ åœ¨å…¶åé¢ä½¿ç”¨:éš”å¼€
export PATH=$PATH:$JAVA_HOME/bin
---------------------------------

#åˆ·æ–°ç¯å¢ƒå˜é‡æ–‡ä»¶ï¼š åˆ·æ–°ç¯å¢ƒå˜é‡å‘½ä»¤
source /etc/profile
```



### Linuxå®‰è£…Maven

å‚è€ƒï¼š[Linuxå®‰è£…Maven](https://blog.csdn.net/qq_38270106/article/details/97764483)



### Linuxå®‰è£…Git

å‚è€ƒï¼š[Linuxå®‰è£…Git](https://blog.csdn.net/xiaoye319/article/details/89642875)



### Linuxå®‰è£…MySQL

å‚è€ƒï¼š[Linuxå®‰è£…MySQL](https://www.jianshu.com/p/276d59cbc529)  [MySQLæ— æ³•è¿œç¨‹è¿æ¥](https://www.cnblogs.com/zzqit/p/10095597.html)  [MySQLå¿˜è®°å¯†ç ](https://www.cnblogs.com/black-fact/p/11613361.html)



### Linuxå®‰è£…Redis

å‚è€ƒï¼š[Linuxå®‰è£…Redis](https://www.cnblogs.com/limit1/p/9045183.html)  

> æŠ¥é”™gccæ— æ•ˆå‘½ä»¤

```
yum install -y gcc-c++
```

> å®‰è£…Redis

```sh
1.è·å–redisèµ„æº

ã€€ã€€wget http://download.redis.io/releases/redis-4.0.8.tar.gz

2.è§£å‹

ã€€ã€€tar xzvf redis-4.0.8.tar.gz

3.å®‰è£…

ã€€ã€€cd redis-4.0.8

ã€€ã€€make

ã€€ã€€cd src

ã€€ã€€make install PREFIX=/usr/local/redis

4.ç§»åŠ¨é…ç½®æ–‡ä»¶åˆ°å®‰è£…ç›®å½•ä¸‹

ã€€ã€€cd ../

ã€€ã€€mkdir /usr/local/redis/etc

ã€€ã€€mv redis.conf /usr/local/redis/etc

 5.é…ç½®redisä¸ºåå°å¯åŠ¨

ã€€ã€€vi /usr/local/redis/etc/redis.conf //å°†daemonize no æ”¹æˆdaemonize yes

6.å°†redisåŠ å…¥åˆ°å¼€æœºå¯åŠ¨

ã€€ã€€vi /etc/rc.local 
ã€€ã€€//åœ¨é‡Œé¢æ·»åŠ å†…å®¹ï¼š/usr/local/redis/bin/redis-server /usr/local/redis/etc/redis.conf 
ã€€ã€€(æ„æ€å°±æ˜¯å¼€æœºè°ƒç”¨è¿™æ®µå¼€å¯redisçš„å‘½ä»¤)

7.å¼€å¯redis

ã€€ã€€/usr/local/redis/bin/redis-server /usr/local/redis/etc/redis.conf 

 

å¸¸ç”¨å‘½ä»¤ã€€ã€€

ã€€ã€€redis-server /usr/local/redis/etc/redis.conf //å¯åŠ¨redis

ã€€ã€€pkill redis  //åœæ­¢redis

ã€€ã€€å¸è½½redisï¼š

ã€€ã€€ã€€ã€€rm -rf /usr/local/redis //åˆ é™¤å®‰è£…ç›®å½•

ã€€ã€€ã€€ã€€rm -rf /usr/bin/redis-* //åˆ é™¤æ‰€æœ‰redisç›¸å…³å‘½ä»¤è„šæœ¬

ã€€ã€€ã€€ã€€rm -rf /root/download/redis-4.0.4 //åˆ é™¤redisè§£å‹æ–‡ä»¶å¤¹
```



### MySQLæ•°æ®æ€»æ˜¾ç¤º '' ? ''

1. ç¼–è¾‘my.cnfæ–‡ä»¶ é»˜è®¤è·¯å¾„éƒ½åœ¨ `vi /etc/my.cnf`

2. æ·»åŠ é…ç½®

   ```Linux
   [mysqld]
   #ä¸­æ–‡æ— æ³•æ’å…¥æ•°æ®
   character-set-server=utf8
   #æ”¹é…ç½®å¯ä»¥å¿½ç•¥å¤§å°å†™
   lower_case_table_names=1  
   
   [client]
   #ä¸­æ–‡æ— æ³•æ’å…¥æ•°æ®
   default-character-set=utf8
   ```

   ```
   #è®¾ç½®ç¼–ç æ ¼å¼
   mysql> set character_set_database=utf8;
    
   mysql> set character_set_server=utf8;
   
   # vi /etc/my.cnf;
   [mysqld]
   character_set_server = utf8
    
   [mysql]
   default-character-set=utf8
    
   [client]
   default-character-set=utf8
   ```

   

3. è¿è¡Œä»£ç ï¼Œé‡å¯MySQLæœåŠ¡

   ```sh
   service mysqld/mysql restart
   ```



### MySQLä¸»ä»å¤åˆ¶

> ä¸»æœºé…ç½®(host79)

```sh
ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼švim /etc/my.cnf
#ä¸»æœåŠ¡å™¨å”¯ä¸€ID
server-id=1
#å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—
log-bin=mysql-bin
# è®¾ç½®ä¸è¦å¤åˆ¶çš„æ•°æ®åº“(å¯è®¾ç½®å¤šä¸ª)
binlog-ignore-db=mysql
binlog-ignore-db=information_schema
#è®¾ç½®éœ€è¦å¤åˆ¶çš„æ•°æ®åº“
binlog-do-db=éœ€è¦å¤åˆ¶çš„ä¸»æ•°æ®åº“åå­—
#è®¾ç½®logbinæ ¼å¼
binlog_format=STATEMENT
```



> ä»æœºé…ç½®(host80)

```sh
ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼švim /etc/my.cnf
#ä»æœåŠ¡å™¨å”¯ä¸€ID
server-id=2
#å¯ç”¨ä¸­ç»§æ—¥å¿—
relay-log=mysql-relay
```



> ä¸»æœºã€ä»æœºé‡å¯ MySQL æœåŠ¡

> ä¸»æœºä»æœºéƒ½å…³é—­é˜²ç«å¢™

> åœ¨ä¸»æœºä¸Šå»ºç«‹å¸æˆ·å¹¶æˆæƒ slave

```sh
#åœ¨ä¸»æœºMySQLé‡Œæ‰§è¡Œæˆæƒå‘½ä»¤
GRANT REPLICATION SLAVE ON *.* TO 'slave'@'%' IDENTIFIED BY '123123';
#æŸ¥è¯¢masterçš„çŠ¶æ€
show master status;
#è®°å½•ä¸‹Fileå’ŒPositionçš„å€¼
#æ‰§è¡Œå®Œæ­¤æ­¥éª¤åä¸è¦å†æ“ä½œä¸»æœåŠ¡å™¨MySQLï¼Œé˜²æ­¢ä¸»æœåŠ¡å™¨çŠ¶æ€å€¼å˜åŒ–
```



> åœ¨ä»æœºä¸Šé…ç½®éœ€è¦å¤åˆ¶çš„ä¸»æœº

```sh
#å¦‚æœä¹‹å‰é…ç½®è¿‡ä¸»ä»éœ€è¦åœæ­¢åŸæœ‰çš„
stop slave;
reset master;

#å¤åˆ¶ä¸»æœºçš„å‘½ä»¤
CHANGE MASTER TO MASTER_HOST='ä¸»æœºçš„IPåœ°å€',
MASTER_USER='slave',
MASTER_PASSWORD='123123',
MASTER_LOG_FILE='mysql-bin.å…·ä½“æ•°å­—',MASTER_LOG_POS=å…·ä½“å€¼; #å¯åŠ¨ä»æœåŠ¡å™¨å¤åˆ¶åŠŸèƒ½
start slave;

#æŸ¥çœ‹ä»æœåŠ¡å™¨çŠ¶æ€
show slave status\G;

#ä¸‹é¢ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯Yesï¼Œåˆ™è¯´æ˜ä¸»ä»é…ç½®æˆåŠŸï¼
# Slave_IO_Running: Yes
# Slave_SQL_Running: Yes
```



## Windows



### Git

å‚è€ƒï¼š[Git](https://blog.csdn.net/hellow__world/article/details/72529022)



### IDEAä¿®æ”¹javaæ–‡ä»¶å ä¸ç”¨é‡å¯TomcatæœåŠ¡ä¾¿å¯è‡ªåŠ¨æ›´æ–°

å‚è€ƒï¼š[IDEAä¿®æ”¹javaæ–‡ä»¶å ä¸ç”¨é‡å¯TomcatæœåŠ¡ä¾¿å¯è‡ªåŠ¨æ›´æ–°](https://blog.csdn.net/u010865136/article/details/80392212)



### CRMä¸ERP

å‚è€ƒï¼š[CRMä¸ERP](http://baijiahao.baidu.com/s?id=1653409772927548267&wfr=spider&for=pc)



### VOã€DTOã€DOã€POçš„æ¦‚å¿µ

å‚è€ƒï¼š[VOã€DTOã€DOã€POçš„æ¦‚å¿µ](https://blog.51cto.com/14442094/2432008?source=dra)

```
entityæ˜¯å®ä½“ç±»  voå±•ç¤ºç±»  toå…¥å‚ç±»  
```



### JAVA ç‰ˆæœ¬

> JAVA SE æ ‡å‡†ç‰ˆå¼€å‘ ä¸»è¦ç”¨äºæ¡Œé¢ç¨‹åº,æ§åˆ¶å°å¼€å‘(JFC)

> JAVA EE ä¼ä¸šçº§å¼€å‘ï¼Œä¸»è¦ç”¨äºwebç«¯(JSP,EJB)       

> JAVA MEåµŒå…¥å¼å¼€å‘(æ‰‹æœº,å°å®¶ç”µ)



### JVM & GC

å‚è€ƒï¼š[ä¸€ç¯‡æ–‡ç« å½»åº•æå®šæ‰€æœ‰GCé¢è¯•é—®é¢˜](https://blog.csdn.net/liewen_/article/details/83151227)

![JVMç»“æ„](./image/JVM.png)

**JVMè¿è¡Œæ—¶æ•°æ®åŒº**

```
JVMè¿è¡Œæ—¶æ•°æ®åŒºä¸»è¦åˆ†ä¸ºï¼šæ ˆã€å †ã€æœ¬åœ°æ–¹æ³•æ ˆã€ç¨‹åºè®¡æ•°å™¨ã€æ–¹æ³•åŒºï¼ˆjdk8æ— ï¼‰ã€å…¶ä¸­æ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€ç¨‹åºè®¡æ•°å™¨ï¼Œ3ä¸ªåŒºåŸŸéšçº¿ç¨‹ç”Ÿç­(å› ä¸ºæ˜¯çº¿ç¨‹ç§æœ‰)ï¼Œä¸å…±äº«æ•°æ®ã€‚è€ŒJavaå †å’Œæ–¹æ³•åŒºåˆ™ä¸ä¸€æ ·

Javaå †ï¼šJavaè™šæ‹Ÿæœºç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ï¼Œæ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹å’Œæ•°ç»„éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚GCä¸»è¦å°±æ˜¯åœ¨Javaå †ä¸­è¿›è¡Œçš„ã€‚JVMæ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸä¸åŒï¼ŒåŒæ—¶ä¹Ÿä¸ºäº†æé«˜å¯¹è±¡å†…å­˜åˆ†é…å’Œåƒåœ¾å›æ”¶çš„æ•ˆç‡ï¼ŒæŠŠå †å†…å­˜åˆ’åˆ†ä¸ºå‡ å—ã€‚
	1.æ–°ç”Ÿä»£ï¼ˆæ–°ç”Ÿä»£åˆåˆ†ä¸ºEden80%ï¼ŒSurvivorFrom10%ï¼ŒSurvivorTo10%ï¼‰
	2.è€å¹´ä»£ç»è¿‡äº†å¤šæ¬¡GCä¾ç„¶å­˜æ´»ï¼Œä¸ä¼šé¢‘ç¹åšGC

æµç¨‹ï¼š
-----------------------------------------------------------------------------------------
1.æ–°ç”Ÿä»£æœ‰ä¸€ä¸ªEdenåŒºå’Œä¸¤ä¸ªsurvivoråŒºï¼Œé¦–å…ˆå°†å¯¹è±¡æ”¾å…¥EdenåŒºï¼Œå¦‚æœç©ºé—´ä¸è¶³å°±å‘å…¶ä¸­çš„ä¸€ä¸ªsurvivoråŒºä¸Šæ”¾ï¼Œå¦‚æœä»ç„¶æ”¾ä¸ä¸‹å°±ä¼šå¼•å‘ä¸€æ¬¡å‘ç”Ÿåœ¨æ–°ç”Ÿä»£çš„Minor GCï¼Œå°†å­˜æ´»çš„å¯¹è±¡æ”¾å…¥å¦ä¸€ä¸ªsurvivoråŒºä¸­ï¼Œç„¶åæ¸…ç©ºEdenå’Œä¹‹å‰çš„é‚£ä¸ªsurvivoråŒºçš„å†…å­˜ã€‚åœ¨æŸæ¬¡GCè¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘ç°ä»ç„¶åˆæ”¾ä¸ä¸‹çš„å¯¹è±¡ï¼Œå°±å°†è¿™äº›å¯¹è±¡æ”¾å…¥è€å¹´ä»£å†…å­˜é‡Œå»ã€‚

2.å¤§å¯¹è±¡ä»¥åŠé•¿æœŸå­˜æ´»çš„å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚

3.è§¦å‘Minor GCä¹‹å‰ï¼Œä¼šæ£€æŸ¥æ™‹å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡å¤§å°ï¼Œæ˜¯å¦å¤§äºè€å¹´ä»£å‰©ä½™ç©ºé—´ï¼Œå¦‚æœå¤§äºï¼Œåˆ™ç›´æ¥è§¦å‘Full GC
-----------------------------------------------------------------------------------------

GCä¸€å…±åˆ†ä¸‰ç§ï¼šMinorGC,Major GC å’ŒFull GCã€‚Full GCæ˜¯æ¸…ç†æ•´ä¸ªå †ç©ºé—´â€”åŒ…æ‹¬å¹´è½»ä»£å’Œæ°¸ä¹…ä»£ã€‚

æ–¹æ³•åŒºï¼šå¯¹äºJVMçš„æ–¹æ³•åŒºï¼Œå¯èƒ½å¬å¾—æœ€å¤šçš„æ˜¯å¦å¤–ä¸€ä¸ªè¯´æ³•â€”â€”æ°¸ä¹…ä»£ï¼ˆPermanent Generationï¼‰ï¼Œå‘¼åº”å †çš„æ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚åœ¨æ°¸ä¹…ä»£ç§»é™¤åï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä¹Ÿä¸å†æ”¾åœ¨æ°¸ä¹…ä»£äº†ï¼Œä½†æ˜¯ä¹Ÿæ²¡æœ‰æ”¾åˆ°æ–°çš„æ–¹æ³•åŒº---å…ƒç©ºé—´é‡Œï¼Œè€Œæ˜¯ç•™åœ¨äº†å †é‡Œï¼ˆä¸ºäº†æ–¹ä¾¿å›æ”¶ï¼Ÿï¼‰ã€‚è¿è¡Œæ—¶å¸¸é‡æ± å½“ç„¶æ˜¯éšç€æ¬å®¶åˆ°äº†å…ƒç©ºé—´é‡Œï¼Œæ¯•ç«Ÿå®ƒæ˜¯è£…é™æ€å˜é‡ã€å­—èŠ‚ç ç­‰ä¿¡æ¯çš„ï¼Œæœ‰å®ƒçš„åœ°æ–¹æ‰ç§°å¾—ä¸Šæ–¹æ³•åŒºã€‚

å…ƒç©ºé—´æ˜¯æ–¹æ³•åŒºçš„åœ¨HotSpot jvm ä¸­çš„å®ç°ï¼Œæ–¹æ³•åŒºä¸»è¦ç”¨äºå­˜å‚¨ç±»çš„ä¿¡æ¯ã€å¸¸é‡æ± ã€æ–¹æ³•æ•°æ®ã€æ–¹æ³•ä»£ç ç­‰ã€‚æ–¹æ³•åŒºé€»è¾‘ä¸Šå±äºå †çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯ä¸ºäº†ä¸å †è¿›è¡ŒåŒºåˆ†ï¼Œé€šå¸¸åˆå«â€œéå †â€ã€‚å…ƒç©ºé—´çš„æœ¬è´¨å’Œæ°¸ä¹…ä»£ç±»ä¼¼ï¼Œéƒ½æ˜¯å¯¹JVMè§„èŒƒä¸­æ–¹æ³•åŒºçš„å®ç°ã€‚ä¸è¿‡å…ƒç©ºé—´ä¸æ°¸ä¹…ä»£ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼šå…ƒç©ºé—´å¹¶ä¸åœ¨è™šæ‹Ÿæœºä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°å†…å­˜ã€‚
```



### JVMä¸­å †å’Œæ ˆçš„åŒºåˆ«

[JVMä¸­å †å’Œæ ˆçš„åŒºåˆ«](https://www.cnblogs.com/benon94/p/10626798.html)

[JVMä¸­å †å’Œæ ˆåˆ°åº•å­˜æ”¾äº†ä»€ä¹ˆ](https://www.cnblogs.com/toSeeMyDream/p/5251918.html)



### JAVA8 çš„Stream APIä½¿ç”¨

å‚è€ƒï¼š[JAVA8 çš„Stream APIä½¿ç”¨](https://www.cnblogs.com/jimoer/p/10995574.html)



### JAVAåå°„æœºåˆ¶

å‚è€ƒï¼š[JAVAåå°„æœºåˆ¶](https://www.cnblogs.com/hechenhao/p/8039639.html)  [JAVAåå°„æœºåˆ¶](https://blog.csdn.net/liujiahan629629/article/details/18013523?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task)  

```java
private static object getFieldValueByName(String fieldName, object o) throws Exception {
	String firstLetter = fieldName.substring(0,1).toUpperCase() ;
	String getter = "get" + firstLetter + fieldName.substring(1);
	Method method = o.getClass().getMethod(getter, new Class[] {});
	Object value = method.invoke(o, new Object[] {});
    System.out.println("fieldName>>>>>>"+filedName+" val: "+String.valueOf(value));
	return value;
}
```



### JAVAå¤šçº¿ç¨‹

å‚è€ƒï¼š[JAVAå¤šçº¿ç¨‹](https://blog.csdn.net/zl1zl2zl3/article/details/81868173)  [å¯¹è±¡é”ã€é”æ± ã€ç­‰å¾…æ± ](https://blog.csdn.net/u014561933/article/details/58639411)



### JAVA IOæµ

å‚è€ƒï¼š[JAVA IOæµ](https://blog.csdn.net/qq_37875585/article/details/89385688)





### JAVAæ³¨è§£ä¸å…ƒæ³¨è§£

å‚è€ƒï¼š[JAVAæ³¨è§£ä¸å…ƒæ³¨è§£](https://blog.csdn.net/pengjunlee/article/details/79683621)  [JAVAæ³¨è§£+åå°„æœºåˆ¶](https://baijiahao.baidu.com/s?id=1612408653409570352&wfr=spider&for=pc)  [JAVAæ¡†æ¶å¸¸ç”¨æ³¨è§£](https://www.jianshu.com/p/a4db04398df6)



### å•ä¾‹æ¨¡å¼

> æ‡’æ±‰

```java
public class SingleTon{
   private static SingleTon  INSTANCE = null;
   private SingleTon(){}
   public static SingleTon getInstance() {  
   if(INSTANCE == null){
      INSTANCE = new SingleTon(); 
    } 
    return INSTANCEï¼›
  }
}
//æ‡’æ±‰æ¨¡å¼åœ¨æ–¹æ³•è¢«è°ƒç”¨åæ‰åˆ›å»ºå¯¹è±¡ï¼Œä»¥æ—¶é—´æ¢ç©ºé—´ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å­˜åœ¨é£é™©ã€‚
```



> é¥¿æ±‰

```java
public class SingleTon{
	private static SingleTon INSTANCE = new SingleTon();
	private SingleTon(){
	
	}
	public static SingleTon getInstance(){ 
		return INSTANCE; 
	}
}
//é¥¿æ±‰æ¨¡å¼åœ¨ç±»è¢«åˆå§‹åŒ–æ—¶å°±å·²ç»åœ¨å†…å­˜ä¸­åˆ›å»ºäº†å¯¹è±¡ï¼Œä»¥ç©ºé—´æ¢æ—¶é—´ï¼Œæ•…ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚
```



> é™æ€å†…éƒ¨ç±»

```java
public class SingleTon{
  private SingleTon(){}
 
  private static class SingleTonHoler{
     private static SingleTon INSTANCE = new SingleTon();
 }
 
  public static SingleTon getInstance(){
    return SingleTonHoler.INSTANCE;
  }
}
//é™æ€å†…éƒ¨ç±»çš„ä¼˜ç‚¹æ˜¯ï¼šå¤–éƒ¨ç±»åŠ è½½æ—¶å¹¶ä¸éœ€è¦ç«‹å³åŠ è½½å†…éƒ¨ç±»ï¼Œå†…éƒ¨ç±»ä¸è¢«åŠ è½½åˆ™ä¸å»åˆå§‹åŒ–INSTANCEï¼Œæ•…è€Œä¸å å†…å­˜ã€‚å³å½“SingleTonç¬¬ä¸€æ¬¡è¢«åŠ è½½æ—¶ï¼Œå¹¶ä¸éœ€è¦å»åŠ è½½SingleTonHolerï¼Œåªæœ‰å½“getInstance()æ–¹æ³•ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶ï¼Œæ‰ä¼šå»åˆå§‹åŒ–INSTANCE,ç¬¬ä¸€æ¬¡è°ƒç”¨getInstance()æ–¹æ³•ä¼šå¯¼è‡´è™šæ‹ŸæœºåŠ è½½SingleTonHolerç±»ï¼Œè¿™ç§æ–¹æ³•ä¸ä»…èƒ½ç¡®ä¿çº¿ç¨‹å®‰å…¨ï¼Œä¹Ÿèƒ½ä¿è¯å•ä¾‹çš„å”¯ä¸€æ€§ï¼ŒåŒæ—¶ä¹Ÿå»¶è¿Ÿäº†å•ä¾‹çš„å®ä¾‹åŒ–ã€‚
```



### å·¥å‚æ¨¡å¼

å‚è€ƒï¼š[å·¥å‚æ¨¡å¼](https://www.runoob.com/design-pattern/factory-pattern.html)



### ç­–ç•¥æ¨¡å¼

å‚è€ƒï¼š[ç­–ç•¥æ¨¡å¼](https://www.runoob.com/design-pattern/strategy-pattern.html)



### å·¥å‚æ¨¡å¼ä¸ç­–ç•¥æ¨¡å¼

```
å·¥å‚æ¨¡å¼ä¸­åªç®¡ç”Ÿäº§å®ä¾‹ï¼Œå…·ä½“æ€ä¹ˆä½¿ç”¨å·¥å‚å®ä¾‹ç”±è°ƒç”¨æ–¹å†³å®šï¼Œç­–ç•¥æ¨¡å¼æ˜¯å°†ç”Ÿæˆå®ä¾‹çš„ä½¿ç”¨ç­–ç•¥æ”¾åœ¨ç­–ç•¥ç±»ä¸­é…ç½®åæ‰æä¾›è°ƒç”¨æ–¹ä½¿ç”¨ã€‚ 
å·¥å‚æ¨¡å¼è°ƒç”¨æ–¹å¯ä»¥ç›´æ¥è°ƒç”¨å·¥å‚å®ä¾‹çš„æ–¹æ³•å±æ€§ç­‰ï¼Œç­–ç•¥æ¨¡å¼ä¸èƒ½ç›´æ¥è°ƒç”¨å®ä¾‹çš„æ–¹æ³•å±æ€§ï¼Œéœ€è¦åœ¨ç­–ç•¥ç±»ä¸­å°è£…ç­–ç•¥åè°ƒç”¨ã€‚
```



### è§‚å¯Ÿè€…ä¸ç›‘å¬å™¨

å‚è€ƒï¼š[javaç›‘å¬å™¨å®ç°ä¸åŸç†](https://www.cnblogs.com/againn/p/9512013.html)  [è§‚å¯Ÿè€…å’Œç›‘å¬å™¨çš„åŒºåˆ«](https://blog.csdn.net/lovexiaotaozi/article/details/102579880)   [Springç›‘å¬æ¨¡å¼å®ä¾‹](https://www.cnblogs.com/dubhlinn/p/10725636.html)

```
é‡ç‚¹ï¼šç†è§£äº‹ä»¶ä¸äº‹ä»¶æºçš„å…³ç³»
```



### Executorsçº¿ç¨‹æ± 

```
1. newCachedThreadPoolåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œå¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œè‹¥æ— å¯å›æ”¶ï¼Œåˆ™æ–°å»ºçº¿ç¨‹ã€‚
2. newFixedThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚
3. newScheduledThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œæ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚
4. newSingleThreadExecutor åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº(FIFO, LIFO, ä¼˜å…ˆçº§)æ‰§è¡Œã€‚
```



### å¤šçº¿ç¨‹ä¿è¯é›†åˆå®‰å…¨

```java
//Collectionsç”±å¾ˆå¤šå·¥å…·ç±»ï¼šsynchronizedSetã€synchronizedList
Set<Object> set = Collections.synchronizedSet(new HashSet<Object>());
for (int i = 1; i <= 5; i++) {
    new Thread(() -> {
        set.add(UUID.randomUUID().toString().substring(0, 8));
        System.err.println(set.toString());
        try {
            Thread.sleep(1000);
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }, String.valueOf(i)).start();
}
```



### å¤šçº¿ç¨‹ä½¿ç”¨

```java
ExecutorService cachedThreadPool = Executors.newCachedThreadPool();
            Integer numThread = 200;//æ¯ä¸ªçº¿ç¨‹æºå¸¦200æ¡æ•°æ®
            Integer count = list.size() % numThread == 0 ? list.size()/numThread : (list.size()/numThread + 1);
            //è®°å½•çº¿ç¨‹ä¸ªæ•°
            CountDownLatch latch = new CountDownLatch(count);
            for (int i = 0; i < count; i++) {
                int index = i;
                cachedThreadPool.execute(new Runnable() {
                    @Override
                    public void run() {
                        try {
                            if(index == count-1){//æœ€åä¸€æ¬¡
                                List<ImportAttendance2> subList = list.subList(index * numThread,list.size());
                                importAttendanceMapper.importAttendanceData(subList);
                            }else{//é™¤äº†æœ€åä¸€æ¬¡
                                List<ImportAttendance2> subList = list.subList(index * numThread,index * numThread + numThread);
                                importAttendanceMapper.importAttendanceData(subList);
                            }
                        }catch (Exception e){
                            e.printStackTrace();
                        }finally {
                            latch.countDown();
                        }
                    }
                });
            }
            //ç­‰å¾…æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œ
            latch.await();
            //å¼‚æ­¥æ‰§è¡ŒåŒæ­¥å­˜å‚¨è¿‡ç¨‹
            cachedThreadPool.execute(new Runnable() {
                @Override
                public void run() {
                    importAttendanceMapper.execAttendanceProc();
                }
            });

```



### JDBCé¢è¯•é¢˜

å‚è€ƒï¼š[JDBCé¢è¯•é¢˜](https://www.cnblogs.com/kevinf/p/3705148.html)



### MyBatisé¢è¯•é¢˜

å‚è€ƒï¼š[MyBatisé¢è¯•é¢˜](https://blog.csdn.net/a745233700/article/details/80977133)



### Springé¢è¯•é¢˜

å‚è€ƒï¼š[Springé¢è¯•é¢˜](https://blog.csdn.net/a745233700/article/details/80959716)  [Spring Beanä½œç”¨åŸŸ](https://blog.csdn.net/qq_41083009/article/details/90743719)  [Springæºç åˆ†æ](https://blog.csdn.net/nuomizhende45/article/details/81158383)  [Spring ä¸­çš„è§‚å¯Ÿè€…æ¨¡å¼](https://www.cnblogs.com/dubhlinn/p/10725636.html))



å‚è€ƒï¼š [IOCå®¹å™¨ç»“æ„](https://www.bilibili.com/video/BV1EE411u7YV?p=26)  [IOCçˆ¶å­å®¹å™¨](https://blog.csdn.net/fhjdzkp/article/details/78687513)

```
ä¾‹å¦‚ï¼š
æˆ‘ä»¬äº‹åŠ¡æ³¨è§£æ”¯æŒ(<tx:annotation-driven/>)æ”¾å…¥äº†spring-context.xmlï¼Œå®ƒçš„æ³¨è§£èŒƒå›´åœ¨service daoä»¥åŠentityï¼›
å¦‚æœå°†äº‹åŠ¡æ³¨è§£æ”¯æŒæ”¾å…¥spring-mvc.xmlï¼Œäº‹åŠ¡æ³¨è§£(@Transaction)æ”¾åœ¨serviceä¸Šæ— æ•ˆ.

åˆæˆ–è€…ï¼Œæˆ‘ä»¬å…±æœ‰ä¸‰ä¸ªæ–‡ä»¶spring-context.xmlã€spring-security.xmlã€spring-mvc.xmlï¼Œspring-context.xmlå¼•å…¥äº†spring-security.xml
å¦‚æœæƒ³å¯ç”¨securityæ³¨è§£æƒé™çš„é…ç½®ï¼Œåœ¨controllerç”Ÿæ•ˆï¼Œåº”æ”¾å…¥spring-mvc.xml
å¦‚æœæƒ³å¯ç”¨securityæ³¨è§£æƒé™çš„é…ç½®ï¼Œåœ¨serviceã€daoã€entityç”Ÿæ•ˆï¼Œåº”æ”¾å…¥spring-context.xmlæˆ–è€…spring-security.xml
```

![](image\ServletContextå®¹å™¨.png)

#### IOCåŸºæœ¬åŸç†

```java
1ã€IOC æ€æƒ³åŸºäº IOC å®¹å™¨å®Œæˆï¼ŒIOC å®¹å™¨åº•å±‚å°±æ˜¯å¯¹è±¡å·¥å‚
2ã€Spring æä¾› IOC å®¹å™¨å®ç°ä¸¤ç§æ–¹å¼ï¼šï¼ˆä¸¤ä¸ªæ¥å£ï¼‰
	1).BeanFactoryï¼šIOC å®¹å™¨åŸºæœ¬å®ç°ï¼Œæ˜¯ Spring å†…éƒ¨çš„ä½¿ç”¨æ¥å£ï¼Œä¸æä¾›å¼€å‘äººå‘˜è¿›è¡Œä½¿ç”¨
	* åŠ è½½é…ç½®æ–‡ä»¶æ—¶å€™ä¸ä¼šåˆ›å»ºå¯¹è±¡ï¼Œåœ¨è·å–å¯¹è±¡ï¼ˆä½¿ç”¨ï¼‰æ‰å»åˆ›å»ºå¯¹è±¡
	
	2).ApplicationContextï¼šBeanFactory æ¥å£çš„å­æ¥å£ï¼Œæä¾›æ›´å¤šæ›´å¼ºå¤§çš„åŠŸèƒ½ï¼Œä¸€èˆ¬ç”±å¼€å‘äººå‘˜è¿›è¡Œä½¿ç”¨
	* åŠ è½½é…ç½®æ–‡ä»¶æ—¶å€™å°±ä¼šæŠŠåœ¨é…ç½®æ–‡ä»¶å¯¹è±¡è¿›è¡Œåˆ›å»º
	
	è™½ç„¶ç¬¬ä¸€ç§æ–¹å¼æ¯”è¾ƒå¥½ï¼Œä½†æˆ‘ä»¬é€šå¸¸æ˜¯Webé¡¹ç›®ï¼Œåœ¨é¡¹ç›®å¯åŠ¨æ—¶åŠ è½½æ—¶å…¨éƒ¨åŠ è½½ï¼ŒåæœŸè®¿é—®æ›´å¿«ï¼Œè´¹æ—¶è´¹åŠ›æ”¾åœ¨å¯åŠ¨
	
String classValue = classå±æ€§;//xmlè§£æå¾—åˆ°
Class class = Class.forName(className);//é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡
User user = (User)class.newInstance();//åˆ›å»ºå®ä¾‹
```



#### IOC æ“ä½œ Bean ç®¡ç†

```xml
1ã€ç”Ÿå‘½å‘¨æœŸ
	1).ä»å¯¹è±¡åˆ›å»ºåˆ°å¯¹è±¡é”€æ¯çš„è¿‡ç¨‹
	
2ã€bean ç”Ÿå‘½å‘¨æœŸ
    1).é€šè¿‡æ„é€ å™¨åˆ›å»ºbeanå®ä¾‹ï¼ˆæ— å‚æ•°æ„é€ ï¼‰
    2).ä¸ºbeançš„å±æ€§è®¾ç½®å€¼å’Œå¯¹å…¶ä»–beanå¼•ç”¨ï¼ˆè°ƒç”¨setæ–¹æ³•ï¼‰
    3).æŠŠbeanå®ä¾‹ä¼ é€’ç»™bean åç½®å¤„ç†å™¨æ–¹æ³• -> postProcessBeforeInitialization
    4).è°ƒç”¨beançš„åˆå§‹åŒ–çš„æ–¹æ³•ï¼ˆéœ€è¦è¿›è¡Œé…ç½®åˆå§‹åŒ–çš„æ–¹æ³•ï¼‰
    5).æŠŠbeanå®ä¾‹ä¼ é€’ç»™bean åç½®å¤„ç†å™¨æ–¹æ³• -> postProcessAfterInitialization
    6).beanå¯ä»¥ä½¿ç”¨äº†ï¼ˆå¯¹è±¡è·å–åˆ°äº†ï¼‰
    7).å½“å®¹å™¨å…³é—­æ—¶å€™ï¼Œè°ƒç”¨beançš„é”€æ¯çš„æ–¹æ³•ï¼ˆéœ€è¦è¿›è¡Œé…ç½®é”€æ¯çš„æ–¹æ³•ï¼‰

<bean id="myUser" 
      class="cn.cps.User" 
      init-method="myInitMethod"
      destroy-method="myDestroyMethod"
 ></bean>


åç½®å¤„ç†å™¨æ–¹æ³•éœ€è¦å®ç°BeanPostProcessæ¥å£,ä¹Ÿéœ€è¦æŠŠåç½®å¤„ç†å™¨å®ç°ç±»æ³¨å…¥å®¹å™¨ä¸­
é‡å†™ä¸¤ä¸ªæ–¹æ³•postProcessBeforeInitializationã€postProcessAfterInitialization
```



#### AOPåŸºæœ¬åŸç†

```java
1ã€AOPåº•å±‚ä½¿ç”¨åŠ¨æ€ä»£ç†
    1).æœ‰ä¸¤ç§æƒ…å†µåŠ¨æ€ä»£ç†ï¼Œä½¿ç”¨ JDK åŠ¨æ€ä»£ç†ï¼Œåˆ›å»ºæ¥å£å®ç°ç±»ä»£ç†å¯¹è±¡ï¼Œå¢å¼ºç±»çš„æ–¹æ³•
    	//åˆ›å»ºæ¥å£å®ç°ç±»ä»£ç†å¯¹è±¡
 		Class[] interfaces = {UserDao.class};
		UserDaoImpl userDao = new UserDaoImpl();
        UserDao dao = (UserDao)Proxy.newProxyInstance(
            JDKProxy.class.getClassLoader(),
            interfaces,
            new UserDaoProxy(userDao)
        );
		//åˆ›å»ºä»£ç†å¯¹è±¡ä»£ç 
        class UserDaoProxy implements InvocationHandler {
         //1 æŠŠåˆ›å»ºçš„æ˜¯è°çš„ä»£ç†å¯¹è±¡ï¼ŒæŠŠè°ä¼ é€’è¿‡æ¥
         //æœ‰å‚æ•°æ„é€ ä¼ é€’
         private Object obj;
         public UserDaoProxy(Object obj) {
             this.obj = obj;
         }
         //å¢å¼ºçš„é€»è¾‘
         @Override
         public Object invoke(Object proxy, Method method, Object[] args){
             //æ–¹æ³•ä¹‹å‰
             System.out.println(
                 "æ–¹æ³•ä¹‹å‰æ‰§è¡Œ"+method.getName()
                 +":ä¼ é€’çš„å‚æ•°..."
                 + Arrays.toString(args)
             );
             //è¢«å¢å¼ºçš„æ–¹æ³•æ‰§è¡Œ
             Object res = method.invoke(obj, args);
             //æ–¹æ³•ä¹‹å
             System.out.println("æ–¹æ³•ä¹‹åæ‰§è¡Œ...."+obj);
             return res;
          }
    2).æ²¡æœ‰æ¥å£æƒ…å†µï¼Œä½¿ç”¨ CGLIB åŠ¨æ€ä»£ç†ï¼Œåˆ›å»ºå­ç±»çš„ä»£ç†å¯¹è±¡ï¼Œå¢å¼ºç±»çš„æ–¹æ³•
        è‡ªå®šä¹‰å½“å‰ç±»çš„ä»£ç†å¯¹è±¡ ç»§æ‰¿è¢«ä»£ç†ç±»ï¼Œé‡å†™è¯¥çš„æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œæ‰§è¡Œè‡ªå·±çš„å¢å¼ºé€»è¾‘
```



![](image\åŠ¨æ€ä»£ç†æœ‰æ¥å£æƒ…å†µåŸç†.png)



![](image\åŠ¨æ€ä»£ç†æ²¡æœ‰æ¥å£æƒ…å†µåŸç†.png)



#### Springè§‚å¯Ÿè€…æ¨¡å¼å››ä¸ªè§’è‰² *

```
ä¸€ã€Spring ä¸­è§‚å¯Ÿè€…æ¨¡å¼çš„å››ä¸ªè§’è‰²
1. äº‹ä»¶ï¼ˆApplicationEventï¼‰
ApplicationEvent æ˜¯æ‰€æœ‰äº‹ä»¶å¯¹è±¡çš„çˆ¶ç±»ã€‚ApplicationEvent ç»§æ‰¿è‡ª jdk çš„ EventObject, æ‰€æœ‰çš„äº‹ä»¶éƒ½éœ€è¦ç»§æ‰¿ ApplicationEvent, å¹¶ä¸”é€šè¿‡ source å¾—åˆ°äº‹ä»¶æºã€‚

2. äº‹ä»¶ç›‘å¬ï¼ˆApplicationListenerï¼‰
ApplicationListener äº‹ä»¶ç›‘å¬å™¨ï¼Œä¹Ÿå°±æ˜¯è§‚å¯Ÿè€…ã€‚ç»§æ‰¿è‡ª jdk çš„ EventListenerï¼Œè¯¥ç±»ä¸­åªæœ‰ä¸€ä¸ªæ–¹æ³• onApplicationEventã€‚å½“ç›‘å¬çš„äº‹ä»¶å‘ç”Ÿåè¯¥æ–¹æ³•ä¼šè¢«æ‰§è¡Œã€‚

3. äº‹ä»¶å‘å¸ƒ/äº‹ä»¶æºï¼ˆApplicationContextï¼‰
ApplicationContext æ˜¯ Spring ä¸­çš„æ ¸å¿ƒå®¹å™¨ï¼Œåœ¨äº‹ä»¶ç›‘å¬ä¸­ ApplicationContext å¯ä»¥ä½œä¸ºäº‹ä»¶çš„å‘å¸ƒè€…ï¼Œä¹Ÿæ˜¯äº‹ä»¶æºï¼Œå› ä¸º ApplicationContext ç»§æ‰¿è‡ª ApplicationEventPublisherã€‚ApplicationContextæ˜¯äº‹ä»¶æºæ˜¯å› ä¸ºåœ¨new ClassPathApplication()ä¸­ï¼Œåº•å±‚è°ƒç”¨publishEvent(new ContextRefreshedEvent(this))

åœ¨ApplicationEventPublisher ä¸­å®šä¹‰äº†äº‹ä»¶å‘å¸ƒçš„æ–¹æ³• â€” publishEvent(Object event) ï¼Œåº•å±‚è°ƒç”¨ApplicationEventMulticaster

4. äº‹ä»¶ç®¡ç†ï¼ˆApplicationEventMulticasterï¼‰
ApplicationEventMulticaster ç”¨äºäº‹ä»¶ç›‘å¬å™¨çš„æ³¨å†Œå’Œäº‹ä»¶çš„å¹¿æ’­ã€‚ç›‘å¬å™¨çš„æ³¨å†Œå°±æ˜¯é€šè¿‡å®ƒæ¥å®ç°çš„ï¼Œå®ƒçš„ä½œç”¨æ˜¯æŠŠ Applicationcontext å‘å¸ƒçš„ Event å¹¿æ’­ç»™å®ƒçš„ç›‘å¬å™¨åˆ—è¡¨
```



#### Springä¸­å®ç°è§‚å¯Ÿè€…æ¨¡å¼

```
1.è‡ªå®šä¹‰éœ€è¦å‘å¸ƒçš„äº‹ä»¶ç±»ï¼Œéœ€è¦ç»§æ‰¿ ApplicationEvent ç±»æˆ– PayloadApplicationEvent (è¯¥ç±»ä¹Ÿä»…ä»…æ˜¯å¯¹ ApplicationEvent çš„ä¸€å±‚å°è£…)

2.ä½¿ç”¨ @EventListener æ¥ç›‘å¬äº‹ä»¶æˆ–è€…å®ç° ApplicationListener æ¥å£ã€‚

3.ä½¿ç”¨ ApplicationEventPublisher æ¥å‘å¸ƒè‡ªå®šä¹‰äº‹ä»¶ï¼ˆ@Autowiredæ³¨å…¥å³å¯ï¼‰
```



### SpringMVCä¸Struts2å¯¹æ¯”

å‚è€ƒï¼š[SpringMVCä¸Struts2åŒºåˆ«ä¸æ¯”è¾ƒæ€»ç»“](https://blog.csdn.net/jishuizhipan/article/details/79385190)



### SpringMVCé¢è¯•é¢˜

å‚è€ƒï¼š[ SpringMVCé¢è¯•é¢˜](https://blog.csdn.net/a745233700/article/details/80963758?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task)



### SpringBootæºç è§£æ

å‚è€ƒï¼š[SpringBooté¢è¯•é¢˜](https://blog.csdn.net/yuzongtao/article/details/84295732)  [SpringBootæ³¨è§£è§£æ](https://www.cnblogs.com/123-shen/p/SpringBoot.html) 

```
ä¸‰å¤§æ ¸å¿ƒï¼šå¿«é€Ÿæ•´åˆç¬¬ä¸‰æ–¹æ¡†æ¶ã€æ— xmlæ³¨è§£åŒ–é…ç½®ã€ä½¿ç”¨javaè¯­è¨€å†…åµŒtomcat
```

#### è‡ªå®šä¹‰starter

```java
//SpringBootå¯åŠ¨ç±»
@SpringBootApplication

//SpringBootçš„é…ç½®ç±»
@SpringBootConfiguration

//å¯åŠ¨è‡ªåŠ¨é…ç½®
@EnableAutoConfiguration

//å¯¼å…¥é…ç½®ç±»
@Configuration
@EnableConfigurationProperties(TokenProperties.class)
public class TokenAutoConfiguration(){

}

//è·å–é…ç½®æ–‡ä»¶å€¼(ymlå’Œproperties)
@ConfigurationProperties(prefix = "mayikt")
public class TokenProperties(){
	//mayikt.tokenRedisHost
	private String tokenRedisHost;
	//mayikt.tokenRedisPwd
	private String tokenRedisPwd;
}

//ç¨‹åºåŠ è½½é…ç½®ç±»å…¥å£
/MATA-INFO/spring.factories
org.springframework.boot.autoconfigure.EnableAutoConfiguration=com.mayikt.config.TokenAutoConfiguration
```



#### SpringBootå¯åŠ¨æµç¨‹

å‚è€ƒï¼š [SpringBootæºç è§£æ](https://www.cnblogs.com/hello-shf/category/1456313.html)  [Springè§‚å¯Ÿè€…æ¨¡å¼](https://www.cnblogs.com/dubhlinn/p/10725636.html)  [SpringApplicationRunListener](https://www.cnblogs.com/duanxz/p/11243271.html)

```
æ ¸å¿ƒæµç¨‹
1.åˆ›å»ºSpringApplicationå¯¹è±¡
2.è°ƒç”¨SpringApplication run å®ç°å¯åŠ¨åŒæ—¶è¿”å›å½“å‰çš„å®¹å™¨ä¸Šä¸‹æ–‡

å…·ä½“åˆ†æ
1.åˆ›å»ºSpringApplicationå¯¹è±¡SpringBootå®¹å™¨åˆå§‹åŒ–æ“ä½œã€‚
	ç¬¬ä¸€æ­¥ï¼šè·å–å½“å‰åº”ç”¨å¯åŠ¨ç±»å‹
    ç¬¬äºŒæ­¥ï¼šåŠ è½½æˆ‘ä»¬è‡ªå®šä¹‰çš„åˆå§‹åŒ–å™¨
    ç¬¬ä¸‰æ­¥ï¼šåŠ è½½æˆ‘ä»¬è‡ªå®šä¹‰çš„ç›‘å¬å™¨
    ç¬¬å››æ­¥ï¼šæ¨æ–­ä¸»å…¥å£ç±»
    
	1.1.è·å–å½“å‰åº”ç”¨å¯åŠ¨ç±»å‹ï¼ŒClassUtils.isPresent("ç±»å")åˆ¤æ–­å½“å‰classpathæ˜¯å¦æœ‰åŠ è½½æ‰€éœ€è¦çš„ç±»
		webApplicationType åˆ†ä¸ºä¸‰ç§ç±»å‹ï¼š
            a.NONEï¼šä¸ä¼šåµŒå…¥webå®¹å™¨å¯åŠ¨(æ™®é€šé¡¹ç›®)
            b.SERVLETï¼šä½¿ç”¨javaä»£ç åˆ›å»ºWebå®¹å™¨å¯åŠ¨
            c.REACTIVEï¼šå“åº”å¼å¯åŠ¨(Spring5æ–°ç‰¹æ€§)
	1.2.setInitializers
		é€šè¿‡getSpringFactoriesInstancesæ–¹æ³•ï¼Œåœ¨META-INF/spring.factoriesä¸­ï¼Œè·å–å¯¹åº”çš„
		ApplicationContextInitializerå¹¶åˆ›å»ºå¯¹è±¡è£…é…åˆ°é›†åˆä¸­ï¼Œç”¨äºåœ¨springå®¹å™¨åˆ·æ–°ä¹‹å‰ï¼Œ
		è°ƒç”¨è¯¥å¯¹è±¡çš„initializeå›è°ƒæ–¹æ³•(å®¹å™¨åˆ·æ–°ä¹‹å‰æ–¹æ³•ï¼šprepareContext)
	1.3.setListeners
		é€šè¿‡getSpringFactoriesInstancesæ–¹æ³•ï¼Œåœ¨META-INF/spring.factoriesä¸­ï¼Œè·å–å¯¹åº”çš„
		ApplicationListenerå¹¶åˆ›å»ºå¯¹è±¡è£…é…åˆ°é›†åˆä¸­ï¼Œå‡†å¤‡å¥½è¿è¡Œæ—¶ç›‘å¬å™¨
	1.4.deduceMainApplicationClass æ ¹æ®è°ƒç”¨æ ˆï¼Œå¾ªç¯åˆ¤æ–­æ–¹æ³•åæ˜¯å¦ç­‰äºmainï¼Œæ¨æ–­å‡ºmainæ–¹æ³•çš„ç±»å

2.è°ƒç”¨SpringApplication run æ–¹æ³•å®ç°å¯åŠ¨
    ç¬¬ä¸€æ­¥ï¼šè·å–å¹¶å¯åŠ¨ç›‘å¬å™¨
    ç¬¬äºŒæ­¥ï¼šæ„é€ åº”ç”¨ä¸Šä¸‹æ–‡ç¯å¢ƒ
    ç¬¬ä¸‰æ­¥ï¼šåˆå§‹åŒ–åº”ç”¨ä¸Šä¸‹æ–‡
    ç¬¬å››æ­¥ï¼šåˆ·æ–°åº”ç”¨ä¸Šä¸‹æ–‡å‰çš„å‡†å¤‡é˜¶æ®µ
    ç¬¬äº”æ­¥ï¼šåˆ·æ–°åº”ç”¨ä¸Šä¸‹æ–‡
    ç¬¬å…­æ­¥ï¼šåˆ·æ–°åº”ç”¨ä¸Šä¸‹æ–‡åçš„æ‰©å±•æ¥å£

	2.1.StopWatch stopWatch = new StopWatch();
		è®°å½•æˆ‘ä»¬SpringBootå¯åŠ¨æ—¶é—´
	2.2.getRunListeners
		è¯»å–META-INF/spring.factoriesçš„SpringApplicationRunListeneråå°„æœºåˆ¶å¾—åˆ°ç›‘å¬å™¨ï¼Œ
		æ¥å£è§„å®šäº†SpringBootç”Ÿå‘½å‘¨æœŸ(ä¾‹å¦‚ï¼šstartingã€environmentPreparedã€contextPrepared...)
	2.3.listeners.starting
		å¾ªç¯è°ƒç”¨ç›‘å¬startingæ–¹æ³•(æœ‰ç‚¹åƒå‘å¸ƒæ¶ˆæ¯ï¼Œé€šçŸ¥ç›‘å¬å™¨å›è°ƒ),
		å®é™…æ˜¯é€šè¿‡EventMulticasteräº‹ä»¶ç®¡ç†å™¨ï¼Œæœ€ç»ˆè°ƒç”¨ApplicationListener.onApplicationEvent
	2.4.prepareEnvironment æ„é€ åº”ç”¨ä¸Šä¸‹æ–‡ç¯å¢ƒ 
            åƒè®¡ç®—æœºçš„ç¯å¢ƒã€Javaç¯å¢ƒã€Springçš„è¿è¡Œç¯å¢ƒ(--spring.profiles.active=prod) 
            ä»¥åŠSpringé¡¹ç›®çš„é…ç½®(åœ¨SpringBootä¸­å°±æ˜¯é‚£ä¸ªç†Ÿæ‚‰çš„application.properties/yml)ç­‰ç­‰
		/**
		1.getOrCreateEnvironmentè·å–ç›¸åº”çš„ç¯å¢ƒå¯¹è±¡
			webApplicationTypeä¸Šæ–‡è®¾ç½®æˆäº†servletï¼Œæ‰€ä»¥åˆ›å»ºç¯å¢ƒå¯¹è±¡æ˜¯StandardServletEnvironment
		2.configureEnvironment
			å°è£…æˆSimpleCommandLinePropertySourceå¹¶åŠ å…¥åˆ°äº†environmentä¸­å¹¶æ¿€æ´»ç›¸åº”çš„é…ç½®æ–‡ä»¶
		2.listeners.environmentPrepared(environment);
			å¯åŠ¨ç›¸åº”çš„ç›‘å¬å™¨ï¼Œå…¶ä¸­é‡è¦çš„ConfigFileApplicationListenerå°±æ˜¯åŠ è½½é¡¹ç›®é…ç½®æ–‡ä»¶çš„ç›‘å¬å™¨ã€‚
			é»˜è®¤è·å–classpath:/,classpath:/config,file:./file:./conifgé¡¹ç›®ä¸­çš„ä¸ºapplicationçš„
            propertiesã€xmlã€ymlã€yamlæ–‡ä»¶. ä¸¾ä¾‹ï¼šlocation:classpath:/appcalition.properties
        è‡³æ­¤ï¼Œé¡¹ç›®çš„å˜é‡é…ç½®å·²å…¨éƒ¨åŠ è½½å®Œæ¯•,æŸ¥çœ‹environmentå±æ€§ï¼Œé…ç½®æ–‡ä»¶çš„é…ç½®ä¿¡æ¯å·²ç»å¯ä»¥çœ‹åˆ°
        **/
	2.6.Banner printedBanner = printBanner(environment);
		æ‰“å°SpringBootBannerå›¾
	2.7.context = this.createApplicationContext();
		æ ¹æ®webApplicationTypeè¿›è¡Œåˆ¤æ–­ï¼Œåˆ›å»ºSpringBootä¸Šä¸‹æ–‡å¯¹è±¡ConfigurableApplicationContext
	2.8.prepareContext(context, environment, listeners, applicationArguments,
					printedBanner);
        ä¸»è¦æ˜¯åœ¨å®¹å™¨åˆ·æ–°ä¹‹å‰çš„å‡†å¤‡åŠ¨ä½œã€‚
        å›è°ƒApplicationContextInitializerçš„initializeræ–¹æ³•
        å›è°ƒSpringApplicationRunListenerçš„contextPreparedæ–¹æ³•
        æœ€åä¸€æ­¥å›è°ƒæ‰€æœ‰çš„listener.contextPrepared(context);
    2.9.refreshContext(context);æ‰«æ åˆ›å»º åŠ è½½æ‰€æœ‰ç»„ä»¶(é…ç½®ç±»ã€è‡ªåŠ¨è£…é…ã€åˆ›å»ºTomcat)
    	invokeBeanFactoryPostProcessors(beanFactory);ï¼ˆé‡ç‚¹ï¼‰IoCå®¹å™¨åˆå§‹åŒ–ä¸ªæ­¥éª¤
    	ã€€1ï¼Œç¬¬ä¸€æ­¥ï¼šResourceå®šä½
    	ã€€	ä¼šå…ˆå°†ä¸»ç±»è§£ææˆBeanDefinitionï¼Œç„¶åè§£æä¸»ç±»çš„BeanDefinitionè·å–basePackageçš„è·¯å¾„ï¼Œ
    	ã€€	è¿™æ ·å°±å®Œæˆäº†å®šä½çš„è¿‡ç¨‹
    	ã€€2ï¼Œç¬¬äºŒæ­¥ï¼šBeanDefinitionçš„è½½å…¥
    	ã€€	æ‰€è°“çš„è½½å…¥å°±æ˜¯é€šè¿‡ä¸Šé¢çš„å®šä½å¾—åˆ°çš„basePackageï¼ŒSpringBootä¼šå°†è¯¥è·¯å¾„æ‹¼æ¥æˆï¼š
    	ã€€	classpath*:org/springframework/boot/demo/**/*.classè¿™æ ·çš„å½¢å¼ï¼Œç„¶åä¸€ä¸ªç±»ä¼šå°†è¯¥è·¯
    	ã€€	å¾„ä¸‹æ‰€æœ‰çš„.classæ–‡ä»¶éƒ½åŠ è½½è¿›æ¥ï¼Œç„¶åéå†åˆ¤æ–­æ˜¯ä¸æ˜¯æœ‰@Componentæ³¨è§£ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå°±æ˜¯æˆ‘ä»¬
    	ã€€	è¦è£…è½½çš„BeanDefinition
    	ã€€3ã€ç¬¬ä¸‰ä¸ªè¿‡ç¨‹ï¼šæ³¨å†ŒBeanDefinition
    	ã€€	è¿™ä¸ªæ³¨å†Œè¿‡ç¨‹æŠŠè½½å…¥è¿‡ç¨‹ä¸­è§£æå¾—åˆ°çš„BeanDefinitionå‘IoCå®¹å™¨è¿›è¡Œæ³¨å†Œã€‚é€šè¿‡ä¸Šæ–‡çš„åˆ†æï¼Œæˆ‘ä»¬å¯
    	ã€€	ä»¥çœ‹åˆ°ï¼Œåœ¨IoCå®¹å™¨ä¸­å°†BeanDefinitionæ³¨å…¥åˆ°ä¸€ä¸ªConcurrentHashMapä¸­ï¼ŒIoCå®¹å™¨å°±æ˜¯é€šè¿‡è¿™ä¸ª
    	ã€€	HashMapæ¥æŒæœ‰è¿™äº›BeanDefinitionæ•°æ®çš„ã€‚æ¯”å¦‚DefaultListableBeanFactory ä¸­çš„
    	ã€€	beanDefinitionMapå±æ€§
    	
    2.10.afterRefreshå®šä¹‰ä¸€ä¸ªç©ºçš„æ¨¡æ¿ç»™å…¶ä»–å­ç±»é‡å†™
    2.11.listeners.started(context);ä½¿ç”¨å¹¿æ’­å’Œå›è°ƒæœºåˆ¶é€šçŸ¥ç›‘å¬å™¨SpringBootå®¹å™¨å·²ç»å¯åŠ¨æˆåŠŸ
    2.12.listeners.running(context);ä½¿ç”¨å¹¿æ’­å’Œå›è°ƒæœºåˆ¶é€šçŸ¥ç›‘å¬å™¨SpringBootå®¹å™¨å¯åŠ¨æˆåŠŸ
```



#### é…ç½®æ–‡ä»¶å€¼æ³¨å…¥

```java
/**
 * å°†é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„æ¯ä¸€ä¸ªå±æ€§çš„å€¼ï¼Œæ˜ å°„åˆ°è¿™ä¸ªç»„ä»¶ä¸­
 * @ConfigurationPropertiesï¼šå‘Šè¯‰SpringBootå°†æœ¬ç±»ä¸­çš„æ‰€æœ‰å±æ€§å’Œé…ç½®æ–‡ä»¶ä¸­ç›¸å…³çš„é…ç½®è¿›è¡Œç»‘å®šï¼›
 *      prefix = "person"ï¼šé…ç½®æ–‡ä»¶ä¸­å“ªä¸ªä¸‹é¢çš„æ‰€æœ‰å±æ€§è¿›è¡Œä¸€ä¸€æ˜ å°„
 *
 * åªæœ‰è¿™ä¸ªç»„ä»¶æ˜¯å®¹å™¨ä¸­çš„ç»„ä»¶ï¼Œæ‰èƒ½å®¹å™¨æä¾›çš„@ConfigurationPropertiesåŠŸèƒ½ï¼›
 *  @ConfigurationProperties(prefix = "person")é»˜è®¤ä»å…¨å±€é…ç½®æ–‡ä»¶ä¸­è·å–å€¼ï¼›
 *
 * @ImportResourceï¼šå¯¼å…¥Springçš„é…ç½®æ–‡ä»¶ï¼Œè®©é…ç½®æ–‡ä»¶é‡Œé¢çš„å†…å®¹ç”Ÿæ•ˆï¼›
 * Spring Booté‡Œé¢æ²¡æœ‰Springçš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬è‡ªå·±ç¼–å†™çš„é…ç½®æ–‡ä»¶ï¼Œä¹Ÿä¸èƒ½è‡ªåŠ¨è¯†åˆ«ï¼›
 * æƒ³è®©Springçš„é…ç½®æ–‡ä»¶ç”Ÿæ•ˆï¼ŒåŠ è½½è¿›æ¥ï¼›@ImportResourceæ ‡æ³¨åœ¨ä¸€ä¸ªé…ç½®ç±»ä¸Š
 *
 **/
@Component
@ImportResource(locations = {"classpath:beans.xml"})
@PropertySource(value = {"classpath:person.properties"})
@ConfigurationProperties(prefix = "person")
```



### SpringBoot+SpringCloud

å‚è€ƒï¼š[SpringBoot+SpringCloudé¢è¯•é¢˜æ•´ç†](https://blog.csdn.net/qq_40117549/article/details/84944840?depth_1-utm_source=distribute.pc_relevant.none-task&utm_source=distribute.pc_relevant.none-task ) 



### å½»åº•ææ¸…æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨çš„åŒºåˆ«

å‚è€ƒ:   [å½»åº•ææ¸…æ‹¦æˆªå™¨å’Œè¿‡æ»¤å™¨çš„åŒºåˆ«](https://blog.csdn.net/longzhongxiaoniao/article/details/85727725)  [è¿‡æ»¤å™¨ï¼Œæ‹¦æˆªå™¨ï¼Œç›‘å¬å™¨çš„åŒºåˆ«](https://www.cnblogs.com/lukelook/p/11079113.html)

```
ä¸‰è€…ä½¿ç”¨åœºæ™¯
ä¸‰è€…åŠŸèƒ½ç±»ä¼¼ï¼Œä½†å„æœ‰ä¼˜åŠ¿ï¼Œä»è¿‡æ»¤å™¨--ã€‹æ‹¦æˆªå™¨--ã€‹åˆ‡é¢ï¼Œæ‹¦æˆªè§„åˆ™è¶Šæ¥è¶Šç»†è‡´ï¼Œæ‰§è¡Œé¡ºåºä¾æ¬¡æ˜¯è¿‡æ»¤å™¨ã€æ‹¦æˆªå™¨ã€åˆ‡é¢ã€‚ä¸€èˆ¬æƒ…å†µä¸‹æ•°æ®è¢«è¿‡æ»¤çš„æ—¶æœºè¶Šæ—©å¯¹æœåŠ¡çš„æ€§èƒ½å½±å“è¶Šå°ï¼Œå› æ­¤æˆ‘ä»¬åœ¨ç¼–å†™ç›¸å¯¹æ¯”è¾ƒå…¬ç”¨çš„ä»£ç æ—¶ï¼Œä¼˜å…ˆè€ƒè™‘è¿‡æ»¤å™¨ï¼Œç„¶åæ˜¯æ‹¦æˆªå™¨ï¼Œæœ€åæ˜¯aopã€‚æ¯”å¦‚æƒé™æ ¡éªŒï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½éœ€è¦åšç™»é™†æ ¡éªŒï¼Œæ­¤æ—¶å°±åº”è¯¥ä½¿ç”¨è¿‡æ»¤å™¨åœ¨æœ€é¡¶å±‚åšæ ¡éªŒï¼›æ—¥å¿—è®°å½•ï¼Œä¸€èˆ¬æ—¥å¿—åªä¼šé’ˆå¯¹éƒ¨åˆ†é€»è¾‘åšæ—¥å¿—è®°å½•ï¼Œè€Œä¸”ç‰µæ‰¯åˆ°ä¸šåŠ¡é€»è¾‘å®Œæˆå‰åçš„æ—¥å¿—è®°å½•ï¼Œå› æ­¤ä½¿ç”¨è¿‡æ»¤å™¨ä¸èƒ½ç»†è‡´åœ°åˆ’åˆ†æ¨¡å—ï¼Œæ­¤æ—¶åº”è¯¥è€ƒè™‘æ‹¦æˆªå™¨ï¼Œç„¶è€Œæ‹¦æˆªå™¨ä¹Ÿæ˜¯ä¾æ®URLåšè§„åˆ™åŒ¹é…ï¼Œå› æ­¤ç›¸å¯¹æ¥è¯´ä¸å¤Ÿç»†è‡´ï¼Œå› æ­¤æˆ‘ä»¬ä¼šè€ƒè™‘åˆ°ä½¿ç”¨AOPå®ç°ï¼ŒAOPå¯ä»¥é’ˆå¯¹ä»£ç çš„æ–¹æ³•çº§åˆ«åšæ‹¦æˆªï¼Œå¾ˆé€‚åˆæ—¥å¿—åŠŸèƒ½ã€‚
```



### Shiro

å‚è€ƒï¼š[Shiroé¢è¯•çŸ¥è¯†ç‚¹](https://www.jianshu.com/p/e6ca8cd7d823)   [Shiroå·¥ä½œæµç¨‹](https://www.cnblogs.com/insaneXs/p/10999384.html)   [30åˆ†é’Ÿå¦‚ä½•å­¦ä¼šä½¿ç”¨Shiro](https://blog.csdn.net/mxw2552261/article/details/79674871)   [SpringBoot+Shiro+Jwtå®ç°ç™»å½•è®¤è¯](https://www.jianshu.com/p/9b6eb3308294)

```
1.æŒ‡å®šé…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶ä¸­æŒ‡å®šauthenticatorï¼ˆè®¤è¯ï¼‰ç±»å‹ã€‚åˆå§‹åŒ–ç”ŸæˆsecurityManagerï¼Œåˆå§‹åŒ–securityManagerä¸­çš„authenticatorï¼ˆè®¤è¯ï¼‰å’Œrealmsï¼ˆæºï¼‰ã€‚securityManagerå­˜å‚¨ä¸ºå…¨å±€å˜é‡ã€‚

2.åˆ›å»ºæˆ–è·å–subjectï¼ˆç”¨äºä»£è¡¨å½“å‰ç”¨æˆ·çš„å®ä½“ï¼‰ï¼Œçº¿ç¨‹ç§æœ‰å˜é‡ï¼Œå­˜å‚¨äºthreadlocalä¸Šã€‚

3.subjectè°ƒç”¨loginï¼ˆUsernamePasswordTokenï¼‰æ–¹æ³•ï¼Œç”¨äºæ¨¡æ‹Ÿç”¨æˆ·ç™»å½•ï¼ŒUsernamePasswordTokenä»£è¡¨ç”¨æˆ·åå’Œå¯†ç çš„æŠ½è±¡ã€‚

4.å§”æ´¾ç»™securityManagerå¤„ç†ã€‚

5.securityManagerå§”æ´¾ç»™åˆå§‹åŒ–æ—¶æŒ‡å®šçš„authenticatorï¼ˆè®¤è¯ï¼‰çœŸæ­£å¤„ç†ã€‚

6.authenticatorå¾ªç¯realmsï¼Œè°ƒç”¨realmä¸­çš„doGetAuthenticationInfoï¼ˆç”¨äºèº«ä»½éªŒè¯ï¼‰è¿›è¡Œèº«ä»½è®¤è¯ã€‚å¯ç»§æ‰¿realmï¼Œ

é‡å†™doGetAuthenticationInfoæ–¹æ³•ï¼Œåœ¨å…¶ä¸­ç¼–å†™èº«ä»½è®¤è¯çš„ä¸šåŠ¡é€»è¾‘ã€‚éªŒè¯å¤±è´¥éœ€æŠ›å¼‚å¸¸ã€‚

7.è‹¥éœ€åˆ¤æ–­ç”¨æˆ·çš„è§’è‰²æˆ–æƒé™ï¼Œè°ƒç”¨subjectï¼ˆä»£è¡¨å½“å‰ç”¨æˆ·çš„å®ä½“ï¼‰çš„hasrolesç­‰æ–¹æ³•ã€‚

8.å§”æ´¾ç»™securityManagerå¤„ç†ã€‚

9.securityManagerå§”æ´¾ç»™Authorizatorï¼ˆæˆæƒï¼‰å¤„ç†ã€‚

10.Authorizatorè°ƒç”¨realmçš„doGetAuthorizationInfoæ–¹æ³•è·å–è§’è‰²å’Œæƒé™ï¼Œç”¨äºæ¯”è¾ƒã€‚
```



### å‰ç«¯çŸ¥è¯†ç‚¹

> jsè§£å†³ä¹±ç é—®é¢˜

```js
window.open('revoke/export?'+'&userName='+encodeURIComponent(this.userName));
```



> å¯¹è±¡ä½¿ç”¨key

```
p{
	//ä¸æ¢è¡Œ
	white-space: nowrap
}

var user = {};
user["id"] = 1;
console.log(user); //{id:1}

//å¦å¤–å¤šæä¸€ä¸ªçŸ¥è¯†ç‚¹
returnã€breakä¸èƒ½ç»ˆæ­¢forEach()å¾ªç¯
```



> å¼•ç”¨JSé™æ€æ•°æ®

```js
/* jsæ•°æ® */
let list_data = [
  { id: '1', name: 'ç”²', age: '18' },
  { id: '2', name: 'ä¹™', age: '14' },
  { id: '3', name: 'ä¸™', age: '22' },
  { id: '4', name: 'ä¸™', age: '17' }
];
module.exports = {list_data};

/* ä½¿ç”¨æ•°æ® */
let datas = require('../../datas/listData');
console.log(typeof datas, datas);

--------------------------------------------------------------------------------

export default function request(){
    console.log("request");
}

//å¼•ç”¨
let request = require('../../request');
//ä½¿ç”¨
request();


```



### é™æ€èµ„æºæ–‡ä»¶æ— æ³•è®¿é—®

```xml
<build>
	<resources>
		<resource>
			<directory>src/main/resources</directory>
		</resource>
	</resources>
</build>
```



### è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨åŒºåˆ«

å‚è€ƒï¼š[è¿‡æ»¤å™¨å’Œæ‹¦æˆªå™¨åŒºåˆ«](https://www.jianshu.com/p/7bd0cad17f23)



### åºåˆ—åŒ–ä¸ååºåˆ—åŒ–

å‚è€ƒï¼š[åºåˆ—åŒ–ä¸ååºåˆ—åŒ–](https://blog.csdn.net/tree_ifconfig/article/details/82766587 )



### SOAP

å‚è€ƒï¼š[SOAP](https://www.runoob.com/soap/soap-tutorial.html)

```
SOAP æ˜¯åŸºäº XML çš„ç®€æ˜“åè®®ï¼Œå¯ä½¿åº”ç”¨ç¨‹åºåœ¨ HTTP ä¹‹ä¸Šè¿›è¡Œä¿¡æ¯äº¤æ¢ã€‚
æˆ–è€…æ›´ç®€å•åœ°è¯´ï¼šSOAP æ˜¯ç”¨äºè®¿é—®ç½‘ç»œæœåŠ¡çš„åè®®ã€‚
```



> ä¸ºä»€ä¹ˆä½¿ç”¨ SOAPï¼Ÿ
```
å¯¹äºåº”ç”¨ç¨‹åºå¼€å‘æ¥è¯´ï¼Œä½¿ç¨‹åºä¹‹é—´è¿›è¡Œå› ç‰¹ç½‘é€šä¿¡æ˜¯å¾ˆé‡è¦çš„ã€‚

ç›®å‰çš„åº”ç”¨ç¨‹åºé€šè¿‡ä½¿ç”¨è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰åœ¨è¯¸å¦‚ DCOM ä¸ CORBA ç­‰å¯¹è±¡ä¹‹é—´è¿›è¡Œé€šä¿¡ï¼Œä½†æ˜¯ HTTP ä¸æ˜¯ä¸ºæ­¤è®¾è®¡çš„ã€‚RPC ä¼šäº§ç”Ÿå…¼å®¹æ€§ä»¥åŠå®‰å…¨é—®é¢˜ï¼›é˜²ç«å¢™å’Œä»£ç†æœåŠ¡å™¨é€šå¸¸ä¼šé˜»æ­¢æ­¤ç±»æµé‡ã€‚

é€šè¿‡ HTTP åœ¨åº”ç”¨ç¨‹åºé—´é€šä¿¡æ˜¯æ›´å¥½çš„æ–¹æ³•ï¼Œå› ä¸º HTTP å¾—åˆ°äº†æ‰€æœ‰çš„å› ç‰¹ç½‘æµè§ˆå™¨åŠæœåŠ¡å™¨çš„æ”¯æŒã€‚SOAPå°±æ˜¯è¢«åˆ›é€ å‡ºæ¥å®Œæˆè¿™ä¸ªä»»åŠ¡çš„ã€‚

SOAPæä¾›äº†ä¸€ç§æ ‡å‡†çš„æ–¹æ³•ï¼Œä½¿å¾—è¿è¡Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿå¹¶ä½¿ç”¨ä¸åŒçš„æŠ€æœ¯å’Œç¼–ç¨‹è¯­è¨€çš„åº”ç”¨ç¨‹åºå¯ä»¥äº’ç›¸è¿›è¡Œé€šä¿¡ã€‚
```



> SOAPè¯­æ³•

```xml
ä¸€æ¡ SOAP æ¶ˆæ¯å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ XML æ–‡æ¡£ï¼ŒåŒ…å«ä¸‹åˆ—å…ƒç´ ï¼š
    å¿…éœ€çš„ Envelope å…ƒç´ ï¼Œå¯æŠŠæ­¤ XML æ–‡æ¡£æ ‡è¯†ä¸ºä¸€æ¡ SOAP æ¶ˆæ¯
    å¯é€‰çš„ Header å…ƒç´ ï¼ŒåŒ…å«å¤´éƒ¨ä¿¡æ¯
    å¿…éœ€çš„ Body å…ƒç´ ï¼ŒåŒ…å«æ‰€æœ‰çš„è°ƒç”¨å’Œå“åº”ä¿¡æ¯
    å¯é€‰çš„ Fault å…ƒç´ ï¼Œæä¾›æœ‰å…³åœ¨å¤„ç†æ­¤æ¶ˆæ¯æ‰€å‘ç”Ÿé”™è¯¯çš„ä¿¡æ¯
    
<?xml version="1.0"?>
<soap:Envelope
xmlns:soap="http://www.w3.org/2001/12/soap-envelope"
soap:encodingStyle="http://www.w3.org/2001/12/soap-encoding">
    <soap:Header>
    ...
    </soap:Header>

    <soap:Body>
    ...
      <soap:Fault>
      ...
      </soap:Fault>
    </soap:Body>
</soap:Envelope>
```



### TCP/IPåè®®æ—

```
è®¡ç®—æœºè®¾å¤‡ä¸ç½‘ç»œéœ€è¦é€šä¿¡ï¼ŒåŒæ–¹å°±å¿…é¡»åŸºäºç›¸åŒçš„æ–¹æ³•ã€‚
æ¯”å¦‚ ä½•å¦‚èƒä¾§åˆ°é€šä¿¡ç›®æ ‡ï¼Œç”±å“ªä¸€è¾¹å…ˆå‘èµ·é€šä¿¡ï¼Œä½¿ç”¨å“ªç§è¯­è¨€è¿›è¡Œé€šä¿¡ï¼Œæ€æ ·ç»“æŸé€šè®¯ç­‰è§„åˆ™éƒ½éœ€è¦äº‹å…ˆç¡®å®šã€‚ä¸åŒçš„ç¡¬ä»¶ã€æ“ä½œç³»ç»Ÿä¹‹é—´çš„é€šè®¯ï¼Œæ‰€æœ‰è¿™ä¸€åˆ‡éƒ½éœ€è¦ä¸€ç§è§„åˆ™ï¼Œè€Œæˆ‘ä»¬æŠŠè¿™ç§è§„åˆ™æˆä¸ºåè®®ã€‚
ä¾‹å¦‚ï¼šTCPã€IPã€FCPã€DNCã€HTTPç­‰ã€‚åƒè¿™æ ·æŠŠä¸äº’è”ç½‘ç›¸å…³è”çš„åè®®é›†åˆèµ·æ¥ç§°ä¸ºTPC/IPã€‚
```



### TCP/IPåˆ†å±‚ç®¡ç†

```
TCP/IPåè®®æ—ä¸­æœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯åˆ†å±‚ã€‚æŒ‰å±‚æ¬¡åˆ†åˆ«åˆ†ä¸ºï¼šåº”ç”¨å±‚ã€ä¼ è¾“å±‚ã€ç½‘ç»œå±‚ã€æ•°æ®é“¾è·¯å±‚ã€‚
æŠŠTCP/IPfåˆ†å±‚åŒ–æ˜¯æœ‰å¥½å¤„çš„ï¼Œæ¯”å¦‚ï¼Œå¦‚æœäº’è”ç½‘åªç”±ä¸€ä¸ªåè®®ç»Ÿç­¹ï¼ŒæŸä¸ªåœ°æ–¹éœ€è¦ä¿®æ”¹è®¾è®¡æ—¶ï¼Œå°±å¿…é¡»æŠŠæ‰€æœ‰éƒ¨åˆ†æ•´ä½“æ›¿æ¢æ‰ã€‚è€Œåˆ†å±‚ä¹‹ååªéœ€æŠŠå˜åŠ¨çš„å±‚æ›¿æ¢æ‰å³å¯ã€‚

åº”ç”¨å±‚ï¼šåº”ç”¨å±‚å†³å®šäº†å‘ç”¨æˆ·æä¾›åº”ç”¨æœåŠ¡æ—¶é€šä¿¡çš„æ´»åŠ¨
ä¼ è¾“å±‚ï¼šä¼ è¾“å±‚å¯¹ä¸Šå±‚åº”ç”¨å±‚ï¼Œæä¾›å¤„äºç½‘ç»œè¿æ¥ä¸­çš„ä¸¤å°è®¡ç®—æœºä¹‹é—´çš„æ•°æ®ä¼ è¾“ã€‚
ç½‘ç»œå±‚ï¼šç½‘ç»œå±‚ç”¨æ¥å¤„ç†åœ¨ç½‘ç»œä¸ŠæµåŠ¨æ•°æ®åŒ…ï¼Œæ•°æ®åŒ…æ—¶ç½‘ç»œä¼ è¾“çš„æœ€å°æ•°æ®å•ä½
æ•°æ®é“¾è·¯å±‚(ç½‘ç»œæ¥å£å±‚)ï¼šç”¨æ¥é“¾æ¥ç½‘ç»œç¡¬ä»¶éƒ¨åˆ†
```



### TCP/IPé€šä¿¡ä¼ è¾“æµ

```
			  å®¢æˆ·ç«¯			æœåŠ¡ç«¯
			  
åº”ç”¨å±‚		  HTTTPå®¢æˆ·ç«¯		HTTPæœåŠ¡å™¨
				â†•				â†•
ä¼ è¾“å±‚			 TCP			 TCP
				â†•				â†•
ç½‘ç»œå±‚			  IP			  IP
				â†•				â†•
æ•°æ®é“¾è·¯å±‚	    ç½‘ç»œ			   ç½‘ç»œ
				â†“				â†‘
				â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’â†’
åˆ©ç”¨TCP/IPåè®®æ—è¿›è¡Œç½‘ç»œé€šè®¯æ—¶ï¼Œä¼šé€šè¿‡åˆ†å±‚é¡ºåºä¸å¯¹æ–¹è¿›è¡Œé€šä¿¡ï¼Œå‘é€ç«¯ä»åº”ç”¨å±‚å¾€ä¸‹èµ°ï¼Œæ¥æ”¶ç«¯ä»é“¾è·¯å±‚å¾€ä¸Šèµ°	
				
```



### TCPçš„ä¸‰æ¬¡æ¡æ‰‹

å‚è€ƒï¼š[TCPçš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹ç†è§£åŠé¢è¯•é¢˜](https://blog.csdn.net/qq_38950316/article/details/81087809)   [TCPä¸‰æ¬¡æ¡æ‰‹è¯¦ç»†è¿‡ç¨‹](https://blog.csdn.net/huaishu/article/details/93739446)

```
ä¸ºäº†å‡†ç¡®æ— è¯¯å¾—å°†æ•°æ®é€è¾¾ç›®æ ‡å¤„ï¼ŒTCPåè®®é‡‡ç”¨äº†ä¸‰æ¬¡æ¡æ‰‹ç­–ç•¥ã€‚ç”¨TCPåè®®æŠŠæ•°æ®åŒ…é€å‡ºå»åï¼ŒTCPä¸ä¼šå¯¹ä¼ é€åçš„æƒ…å†µç½®ä¹‹ä¸ç†ï¼Œå®ƒä¸€å®šä¼šå‘å¯¹æ–¹ç¡®è®¤æ˜¯å¦æˆåŠŸé€è¾¾ã€‚æ¡æ‰‹è¿‡ç¨‹ä¸­ä½¿ç”¨äº†TCPçš„æ ‡å¿—(flag)â€”â€”SYN(synchronize)å’ŒACK(acknowledgement)

å‘é€ç«¯é¦–å…ˆå‘é€ä¸€ä¸ªå¸¦SYNæ ‡å¿—çš„æ•°æ®åŒ…ç»™å¯¹æ–¹ã€‚æ¥æ”¶ç«¯æ”¶åˆ°åï¼Œå›ä¼ ä¸€ä¸ªå¸¦æœ‰SYN/ACKæ ‡å¿—çš„æ•°æ®åŒ…ä»¥ç¤ºä¼ è¾¾ç¡®è®¤ä¿¡æ¯ã€‚æœ€åï¼Œå‘é€ç«¯å›ä¼ ä¸€ä¸ªå¸¦ACKæ ‡å¿—çš„æ•°æ®åŒ…ï¼Œä»£è¡¨'æ¡æ‰‹'/ç»“æŸã€‚

è‹¥åœ¨æ¡æ‰‹è¿‡ç¨‹ä¸­æŸä¸ªé˜¶æ®µè«åä¸­æ–­ï¼ŒTCPåè®®ä¼šå†æ¬¡ä»¥ç›¸åŒçš„é¡ºåºå‘é€ç›¸åŒçš„æ•°æ®åŒ…ã€‚
```



### RPCé¢è¯•é¢˜

å‚è€ƒï¼š[RPCé¢è¯•é¢˜](https://www.cnblogs.com/feifeicui/p/10431529.html )



### HTTPS

å‚è€ƒï¼š[httpsåŠ å¯†æœºåˆ¶](https://blog.csdn.net/iCode_girl/article/details/108541202)   [httpsåŸç†](http://www.easemob.com/news/3706)



### WebServiceé¢è¯•é¢˜

å‚è€ƒï¼š[WebServiceé¢è¯•é¢˜](https://blog.csdn.net/c99463904/article/details/76018436?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1) 



### è´Ÿè½½å‡è¡¡

[è´Ÿè½½å‡è¡¡åˆ†ç±»](https://www.jianshu.com/p/c48af7936329)

[ä»‹ç»è´Ÿè½½å‡è¡¡çš„é¢è¯•è¯æœ¯](https://blog.csdn.net/yuanaili/article/details/81191408)



### Nginx

å‚è€ƒï¼š[Nginxé¢è¯•](<https://blog.csdn.net/a303549861/article/details/88672901>)

å‚è€ƒï¼š[Nginxæ˜¯ä»€ä¹ˆ ? èƒ½å¹²å˜› ï¼Ÿ](<https://blog.csdn.net/forezp/article/details/87887507>)

å‚è€ƒï¼š [Windows ä¸‹Nginxé‡å¯é¡¹ç›®ä¸é‡æ–°åŠ è½½](https://www.cnblogs.com/zjfblog/p/11854946.html) 

```
Nignxæ˜¯ä¸€ä¸ªå¼€æºçš„ã€é«˜æ€§èƒ½çš„è½»é‡çº§çš„HTTPæœåŠ¡å™¨å’Œåå‘ä»£ç†æœåŠ¡å™¨ï¼›
Nginxå¯ä»¥ä½œä¸ºä¸€ä¸ªHTTPæœåŠ¡å™¨è¿›è¡Œç½‘ç«™çš„å‘å¸ƒå¤„ç†ï¼Œå¦å¤–Nginxå¯ä»¥ä½œä¸ºåå‘ä»£ç†è¿›è¡Œè´Ÿè½½å‡è¡¡çš„å®ç°ã€‚

æ­£å‘ä»£ç†ã€åå‘ä»£ç†ã€è´Ÿè½½å‡è¡¡
```



### Lvs + Keeplived + Nginx

> Lvs

```
LVSæ˜¯ä¸€ä¸ªå¼€æºçš„è½¯ä»¶ï¼Œå¯ä»¥å®ç°ä¼ è¾“å±‚å››å±‚è´Ÿè½½å‡è¡¡ã€‚LVSæ˜¯Linux Virtual Serverçš„ç¼©å†™ï¼Œæ„æ€æ˜¯Linuxè™šæ‹ŸæœåŠ¡å™¨ã€‚ç›®å‰æœ‰ä¸‰ç§IPè´Ÿè½½å‡è¡¡æŠ€æœ¯ï¼ˆVS/NATã€VS/TUNå’ŒVS/DRï¼‰ï¼›å…«ç§è°ƒåº¦ç®—æ³•ï¼ˆrr,wrr,lc,wlc,lblc,lblcr,dh,shï¼‰ã€‚
```



> Keeplived

```
LVSå¯ä»¥å®ç°è´Ÿè½½å‡è¡¡ï¼Œä½†æ˜¯ä¸èƒ½å¤Ÿè¿›è¡Œå¥åº·æ£€æŸ¥ï¼Œæ¯”å¦‚ä¸€ä¸ªrså‡ºç°æ•…éšœï¼ŒLVS ä»ç„¶ä¼šæŠŠè¯·æ±‚è½¬å‘ç»™æ•…éšœçš„rsæœåŠ¡å™¨ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´è¯·æ±‚çš„æ— æ•ˆæ€§ã€‚keepalive è½¯ä»¶å¯ä»¥è¿›è¡Œå¥åº·æ£€æŸ¥ï¼Œè€Œä¸”èƒ½åŒæ—¶å®ç° LVS çš„é«˜å¯ç”¨æ€§ï¼Œè§£å†³ LVS å•ç‚¹æ•…éšœçš„é—®é¢˜ï¼Œå…¶å® keepalive å°±æ˜¯ä¸º LVS è€Œç”Ÿçš„ã€‚
```



```
LVSçš„è´Ÿè½½èƒ½åŠ›å¼ºï¼Œå› ä¸ºå…¶å·¥ä½œæ–¹å¼é€»è¾‘éå¸¸ç®€å•ï¼Œä»…è¿›è¡Œè¯·æ±‚åˆ†å‘ï¼Œè€Œä¸”å·¥ä½œåœ¨ç½‘ç»œçš„ç¬¬4å±‚ï¼Œæ²¡æœ‰æµé‡ï¼Œæ‰€ä»¥å…¶æ•ˆç‡ä¸éœ€è¦æœ‰è¿‡å¤šçš„å¿§è™‘ã€‚

LVSåŸºæœ¬èƒ½æ”¯æŒæ‰€æœ‰åº”ç”¨ï¼Œå› ä¸ºå·¥ä½œåœ¨ç¬¬4å±‚ï¼Œæ‰€ä»¥LVSå¯ä»¥å¯¹å‡ ä¹æ‰€æœ‰åº”ç”¨è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼ŒåŒ…æ‹¬Webã€æ•°æ®åº“ç­‰ã€‚

æ³¨æ„ï¼šLVSå¹¶ä¸èƒ½å®Œå…¨åˆ¤åˆ«èŠ‚ç‚¹æ•…éšœï¼Œæ¯”å¦‚åœ¨WLCè§„åˆ™ä¸‹ï¼Œå¦‚æœé›†ç¾¤é‡Œæœ‰ä¸€ä¸ªèŠ‚ç‚¹æ²¡æœ‰é…ç½®VIPï¼Œå°†ä¼šå¯¼è‡´æ•´ä¸ªé›†ç¾¤ä¸èƒ½ä½¿ç”¨ã€‚è¿˜æœ‰ä¸€äº›å…¶ä»–é—®é¢˜ï¼Œç›®å‰å°šéœ€è¿›ä¸€æ­¥æµ‹è¯•ã€‚

Nginxå·¥ä½œåœ¨ç½‘è·¯ç¬¬7å±‚ï¼Œæ‰€ä»¥å¯ä»¥å¯¹HTTPåº”ç”¨å®æ–½åˆ†æµç­–ç•¥ï¼Œæ¯”å¦‚åŸŸåã€ç»“æ„ç­‰ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒLVSå¹¶ä¸å…·å¤‡è¿™æ ·çš„åŠŸèƒ½ï¼Œæ‰€ä»¥Nginxå¯ä½¿ç”¨çš„åœºåˆè¿œå¤šäºLVSã€‚å¹¶ä¸”Nginxå¯¹ç½‘ç»œçš„ä¾èµ–æ¯”è¾ƒå°ï¼Œç†è®ºä¸Šåªè¦Pingå¾—é€šï¼Œç½‘é¡µè®¿é—®æ­£å¸¸å°±èƒ½è¿é€šã€‚LVSæ¯”è¾ƒä¾èµ–ç½‘ç»œç¯å¢ƒã€‚åªæœ‰ä½¿ç”¨DRæ¨¡å¼ä¸”æœåŠ¡å™¨åœ¨åŒä¸€ç½‘æ®µå†…åˆ†æµï¼Œæ•ˆæœæ‰èƒ½å¾—åˆ°ä¿è¯ã€‚

Nginxå¯ä»¥é€šè¿‡æœåŠ¡å™¨å¤„ç†ç½‘é¡µè¿”å›çš„çŠ¶æ€å—ã€è¶…æ—¶ç­‰æ¥æ£€æµ‹æœåŠ¡å™¨å†…éƒ¨çš„æ•…éšœï¼Œå¹¶ä¼šæŠŠè¿”å›é”™è¯¯çš„è¯·æ±‚é‡æ–°å‘é€åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ã€‚ç›®å‰LVSå’ŒLDirectd ä¹Ÿæ”¯æŒå¯¹æœåŠ¡å™¨å†…éƒ¨æƒ…å†µçš„ç›‘æ§ï¼Œä½†ä¸èƒ½é‡æ–°å‘é€è¯·æ±‚ã€‚

æ¯”å¦‚ç”¨æˆ·æ­£åœ¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œè€Œå¤„ç†è¯¥ä¸Šä¼ ä¿¡æ¯çš„èŠ‚ç‚¹åˆšå¥½å‡ºç°æ•…éšœï¼Œåˆ™Nginxä¼šæŠŠä¸Šä¼ è¯·æ±‚é‡æ–°å‘é€åˆ°å¦ä¸€å°æœåŠ¡å™¨ï¼Œè€ŒLVSåœ¨è¿™ç§æƒ…å†µä¸‹ä¼šç›´æ¥æ–­æ‰ã€‚Nginxè¿˜èƒ½æ”¯æŒHTTPå’ŒEmailï¼ˆEmailåŠŸèƒ½å¾ˆå°‘æœ‰äººä½¿ç”¨ï¼‰ï¼ŒLVSæ‰€æ”¯æŒçš„åº”ç”¨åœ¨è¿™ä¸ªç”µå•†æ¯”Nginxæ›´å¤šã€‚

NginxåŒæ ·èƒ½æ‰¿å—å¾ˆé«˜è´Ÿè½½å¹¶ä¸”èƒ½ç¨³å®šè¿è¡Œï¼Œç”±äºå¤„ç†æµé‡å—é™äºæœºå™¨I/Oç­‰é…ç½®ï¼Œæ‰€ä»¥è´Ÿè½½èƒ½åŠ›ç›¸å¯¹è¾ƒå·®ã€‚

Nginx å®‰è£…ã€é…ç½®åŠæµ‹è¯•ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œå› ä¸ºæœ‰ç›¸åº”çš„é”™è¯¯æ—¥å¿—è¿›è¡Œæç¤ºã€‚LVSçš„å®‰è£…ã€é…ç½®åŠæµ‹è¯•æ‰€èŠ±çš„æ—¶é—´æ¯”è¾ƒé•¿ï¼Œå› ä¸ºLVSå¯¹ç½‘ç»œä»¥æ¥æ¯”è¾ƒå¤§ï¼Œå¾ˆå¤šæ—¶å€™æœ‰å¯èƒ½å› ä¸ºç½‘ç»œé—®é¢˜è€Œé…ç½®ä¸èƒ½æˆåŠŸï¼Œå‡ºç°é—®é¢˜æ—¶ï¼Œè§£å†³çš„éš¾åº¦ä¹Ÿç›¸å¯¹è¾ƒå¤§ã€‚Nginxæœ¬èº«æ²¡æœ‰ç°æˆçš„çƒ­å¤‡æ–¹æ¡ˆï¼Œæ‰€ä»¥åœ¨å•æœºä¸Šè¿è¡Œé£é™©è¾ƒå¤§ï¼Œå»ºè®®KeepAlivedé…åˆä½¿ç”¨ã€‚å¦å¤–ï¼ŒNginxå¯ä»¥ä½œä¸ºLVSçš„èŠ‚ç‚¹æœºå™¨ä½¿ç”¨ï¼Œå……åˆ†åˆ©ç”¨Nginxçš„åŠŸèƒ½å’Œæ€§èƒ½ã€‚å½“ç„¶è¿™ç§æƒ…å†µä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨Squidç­‰å…¶ä»–å…·å¤‡åˆ†å‘åŠŸèƒ½çš„è½¯ä»¶ã€‚

å…·ä½“åº”ç”¨å…·ä½“åˆ†æã€‚å¦‚æœæ˜¯æ¯”è¾ƒå°å‹çš„ç½‘ç«™ï¼ˆæ¯æ—¥PVå°äº100ä¸‡ï¼‰ï¼Œç”¨æˆ·Nginxå°±å®Œå…¨å¯ä»¥åº”å¯¹ï¼Œå¦‚æœæœºå™¨ä¹Ÿä¸å°‘ï¼Œå¯ä»¥ç”¨DNSè½®è¯¢ã€‚LVSåç”¨çš„æœºå™¨è¾ƒå¤šï¼Œåœ¨æ„å»ºå¤§å‹ç½‘ç«™æˆ–è€…æä¾›é‡è¦æœåŠ¡ä¸”æœºå™¨è¾ƒå¤šæ—¶ï¼Œå¯å¤šåŠ è€ƒè™‘åˆ©ç”¨LVSã€‚
```



### List Map 

å‚è€ƒï¼š[JAVAä¸­çš„é›†åˆ](https://blog.csdn.net/weixin_36027342/article/details/79972399)



### Listå¯¹è±¡å»é‡

```java
List<String> dataList = list.stream().distinct().collect(Collectors.toList());

//æ ¹æ®idå»é‡
personList=
    personList.stream().collect(Collectors.collectingAndThen(Collectors.toCollection(
                // åˆ©ç”¨ TreeSet çš„æ’åºå»é‡æ„é€ å‡½æ•°æ¥è¾¾åˆ°å»é‡å…ƒç´ çš„ç›®çš„
                // æ ¹æ®firstNameå»é‡
                () -> new TreeSet<>(Comparator.comparing(Person::getName))), ArrayList::new));
```



### Listäº¤é›†å¹¶é›†å·®é›†

```java
äº¤é›†	listA.retainAll(listB)	listAå†…å®¹å˜ä¸ºlistAå’ŒlistBéƒ½å­˜åœ¨çš„å¯¹è±¡	listBä¸å˜
å·®é›†	listA.removeAll(listB)	listAä¸­å­˜åœ¨çš„listBçš„å†…å®¹å»é‡	listBä¸å˜
å¹¶é›†	listA.removeAll(listB)	listA.addAll(listB)	listAå­˜åœ¨å¹¶é›†	listBä¸å˜

//äº¤é›†
List<Person> listC = listA.stream().filter(item -> listB.contains(item)).collect(Collectors.toList());

//å¹¶é›†
//å…ˆåˆä½“
listA.addAll(listB);
//å†å»é‡
List<Person> listC = listA.stream().distinct().collect(Collectors.toList());

//å·®é›†
List<Person> listC = listA.stream().filter(item -> !listB.contains(item)).collect(Collectors.toList());
```



### HashMapçº¢é»‘æ ‘

å‚è€ƒï¼š[HashMapçº¢é»‘æ ‘](https://www.jianshu.com/p/2c7a4a4e1f53)   [HashMapç†è§£](https://blog.csdn.net/wenyiqingnianiii/article/details/52204136)



### Tomcatä¼˜åŒ–

å‚è€ƒï¼š[Tomcatä¼˜åŒ–](https://www.cnblogs.com/xuwc/p/8523681.html)

```
tomcatè®¾ç½®httpsç«¯å£æ—¶,8443å’Œ443åŒºåˆ«:

1. 8443ç«¯å£åœ¨è®¿é—®æ—¶éœ€è¦åŠ ç«¯å£å·,ç›¸å½“äºhttpçš„8080,ä¸å¯é€šè¿‡åŸŸåç›´æ¥è®¿é—®,éœ€è¦åŠ ä¸Šç«¯å£å·;https://yuming.com:8443ã€‚
2. 443ç«¯å£åœ¨è®¿é—®æ—¶ä¸éœ€è¦åŠ ç«¯å£å·,ç›¸å½“äºhttpçš„80,å¯é€šè¿‡åŸŸåç›´æ¥è®¿é—®;ä¾‹:https://yuming.comã€‚

httpsä½¿ç”¨åŸŸåè®¿é—®ç½‘ç«™,è€Œä¸æ˜¾ç¤ºç«¯å£å·?

å°†ç«¯å£å·è®¾ç½®ä¸º443,å³å¯é€šè¿‡åŸŸåç›´æ¥è®¿é—®ç½‘ç«™
```



### Tomcatåšæˆç³»ç»ŸæœåŠ¡

å‚è€ƒï¼š[Tomcatåšæˆç³»ç»ŸæœåŠ¡](<https://jingyan.baidu.com/article/597a0643680371312b52431a.html>)

ä¸€ï¼šä¸‹è½½tomcat

äºŒï¼šé…ç½®tomcat

1.è§£å‹tomcatè‡³è‡ªå®šä¹‰ç›®å½•ä¸‹ã€‚



2.å¦‚æœç”µè„‘ä¸Šé¢æœ‰å¤šä¸ªtomcatçš„è¯ï¼Œè¯·ä¿®æ”¹ä¸€ä¸‹tomcatæœåŠ¡ç«¯å£ï¼Œå¦åˆ™tomcatå¯åŠ¨å°†å› ä¸ºç«¯å£å†²çªä¼šå¤±è´¥ã€‚

ä¸»è¦å¯¹è§£å‹ç›®å½•ä¸‹conf/server.xmlæ–‡ä»¶è¿›è¡Œä¿®æ”¹

```xml
<Server port="9001" shutdown="SHUTDOWN">  
<Connector port="9090" protocol="HTTP/1.1"  connectionTimeout="20000" redirectPort="9061" />  
<Connector port="9081" protocol="AJP/1.3" redirectPort="9061" />
```



3.ä¿®æ”¹tomcatä¸­bin/ç›®å½•ä¸‹çš„service.batæ–‡ä»¶

1) åœ¨æ–‡ä»¶å¼€å¤´éƒ¨åˆ†æ·»åŠ ä»¥ä¸‹å†…å®¹

```xml
SET JAVA_HOME=C:\Program Files\Java\jdk1.7.0_67  
SET CATALINA_HOME=D:\server\tomcat  
SET PR_DISPLAYNAME=é¡¹ç›®åæˆ–å…¶ä»–è‡ªå®šä¹‰åç§° 
```

2) åœ¨æ–‡ä»¶ä¸­æ‰¾åˆ°rem Set default Service name  éƒ¨åˆ†å¹¶å°†å†…å®¹ä¿®æ”¹ä¸ºï¼š

```xml
set SERVICE_NAME=myporject(è‡ªå®šä¹‰åç§°)
```



4.ä¿®æ”¹binç›®å½•ä¸‹shutdown.batå’Œstartup.batæ–‡ä»¶ï¼Œåœ¨æ–‡ä»¶å¼€å¤´æ·»åŠ å†…å®¹ï¼š

```xml
SET JAVA_HOME=C:\Program Files\Java\jdk1.7.0_67  
SET CATALINA_HOME=D:\server\tomcat
```



5.æ·»åŠ æœåŠ¡

1)åœ¨DOSç•Œé¢ä¸‹,è¿›å…¥Tomcatè§£å‹ç›®å½•çš„binç›®å½•,è¾“å…¥å‘½ä»¤:

```windows
service.bat remove tomcat6

service.bat install
```

å¦‚æœå®‰è£…æˆåŠŸ,ä¼šæç¤º:The service 'Tomcat6ï¼ˆæˆ–è€…ä½ ä¿®æ”¹ä¸€åçš„SERVICE_NAMEï¼‰' has
been installed



### Mavené…ç½®æ–‡ä»¶æ¿€æ´»Spring Booté…ç½®æ–‡ä»¶

å‚è€ƒï¼š[Mavené…ç½®æ–‡ä»¶æ¿€æ´»Spring Booté…ç½®æ–‡ä»¶](http://dolszewski.com/spring/spring-boot-properties-per-maven-profile/)



### Mavenè·³è¿‡æµ‹è¯•ç¯èŠ‚æ‰“åŒ…

```cmd
mvn clean package -Dmaven.test.skip=true

# mvn clean package -Dmaven.test.skip=true -P prod
```



### Mavenå®šä¹‰è§„èŒƒ

```
	GroupIdå’ŒArtifactIdè¢«ç»Ÿç§°ä¸ºâ€œåæ ‡â€æ˜¯ä¸ºäº†ä¿è¯é¡¹ç›®å”¯ä¸€æ€§è€Œæå‡ºçš„ï¼Œå¦‚æœä½ è¦æŠŠä½ é¡¹ç›®å¼„åˆ°mavenæœ¬åœ°ä»“åº“å»ï¼Œä½ æƒ³è¦æ‰¾åˆ°ä½ çš„é¡¹ç›®å°±å¿…é¡»æ ¹æ®è¿™ä¸¤ä¸ªidå»æŸ¥æ‰¾ã€‚

ã€€ã€€GroupIdä¸€èˆ¬åˆ†ä¸ºå¤šä¸ªæ®µï¼Œè¿™é‡Œæˆ‘åªè¯´ä¸¤æ®µï¼Œç¬¬ä¸€æ®µä¸ºåŸŸï¼Œç¬¬äºŒæ®µä¸ºå…¬å¸åç§°ã€‚åŸŸåˆåˆ†ä¸ºorgã€comã€cnç­‰ç­‰è®¸å¤šï¼Œå…¶ä¸­orgä¸ºéè¥åˆ©ç»„ç»‡ï¼Œcomä¸ºå•†ä¸šç»„ç»‡ã€‚ä¸¾ä¸ªapacheå…¬å¸çš„tomcaté¡¹ç›®ä¾‹å­ï¼šè¿™ä¸ªé¡¹ç›®çš„GroupIdæ˜¯org.apacheï¼Œå®ƒçš„åŸŸæ˜¯orgï¼ˆå› ä¸ºtomcatæ˜¯éè¥åˆ©é¡¹ç›®ï¼‰ï¼Œå…¬å¸åç§°æ˜¯apacheï¼ŒArtifactIdæ˜¯tomcatã€‚
ã€€ã€€
ã€€ã€€æ¯”å¦‚æˆ‘åˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘ä¸€èˆ¬ä¼šå°†GroupIdè®¾ç½®ä¸ºcn.mhtï¼Œcnè¡¨ç¤ºåŸŸä¸ºä¸­å›½ï¼Œmhtæ˜¯æˆ‘ä¸ªäººå§“åç¼©å†™ï¼ŒArtifactIdè®¾ç½®ä¸ºtestProjï¼Œè¡¨ç¤ºä½ è¿™ä¸ªé¡¹ç›®çš„åç§°æ˜¯testProjï¼Œä¾ç…§è¿™ä¸ªè®¾ç½®ï¼Œåœ¨ä½ åˆ›å»ºMavenå·¥ç¨‹åï¼Œæ–°å»ºåŒ…çš„æ—¶å€™ï¼ŒåŒ…ç»“æ„æœ€å¥½æ˜¯cn.zr.testProjæ‰“å¤´çš„ï¼Œå¦‚æœæœ‰ä¸ªStudentDao[Daoå±‚çš„]ï¼Œå®ƒçš„å…¨è·¯å¾„å°±æ˜¯cn.zr.testProj.dao.StudentDao
```



### SpringBootæ‰“waråŒ…éƒ¨ç½²

1. pom.xmlé…ç½®ä¿®æ”¹

```pom.xml
<packaging>war</packaging>
```

2. æ’é™¤spring bootä¸­å†…åµŒçš„tomcatä¾èµ–åŒ…ï¼š

```pom.xml
<dependency>
   <groupId>org.springframework.boot</groupId>
   <artifactId>spring-boot-starter-tomcat</artifactId>
   <scope>provided</scope><!-- providedæ‰“åŒ…æ—¶ä¸åŠ è½½æ­¤åŒ… -->
</dependency>
```

3. ä¿®æ”¹mavenæ‰“waråŒ…æ’ä»¶

```
<build>
    <finalName>waråŒ…å</finalName>
    <plugins>
        <plugin>
            <artifactId>maven-war-plugin</artifactId>
            <version>3.0.0</version>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>3.3</version>
            <configuration>
                <source>1.8</source>
                <target>1.8</target>
            </configuration>
        </plugin>
    </plugins>
</build>
```

4. å¦‚æœæ˜¯å‘å¸ƒjaråŒ…ï¼Œç¨‹åºçš„å…¥å£æ—¶mainå‡½æ•°æ‰€åœ¨çš„ç±»ï¼Œä½¿ç”¨@SpringBootApplicationæ³¨è§£ï¼›å¦‚æœæ˜¯waråŒ…å‘å¸ƒï¼Œéœ€è¦å¢åŠ SpringBootServletInitializerå­ç±»ï¼Œå¹¶é‡å†™å…¶configureæ–¹æ³•ï¼Œæˆ–è€…å°†mainå‡½æ•°æ‰€åœ¨çš„ç±»ç»§æ‰¿SpringBootServletInitializerå­ç±»ï¼Œå¹¶é‡å†™configureæ–¹æ³•ï¼Œå½“æ—¶æ‰“åŒ…ä¸ºwaræ—¶ä¸Šä¼ åˆ°tomcatæœåŠ¡å™¨ä¸­è®¿é—®é¡¹ç›®å§‹ç»ˆæŠ¥404é”™å°±æ˜¯å¿½ç•¥äº†è¿™ä¸ªæ­¥éª¤ï¼ï¼ï¼

```java
//ç»§æ‰¿SpringBootServletInitializerå­ç±»
@SpringBootApplication
public class DemoApplication extends SpringBootServletInitializer {

    //é‡å†™configureæ–¹æ³•
    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder application) {
        return application.sources(DemoApplication.class);
    }
    public static void main(String[] args) {
        SpringApplication.run(DemoApplication.class, args);
    }
}
```



### æ—¥æœŸæ ¼å¼é—®é¢˜

1. åå°æ¥å—å‰å°æ—¥æœŸé—®é¢˜

   ä¸€ã€@DateTimeFormat(pattern = "yyyy-MM-dd")

   äºŒã€åˆ›å»ºé…ç½®ç±»æ³¨å…¥Springä¸­

   ```java
   @Configuration
   public class DateConverterConfig implements Converter<String, Date> {
   
           private static final List<String> formarts = new ArrayList<>(4);
   
           static {
               formarts.add("yyyy-MM");
               formarts.add("yyyy-MM-dd");
               formarts.add("yyyy-MM-dd hh:mm");
               formarts.add("yyyy-MM-dd hh:mm:ss");
           }
   
           @Override
           public Date convert(String source) {
               String value = source.trim();
               if ("".equals(value)) {
                   return null;
               }
               if (source.matches("^\\d{4}-\\d{1,2}$")) {
                   return parseDate(source, formarts.get(0));
               } else if (source.matches("^\\d{4}-\\d{1,2}-\\d{1,2}$")) {
                   return parseDate(source, formarts.get(1));
               } else if (source.matches("^\\d{4}-\\d{1,2}-\\d{1,2} {1}\\d{1,2}:\\d{1,2}$")) {
                   return parseDate(source, formarts.get(2));
               } else if (source.matches("^\\d{4}-\\d{1,2}-\\d{1,2} {1}\\d{1,2}:\\d{1,2}:\\d{1,2}$")) {
                   return parseDate(source, formarts.get(3));
               } else {
                   throw new IllegalArgumentException("Invalid boolean value '" + source + "'");
               }
           }
   
           /**
            * æ ¼å¼åŒ–æ—¥æœŸ
            *
            * @param dateStr String å­—ç¬¦å‹æ—¥æœŸ
            * @param format  String æ ¼å¼
            * @return Date æ—¥æœŸ
            */
           public Date parseDate(String dateStr, String format) {
               Date date = null;
               try {
                   DateFormat dateFormat = new SimpleDateFormat(format);
                   date = dateFormat.parse(dateStr);
               } catch (Exception e) {
   
               }
               return date;
           }
   
       }
   
   ```

2. JSONæ ¼å¼å­—ç¬¦ä¸²æ—¥æœŸé—®é¢˜

   ä¸€ã€@JSONField(format = "yyyy-MM-dd HH:mm:ss")

   äºŒã€@JsonFormat(pattern="yyyy-MM-dd",timezone="GMT+8")

   ä¸‰ã€JSONArray.toJSONStringWithDateFormat(this,"yyyy-MM-dd HH:mm:ss");



### MyBatis dateç±»å‹å¼•å‘é—®é¢˜

dateç±»å‹åœ¨åˆ¤æ–­éç©ºæ—¶ï¼Œè¿™ç§å†™æ³•ä¼šå¼•å‘å¼‚å¸¸ï¼šinvalid comparison: java.util.Date and java.lang.String

```xml
<if test="createDate != null and createDate !='' " >  
  date(createDate) = #{createDate}  
</if>
```

æ­£ç¡®å†™æ³•åº”ä¸ºï¼š

```xml
<if test="createDate != null" >  
  date(createDate) = date#{createDate}
</if> 
```



### Ajaxä¼ è¾“JSONæ•°æ®

```js
$.ajax({
    url:"/user/export",
    data:JSON.stringify(data),
    type:"post",
    contentType:"application/json",//é‡ç‚¹
    success:function(fileName){
        console.log(fileName);
        window.open("../user/downLoad?fileName=" + fileName);
    },error:function(){
    	console.log("å¤±è´¥ï¼");
    }
})
```

```java
@ResponseBody
@RequestMapping(value = "/export")
public void export(@RequestBody JSONObject data){
   	 //å°†å­—ç¬¦ä¸²è§£ææˆJSONObjectå¯¹è±¡
}
```



### Jackson FastJson

å‚è€ƒï¼š[æ€§èƒ½å·®å¼‚](https://blog.csdn.net/u013433821/article/details/82905222)

```
Jacksonç›¸æ¯”json-libæ¡†æ¶ï¼ŒJacksonæ‰€ä¾èµ–çš„jaråŒ…è¾ƒå°‘ï¼Œç®€å•æ˜“ç”¨å¹¶ä¸”æ€§èƒ½ä¹Ÿè¦ç›¸å¯¹é«˜äº›ã€‚è€Œä¸”Jacksonç¤¾åŒºç›¸å¯¹æ¯”è¾ƒæ´»è·ƒï¼Œæ›´æ–°é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ã€‚SpringBooté»˜è®¤çš„jsonè§£æ

Fastjsonæ˜¯ä¸€ä¸ªJavaè¯­è¨€ç¼–å†™çš„é«˜æ€§èƒ½çš„JSONå¤„ç†å™¨,ç”±é˜¿é‡Œå·´å·´å…¬å¸å¼€å‘ã€‚æ— ä¾èµ–ï¼Œä¸éœ€è¦ä¾‹å¤–é¢å¤–çš„jarï¼Œèƒ½å¤Ÿç›´æ¥è·‘åœ¨JDKä¸Šã€‚FastJsoné‡‡ç”¨ç‹¬åˆ›çš„ç®—æ³•ï¼Œå°†parseçš„é€Ÿåº¦æå‡åˆ°æè‡´ï¼Œè¶…è¿‡æ‰€æœ‰jsonåº“ã€‚
FastJsonåœ¨å¤æ‚ç±»å‹çš„Beanè½¬æ¢Jsonä¸Šä¼šå‡ºç°ä¸€äº›é—®é¢˜ï¼Œå¯èƒ½ä¼šå‡ºç°å¼•ç”¨çš„ç±»å‹ï¼Œå¯¼è‡´Jsonè½¬æ¢å‡ºé”™ï¼Œéœ€è¦åˆ¶å®šå¼•ç”¨ã€‚æœ‰çš„ç‰ˆæœ¬å­˜åœ¨é«˜å±æ¼æ´ï¼Œä¸å»ºè®®ç”Ÿäº§ä½¿ç”¨
```



### POIæŠ¥è¡¨å¼•å…¥pomå‡ºç°jaråŒ…å†²çª

```xml
<!--POIæŠ¥è¡¨-->
<dependency>
    <groupId>org.apache.poi</groupId>
    <artifactId>poi</artifactId>
    <version>3.6</version>
    <exclusions>
        <exclusion>
            <artifactId>jsp-api</artifactId>
            <groupId>javax.servlet.jsp</groupId>
        </exclusion>
        <exclusion>
            <artifactId>servlet-api</artifactId>
            <groupId>javax.servlet</groupId>
        </exclusion>
    </exclusions>
</dependency>
```

### Excelå¯¼å‡ºå¯¼å‡º - é˜¿é‡Œå·´å·´

å‚è€ƒï¼š[Excelå¯¼å…¥å¯¼å‡º](http://www.pianshen.com/article/4672412475/)



### å‰åç«¯åˆ†ç¦» - JWTç”¨æˆ·è®¤è¯

å‚è€ƒï¼š[JWTç”¨æˆ·è®¤è¯](https://www.cnblogs.com/wenqiangit/p/9592132.html)



**ä¼ ç»Ÿæ–¹å¼**

```
å‰åç«¯åˆ†ç¦»é€šè¿‡Restful APIè¿›è¡Œæ•°æ®äº¤äº’æ—¶ï¼Œå¦‚ä½•éªŒè¯ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯åŠæƒé™ã€‚åœ¨åŸæ¥çš„é¡¹ç›®ä¸­ï¼Œä½¿ç”¨çš„æ˜¯æœ€ä¼ ç»Ÿä¹Ÿæ˜¯æœ€ç®€å•çš„æ–¹å¼ï¼Œå‰ç«¯ç™»å½•ï¼Œåç«¯æ ¹æ®ç”¨æˆ·ä¿¡æ¯ç”Ÿæˆä¸€ä¸ªtokenï¼Œå¹¶ä¿å­˜è¿™ä¸ª token å’Œå¯¹åº”çš„ç”¨æˆ·idåˆ°æ•°æ®åº“æˆ–Sessionä¸­ï¼Œæ¥ç€æŠŠ token ä¼ ç»™ç”¨æˆ·ï¼Œå­˜å…¥æµè§ˆå™¨ cookieï¼Œä¹‹åæµè§ˆå™¨è¯·æ±‚å¸¦ä¸Šè¿™ä¸ªcookieï¼Œåç«¯æ ¹æ®è¿™ä¸ªcookieå€¼æ¥æŸ¥è¯¢ç”¨æˆ·ï¼ŒéªŒè¯æ˜¯å¦è¿‡æœŸã€‚

ä½†è¿™æ ·åšé—®é¢˜å°±å¾ˆå¤šï¼Œå¦‚æœæˆ‘ä»¬çš„é¡µé¢å‡ºç°äº† XSS æ¼æ´ï¼Œç”±äº cookie å¯ä»¥è¢« JavaScript è¯»å–ï¼ŒXSS æ¼æ´ä¼šå¯¼è‡´ç”¨æˆ· token æ³„éœ²ï¼Œè€Œä½œä¸ºåç«¯è¯†åˆ«ç”¨æˆ·çš„æ ‡è¯†ï¼Œcookie çš„æ³„éœ²æ„å‘³ç€ç”¨æˆ·ä¿¡æ¯ä¸å†å®‰å…¨ã€‚å°½ç®¡æˆ‘ä»¬é€šè¿‡è½¬ä¹‰è¾“å‡ºå†…å®¹ï¼Œä½¿ç”¨ CDN ç­‰å¯ä»¥å°½é‡é¿å… XSS æ³¨å…¥ï¼Œä½†è°ä¹Ÿä¸èƒ½ä¿è¯åœ¨å¤§å‹çš„é¡¹ç›®ä¸­ä¸ä¼šå‡ºç°è¿™ä¸ªé—®é¢˜ã€‚
```





### Restfulé£æ ¼

```
// éœ€æ±‚:
//   1. æŸ¥è¯¢
//        * URI: emps
//        * è¯·æ±‚æ–¹å¼: GET
//   2. æ·»åŠ æ‰€æœ‰å‘˜å·¥ä¿¡æ¯
//        2.1 æ˜¾ç¤ºæ·»åŠ é¡µé¢:
//                * URI: emp
//                * è¯·æ±‚æ–¹å¼: GET
//        2.2 æ·»åŠ å‘˜å·¥
//                * URI: emp
//                * è¯·æ±‚æ–¹å¼: POST
//                * æ·»åŠ å®Œæˆå,é‡å®šå‘åˆ° list é¡µé¢
//   3. åˆ é™¤
//        * URI: emp/{id}
//        * è¯·æ±‚æ–¹å¼: DELETE
//   4. ä¿®æ”¹æ“ä½œ (å…¶ä¸­ lastName ä¸å¯ä¿®æ”¹!!)
//       4.1 æ˜¾ç¤ºä¿®æ”¹é¡µé¢
//              * URI: emp/{id}
//              * è¯·æ±‚æ–¹å¼: GET
//       4.2 ä¿®æ”¹å‘˜å·¥ä¿¡æ¯
//              * URI: emp
//              * è¯·æ±‚æ–¹å¼: PUT
//              * å®Œæˆä¿®æ”¹,é‡å®šå‘åˆ° list é¡µé¢
```



### æ ‘å½¢ç»“æ„

```sql
-- Oracle

-- è¯­æ³•
select * from table 
start Â·Â·Â· with Â·Â·Â·
Connent By Â·Â·Â·

-- ç¤ºä¾‹
Select * From DEMO
Start With ID = '00001'
Connect By Prior ID = PID
```



```java
//é€’å½’æŸ¥æ‰¾æ‰€æœ‰èœå•çš„å­èœå•
private List<CategoryEntity> getChildrens(CategoryEntity root,List<CategoryEntity> all){
    
    List<CategoryEntity> children = all.stream().filter(categoryEntity -> {
    	return categoryEntity.getParentCid() == root.getCatId();
    }).map(categoryEntity ->
        categoryEntity.setChildren(getChildrens(categoryEntity,all));
        return categoryEntity;
    }).sorted((menu1,menu2)->{
    	return menu1.getSort() - menu2.getSort();
    }).collect(Collectors.tolist());
    
    return children;
}
```



```java
 	/**
     * è·å–è¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹
     * @param nodeId
     * @param data
     * @return
     */
    public List<JSONObject> getChildren(String nodeId,List<JSONObject> data){
        List<JSONObject> child = new ArrayList<JSONObject>();
        for(JSONObject object : data){
            if(nodeId.equals(object.getString("depParent"))){
                child.add(object);
            }
        }
        return child;
    }

    /**
     * éƒ¨é—¨æ ‘
     * é€’å½’å¤„ç†   æ•°æ®åº“æ ‘ç»“æ„æ•°æ®->æ ‘å½¢json
     * @param nodeId
     * @param nodes
     * @return
     */
    public JSONArray getNodeJson(String nodeId, List<JSONObject> nodes){

        //å½“å‰å±‚çº§å½“å‰ç‚¹ä¸‹çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼ˆå®æˆ˜ä¸­ä¸è¦æ…¢æ…¢å»æŸ¥,ä¸€æ¬¡åŠ è½½åˆ°é›†åˆç„¶åæ…¢æ…¢å¤„ç†ï¼‰
        List<JSONObject> childList = getChildren(nodeId,nodes);
        JSONArray childTree = new JSONArray();
        for (JSONObject node : childList) {
            JSONObject o = new JSONObject();
            o.put("key",node.getString("id"));
            o.put("title",node.getString("depName"));
            JSONArray child = getNodeJson(node.getString("id"),nodes);  //é€’å½’è°ƒç”¨è¯¥æ–¹æ³•
            if(!child.isEmpty()) {
                o.put("children",child);
            }
            childTree.fluentAdd(o);
        }
        return childTree;
    }

    /**
     * éƒ¨é—¨æ ‘
     * @param
     * @return
     */
    public JSONArray findDeptRoleTree(){
        List<JSONObject> data = this.iDeptDao.findDeptRoleTree();
        JSONArray treeData =  getNodeJson("0",data);
        return treeData;
    }

	/*
		select depSerial, depNo, depName, depParent from dt_dep
    */
```



### Git

å‚è€ƒï¼š[å¦‚ä½•ç†è§£é›†ä¸­å¼ä¸åˆ†å¸ƒå¼](https://blog.csdn.net/weixin_42476601/article/details/82290902)   [Git vs SVN ä¸Gitå‘½ä»¤](https://www.cnblogs.com/qcloud1001/archive/2018/10/31/9884576.html)

.gitç›®å½•ä¸­çš„configæ–‡ä»¶

```
[core]
	repositoryformatversion = 0
	filemode = false
	bare = false
	logallrefupdates = true
	symlinks = false
	ignorecase = true
[remote "origin"]
	url = http://guoyongchao@192.168.2.211:1010/r/dormitory-management-web.git
	fetch = +refs/heads/*:refs/remotes/origin/*
[branch "master"]
	remote = origin
	merge = refs/heads/master

```



### æ—¶é—´è½¬æ¢å¤šå°‘åˆ†é’Ÿå‰ã€å‡ å¤©å‰

```js
var minute = 1000 * 60;
var hour = minute * 60;
var day = hour * 24;
var month = day * 30;

//è·å–ä¸ªæ€§åŒ–æ—¶é—´å·® 
export function getDateDiff(dateStr){
  let dateTimeStamp = dateStr;// Date.parse(dateStr.replace(/-/gi,"/")); //å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ—¶é—´æˆ³
  var now = new Date().getTime();
  var diffValue = now - dateTimeStamp;
  if(diffValue < 0){
      //è‹¥æ—¥æœŸä¸ç¬¦åˆ™å¼¹å‡ºçª—å£å‘Šä¹‹
      console.log("ç»“æŸæ—¥æœŸä¸èƒ½å°äºå¼€å§‹æ—¥æœŸï¼");
  }
  var yearC = diffValue/(12*month);
  var monthC = diffValue/month;
  var weekC = diffValue/(7*day);
  var dayC = diffValue/day;
  var hourC = diffValue/hour;
  var minC = diffValue/minute;
  let result = null;
  if(yearC >= 1){
      result = parseInt(yearC) + "å¹´å‰";
  }
  else if(monthC >= 1){
      result = parseInt(monthC) + "ä¸ªæœˆå‰";
  }
  else if(weekC>=1){
      result = parseInt(weekC) + "å‘¨å‰";
  }
  else if(dayC>=1){
      result = parseInt(dayC) +"å¤©å‰";
  }
  else if(hourC>=1){
      result = parseInt(hourC) +"ä¸ªå°æ—¶å‰";
  }
  else if(minC>=1){
      result = parseInt(minC) +"åˆ†é’Ÿå‰";
  }else{
      result="åˆšåˆš";
  }
  return result;
}
```



### è·¨åŸŸé—®é¢˜

> **è·¨åŸŸä¸æ˜¯è¯·æ±‚å‘ä¸å‡ºå»ï¼Œè€Œæ˜¯æœåŠ¡ç«¯æ­£å¸¸è¿”å›ç»“æœåè¢«æµè§ˆå™¨æ‹¦æˆªè¿”å›ç»“æœ**
> **(æµè§ˆå™¨ä¸ºäº†é˜²æ­¢éåŒæºçš„è¯·æ±‚ æ‹¿åˆ°æœåŠ¡å™¨çš„è¿”å›æ•°æ®ç»“æœ)**

```js
1.JSONP	-- åŸç†å°±æ˜¯åˆ©ç”¨äº†scriptæ ‡ç­¾ï¼Œæ·»åŠ äº†ä¸€ä¸ªscriptæ ‡ç­¾ï¼Œåˆ©ç”¨æ ‡ç­¾ç‰¹æ€§è¾¾åˆ°è·¨åŸŸåŠ è½½èµ„æºçš„æ•ˆæœã€‚
    JSONPç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå›è°ƒå‡½æ•°å’Œæ•°æ®
    ä¼˜ç‚¹ï¼š
    ï¼ˆ1ï¼‰å…¼å®¹æ€§å¥½ï¼Œåœ¨å¤šå¤è€çš„æµè§ˆå™¨éƒ½èƒ½è¿è¡Œã€‚
    ï¼ˆ2ï¼‰èƒ½ç›´æ¥è®¿é—®å“åº”æ–‡æœ¬ï¼Œæ”¯æŒåœ¨æµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´åŒå‘é€šä¿¡ã€‚
    ç¼ºç‚¹ï¼š
    ï¼ˆ1ï¼‰åªæ”¯æŒGETè¯·æ±‚ï¼Œä¸æ”¯æŒPOSTè¯·æ±‚ï¼›
    ï¼ˆ2ï¼‰ä¸å¤Ÿå®‰å…¨ã€‚å› ä¸ºJSONPæ˜¯ä»å…¶ä»–åŸŸä¸­åŠ è½½ä»£ç æ‰§è¡Œï¼Œå¦‚æœå…¶ä»–åŸŸä¸å®‰å…¨ï¼Œå¯èƒ½ä¼šåœ¨å“åº”ä¸­å¸¦æœ‰æ¶æ„ä»£ç ã€‚
    ï¼ˆ3ï¼‰ä¸å®¹æ˜“ç¡®è®¤è¯·æ±‚æ˜¯å¦å¤±è´¥ã€‚
    
    //jsonpè¯·æ±‚ï¼Œé»˜è®¤æºå¸¦callbackå‚æ•°ï¼Œæ–¹æ³•å›è°ƒsuccessä¸Šé¢
    //http://localhost:9090/student?callback=jQuery172022456231109176& =1483893661922
     $.ajax({
         url: "http://localhost:9090/student",
         type: "GET",
         dataType: "jsonp", //æŒ‡å®šæœåŠ¡å™¨è¿”å›çš„æ•°æ®ç±»å‹
         success: function (data) {
             var result = JSON.stringify(data); //jsonå¯¹è±¡è½¬æˆå­—ç¬¦ä¸²
         }
     });
    
2ã€CORS -- è·¨ç«™èµ„æºå…±äº«ï¼Œå®ƒæ˜¯è·¨åŸŸçš„å®˜æ–¹è§£å†³æ–¹æ¡ˆï¼Œå‡çº§ç‰ˆçš„JSONPã€‚
	åŸç†æ˜¯ä½¿ç”¨è‡ªå®šä¹‰çš„HTTPå¤´éƒ¨è®©æµè§ˆå™¨ä¸æœåŠ¡å™¨è¿›è¡Œæ²Ÿé€šï¼Œä»è€Œå†³å®šè¯·æ±‚æˆ–å“åº”æ˜¯åº”è¯¥æˆåŠŸè¿˜æ˜¯å¤±è´¥ã€‚è¯·æ±‚å’Œå“åº”éƒ½	ä¸åŒ…å«cookieä¿¡æ¯ã€‚
	CORSéœ€è¦æµè§ˆå™¨å’Œåé™¢åŒæ—¶æ”¯æŒï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è¿›è¡ŒCORSé€šä¿¡ï¼Œå®ç°CORSé€šä¿¡çš„å…³é”®æ˜¯åç«¯ï¼Œåªè¦åç«¯å®ç°äº†		CORSï¼Œå°±å®ç°äº†è·¨åŸŸï¼ŒæœåŠ¡ç«¯è®¾ç½®Access-Control-Allow-Origin å°±å¯ä»¥å¼€å¯CORSï¼Œè¯¥å±æ€§è¡¨ç¤ºå“ªäº›åŸŸåå¯	ä»¥è®¿é—®èµ„æºï¼Œå¦‚æœè®¾ç½®é€šé…ç¬¦åˆ™è¡¨ç¤ºæ‰€æœ‰ç½‘ç«™éƒ½å¯ä»¥è®¿é—®èµ„æºã€‚
```



### RabbitMQ

å‚è€ƒï¼š[RabbitMQ](https://blog.csdn.net/hellozpc/article/details/81436980#8SpringbootRabbitMQ_1273) [Rabbité¢è¯•](https://blog.csdn.net/weixin_43496689/article/details/103159268)  [Rabbitè¯¦è§£](https://www.cnblogs.com/williamjie/p/9481774.html)  [springboot + rabbitmqå‘é€é‚®ä»¶æ¡ˆä¾‹](https://www.jianshu.com/p/dca01aad6bc8)  [RabbitMQä¸“ä¸š](http://www.iocoder.cn/Spring-Boot/RabbitMQ/)



![](image/Rabbitå†…éƒ¨ç»“æ„å›¾.jpg)



> RabbitMQæœ‰å››ç§Exchangeç±»å‹ï¼Œåˆ†åˆ«æ˜¯Direct ã€Topicã€Fanout ã€Headers

```
Direct Exchange è·¯ç”±æ¨¡å¼ï¼šé»˜è®¤ç±»å‹ï¼Œæ ¹æ®è·¯ç”±é”®ï¼ˆRouting Keyï¼‰å°†æ¶ˆæ¯æŠ•é€’ç»™å¯¹åº”é˜Ÿåˆ—ã€‚
Topic Exchange é€šé…ç¬¦æ¨¡å¼ï¼šé€šè¿‡å¯¹æ¶ˆæ¯çš„è·¯ç”±é”®ï¼ˆRouting Keyï¼‰å’Œç»‘å®šåˆ°äº¤æ¢æœºçš„é˜Ÿåˆ—ï¼Œå°†æ¶ˆæ¯è·¯ç”±ç»™é˜Ÿåˆ—ã€‚ç¬¦å·â€œ#â€åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªè¯ï¼Œç¬¦å·â€œ*â€åŒ¹é…ä¸å¤šä¸å°‘ä¸€ä¸ªè¯
Fanout Exchange å‘å¸ƒ/è®¢é˜…ï¼šå°†æ¶ˆæ¯è·¯ç”±ç»™ç»‘å®šåˆ°å®ƒèº«ä¸Šçš„æ‰€æœ‰é˜Ÿåˆ—ï¼Œè€Œä¸ç†ä¼šç»‘å®šçš„è·¯ç”±é”®ï¼ˆRouting Keyï¼‰ã€‚
Headers Exchange ç›´è¿äº¤æ¢æœºï¼šå‘é€æ¶ˆæ¯æ—¶åŒ¹é… Header è€Œé Routing Keyï¼Œæ€§èƒ½å¾ˆå·®ï¼Œå‡ ä¹ä¸ç”¨ã€‚
```



>prefetchä¸æ¶ˆæ¯æŠ•é€’

```
prefetchä¸æ¶ˆæ¯æŠ•é€’
prefetchå…è®¸ä¸ºæ¯ä¸ªconsumeræŒ‡å®šæœ€å¤§çš„unacked messagesæ•°ç›®ã€‚ç®€å•æ¥è¯´å°±æ˜¯ç”¨æ¥æŒ‡å®šä¸€ä¸ªconsumerä¸€æ¬¡å¯ä»¥ä»Rabbitä¸­è·å–å¤šå°‘æ¡messageå¹¶ç¼“å­˜åœ¨clientä¸­(RabbitMQæä¾›çš„å„ç§è¯­è¨€çš„client library)ã€‚ä¸€æ—¦ç¼“å†²åŒºæ»¡äº†ï¼ŒRabbitå°†ä¼šåœæ­¢æŠ•é€’æ–°çš„messageåˆ°è¯¥consumerä¸­ç›´åˆ°å®ƒå‘å‡ºackã€‚

å‡è®¾prefetchå€¼è®¾ä¸º10ï¼Œå…±æœ‰ä¸¤ä¸ªconsumerã€‚æ„å‘³ç€æ¯ä¸ªconsumeræ¯æ¬¡ä¼šä»queueä¸­é¢„æŠ“å– 10 æ¡æ¶ˆæ¯åˆ°æœ¬åœ°ç¼“å­˜ç€ç­‰å¾…æ¶ˆè´¹ã€‚åŒæ—¶è¯¥channelçš„unackedæ•°å˜ä¸º20ã€‚è€ŒRabbitæŠ•é€’çš„é¡ºåºæ˜¯ï¼Œå…ˆä¸ºconsumer1æŠ•é€’æ»¡10ä¸ªmessageï¼Œå†å¾€consumer2æŠ•é€’10ä¸ªmessageã€‚å¦‚æœè¿™æ—¶æœ‰æ–°messageéœ€è¦æŠ•é€’ï¼Œå…ˆåˆ¤æ–­channelçš„unackedæ•°æ˜¯å¦ç­‰äº20ï¼Œå¦‚æœæ˜¯åˆ™ä¸ä¼šå°†æ¶ˆæ¯æŠ•é€’åˆ°consumerä¸­ï¼Œmessageç»§ç»­å‘†åœ¨queueä¸­ã€‚ä¹‹åå…¶ä¸­consumerå¯¹ä¸€æ¡æ¶ˆæ¯è¿›è¡Œackï¼Œunackedæ­¤æ—¶ç­‰äº19ï¼ŒRabbitå°±åˆ¤æ–­å“ªä¸ªconsumerçš„unackedå°‘äº10ï¼Œå°±æŠ•é€’åˆ°å“ªä¸ªconsumerä¸­ã€‚

æ€»çš„æ¥è¯´ï¼Œconsumerè´Ÿè´£ä¸æ–­å¤„ç†æ¶ˆæ¯ï¼Œä¸æ–­ackï¼Œç„¶ååªè¦unackedæ•°å°‘äºprefetch * consumeræ•°ç›®ï¼Œbrokerå°±ä¸æ–­å°†æ¶ˆæ¯æŠ•é€’è¿‡å»ã€‚

channel = connection.createChannel();
channel.basicQos(prefetch);
```



### Rediså¸¸è§é¢è¯•é¢˜

å‚è€ƒï¼š[å‡ ç‡å¤§çš„Redisé¢è¯•é¢˜](https://blog.csdn.net/Butterfly_resting/article/details/89668661)  [Rediså¸¸è§é¢è¯•é¢˜](https://www.cnblogs.com/jasontec/p/9699242.html) [å“¨å…µæ¨¡å¼](https://www.jianshu.com/p/06ab9daf921d)



### Redis

> redis.conf

```
Linuxä¸­
daemonize no â†’ daemonize yes

redis.confé…ç½®æ–‡ä»¶ä¸­daemonizeå®ˆæŠ¤çº¿ç¨‹ï¼Œé»˜è®¤æ˜¯NO

daemonize:yes:redisé‡‡ç”¨çš„æ˜¯å•è¿›ç¨‹å¤šçº¿ç¨‹çš„æ¨¡å¼ã€‚å½“redis.confä¸­é€‰é¡¹daemonizeè®¾ç½®æˆyesæ—¶ï¼Œä»£è¡¨å¼€å¯å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ã€‚åœ¨è¯¥æ¨¡å¼ä¸‹ï¼Œredisä¼šåœ¨åå°è¿è¡Œï¼Œå¹¶å°†è¿›ç¨‹pidå·å†™å…¥è‡³redis.confé€‰é¡¹pidfileè®¾ç½®çš„æ–‡ä»¶ä¸­ï¼Œæ­¤æ—¶rediså°†ä¸€ç›´è¿è¡Œï¼Œé™¤éæ‰‹åŠ¨killè¯¥è¿›ç¨‹ã€‚

daemonize:no: å½“daemonizeé€‰é¡¹è®¾ç½®æˆnoæ—¶ï¼Œå½“å‰ç•Œé¢å°†è¿›å…¥redisçš„å‘½ä»¤è¡Œç•Œé¢ï¼Œexitå¼ºåˆ¶é€€å‡ºæˆ–è€…å…³é—­è¿æ¥å·¥å…·(putty,xshellç­‰)éƒ½ä¼šå¯¼è‡´redisè¿›ç¨‹é€€å‡ºã€‚
```



> rediså¯†ç 

```
redis-server
redis-cli -p 6379

ping #å‡ºç° PONG

config get requirepass

config set requirepass "123456"

ping #å‡ºç° NOAUTH Authentication required

auth 123456

ping #å‡ºç° PONG
```



> RDB(Redis DataBase )

```
Redisä¼šå•ç‹¬åˆ›å»º(fork) ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¼šå…ˆå°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¾…æŒä¹…åŒ–è¿‡ç¨‹éƒ½ç»“æŸäº†ï¼Œå†ç”¨è¿™ä¸ªä¸´æ—¶æ–‡ä»¶æ›¿æ¢ä¸Šæ¬¡æŒä¹…åŒ–å¥½çš„æ–‡ä»¶ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹æ˜¯ä¸è¿›è¡Œä»»ä½•IOæ“ä½œçš„ï¼Œè¿™å°±ç¡®ä¿äº†æé«˜çš„æ€§èƒ½
å¦‚æœéœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£RDBæ–¹å¼è¦æ¯”AOFæ–¹å¼æ›´åŠ çš„é«˜æ•ˆã€‚RDBçš„ç¼ºç‚¹æ˜¯æœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¸¢å¤±ã€‚

flushallå’Œshutdown éƒ½ä¼šè§¦å‘rdbå¤‡ä»½ï¼Œå¦‚æœæ‰§è¡Œè¯¥å‘½ä»¤å‰ä½¿ç”¨äº†flushallé‚£ä¹ˆæ•°æ®å¤‡ä»½çš„å°†æ˜¯ç©ºæ•°æ®åº“

dump.rdb

# é»˜è®¤å¤‡ä»½é…ç½®
save 60  10000 	# 1åˆ†é’Ÿå†…æ”¹äº†1ä¸‡æ¬¡
save 300 10		# 5åˆ†é’Ÿå†…æ”¹äº†10æ¬¡
save 900 1		# 15åˆ†é’Ÿå†…æ”¹äº†1æ¬¡
save ""			# ç¦ç”¨

saveå‘½ä»¤å¯ä»¥ç«‹å³å¤‡ä»½

ä¼˜åŠ¿ï¼šé€‚åˆå¤§è§„æ¨¡æ•°æ®æ¢å¤ã€å¯¹æ•°æ®çš„å®Œæ•´æ€§å’Œä¸€è‡´æ€§è¦æ±‚ä¸é«˜
åŠ£åŠ¿ï¼šåœ¨ä¸€å®šæ—¶é—´åšä¸€æ¬¡å¤‡ä»½ï¼Œæ‰€ä»¥å¦‚æœredisæ„å¤–downæ‰çš„è¯ï¼Œå°±ä¼šä¸¢å¤±æœ€åä¸€æ¬¡å¿«ç…§çš„æ‰€æœ‰ä¿®æ”¹ã€Forkçš„æ—¶å€™ï¼Œå¤åˆ¶è¿›ç¨‹ï¼Œå†…å­˜ç›¸å½“äºæ‰©å¤§äº†ä¸€å€ï¼Œéœ€è¦è€ƒè™‘æœåŠ¡å™¨çš„å‹åŠ›
```



> AOF(Append Only File)

```
ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°†Redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰å†™æŒ‡ä»¤è®°å½•ä¸‹æ¥(è¯»æ“ä½œä¸è®°å½•)ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼Œrediså¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®
æ¢è¨€ä¹‹ï¼Œredisé‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œ

appendonly.aof

#æ‰“å¼€apfå¤‡ä»½
appendonly yes

#æ ¼å¼åŒ–AOFæ–‡ä»¶(å»é™¤æ‚ä¹±ä»£ç )
redis-check-aof --fix appendonly.aof
#æ ¼å¼åŒ–RDBæ–‡ä»¶
redis-check-dump --fix dump.rdb

Appendsyncï¼š
	Alwaysï¼šåŒæ­¥æŒä¹…åŒ– æ¯æ¬¡å‘ç”Ÿæ•°æ®å˜æ›´ä¼šè¢«ç«‹å³è®°å½•åˆ°ç£ç›˜  æ€§èƒ½è¾ƒå·®ä½†æ•°æ®å®Œæ•´æ€§æ¯”è¾ƒå¥½
	Everysecï¼šå‡ºåœºé»˜è®¤æ¨èï¼Œå¼‚æ­¥æ“ä½œï¼Œæ¯ç§’è®°å½•ï¼Œå¦‚æœä¸€ç§’å†…å®•æœºï¼Œæœ‰æ•°æ®ä¸¢å¤±
	Noï¼šä»ä¸åŒæ­¥

é‡å†™
AOFé‡‡ç”¨æ–‡ä»¶è¿½åŠ æ–¹å¼ï¼Œæ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ä¸ºé¿å…å‡ºç°æ­¤ç§æƒ…å†µï¼Œæ–°å¢äº†é‡å†™æœºåˆ¶,å½“AOFæ–‡ä»¶çš„å¤§å°è¶…è¿‡æ‰€è®¾å®šçš„é˜ˆå€¼æ—¶ï¼ŒRediså°±ä¼šå¯åŠ¨AOFæ–‡ä»¶çš„å†…å®¹å‹ç¼©ï¼Œåªä¿ç•™å¯ä»¥æ¢å¤æ•°æ®çš„æœ€å°æŒ‡ä»¤é›†.å¯ä»¥ä½¿ç”¨å‘½ä»¤bgrewriteaof

é‡å†™åŸç†
AOFæ–‡ä»¶æŒç»­å¢é•¿è€Œè¿‡å¤§æ—¶ï¼Œä¼šforkå‡ºä¸€æ¡æ–°è¿›ç¨‹æ¥å°†æ–‡ä»¶é‡å†™(ä¹Ÿæ˜¯å…ˆå†™ä¸´æ—¶æ–‡ä»¶æœ€åå†rename)ï¼Œ
éå†æ–°è¿›ç¨‹çš„å†…å­˜ä¸­æ•°æ®ï¼Œæ¯æ¡è®°å½•æœ‰ä¸€æ¡çš„Setè¯­å¥ã€‚é‡å†™aofæ–‡ä»¶çš„æ“ä½œï¼Œå¹¶æ²¡æœ‰è¯»å–æ—§çš„aofæ–‡ä»¶ï¼Œ
è€Œæ˜¯å°†æ•´ä¸ªå†…å­˜ä¸­çš„æ•°æ®åº“å†…å®¹ç”¨å‘½ä»¤çš„æ–¹å¼é‡å†™äº†ä¸€ä¸ªæ–°çš„aofæ–‡ä»¶ï¼Œè¿™ç‚¹å’Œå¿«ç…§æœ‰ç‚¹ç±»ä¼¼

è§¦å‘æœºåˆ¶
Redisä¼šè®°å½•ä¸Šæ¬¡é‡å†™æ—¶çš„AOFå¤§å°ï¼Œé»˜è®¤é…ç½®æ˜¯å½“AOFæ–‡ä»¶å¤§å°æ˜¯ä¸Šæ¬¡rewriteåå¤§å°çš„ä¸€å€ä¸”æ–‡ä»¶å¤§äº64Mæ—¶è§¦å‘
```



> ä¸»ä»å¤åˆ¶

```
è¡Œè¯ï¼šä¹Ÿå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„ä¸»ä»å¤åˆ¶ï¼Œä¸»æœºæ•°æ®æ›´æ–°åæ ¹æ®é…ç½®å’Œç­–ç•¥ï¼Œ
è‡ªåŠ¨åŒæ­¥åˆ°å¤‡æœºçš„master/slaveræœºåˆ¶ï¼ŒMasterä»¥å†™ä¸ºä¸»ï¼ŒSlaveä»¥è¯»ä¸ºä¸»ï¼Œå®ç°è¯»å†™åˆ†ç¦»ã€å®¹ç¾æ¢å¤

info replication #æŸ¥çœ‹redisä¿¡æ¯çŠ¶æ€

æ€ä¹ˆç”¨
	é…ä»ä¸é…ä¸»
	ä»åº“é…ç½®ï¼šSLAVEOF ä¸»åº“IP ä¸»åº“ç«¯å£
	ä¿®æ”¹é…ç½®æ–‡ä»¶ç»†èŠ‚æ“ä½œ
	å¸¸ç”¨ä¸‰æ‹›ï¼š
        ä¸€ä¸»äºŒä»†ï¼ˆä¸»æœºæŒ‚æ‰ï¼Œä»æœºè¿˜æ˜¯ä»æœºï¼›ä»æœºæŒ‚æ‰ï¼Œç›´æ¥å˜æˆæ–°ä¸»æœºã€‚ä¸­å¿ƒåŒ–ä¸¥é‡ï¼‰
        è–ªç«ç›¸ä¼ 
        åå®¢ä¸ºä¸»(SLAVEOF no oneä½¿å½“å‰æ•°æ®åº“åœæ­¢ä¸å…¶ä»–æ•°æ®åº“çš„åŒæ­¥ï¼Œè½¬æˆä¸»æ•°æ®åº“)

å¤åˆ¶åŸç†
	slaveå¯åŠ¨æˆåŠŸè¿æ¥åˆ°masteråä¼šå‘é€ä¸€ä¸ªsyncå‘½ä»¤
    Masteræ¥åˆ°å‘½ä»¤å¯åŠ¨åå°çš„å­˜ç›˜è¿›ç¨‹ï¼ŒåŒæ—¶æ”¶é›†æ‰€æœ‰æ¥æ”¶åˆ°çš„ç”¨äºä¿®æ”¹æ•°æ®é›†å‘½ä»¤ï¼Œ
    åœ¨åå°è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œmasterå°†ä¼ é€æ•´ä¸ªæ•°æ®æ–‡ä»¶åˆ°slave,ä»¥å®Œæˆä¸€æ¬¡å®Œå…¨åŒæ­¥
    å…¨é‡å¤åˆ¶ï¼šè€ŒslaveæœåŠ¡åœ¨æ¥æ”¶åˆ°æ•°æ®åº“æ–‡ä»¶æ•°æ®åï¼Œå°†å…¶å­˜ç›˜å¹¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚
    å¢é‡å¤åˆ¶ï¼šMasterç»§ç»­å°†æ–°çš„æ‰€æœ‰æ”¶é›†åˆ°çš„ä¿®æ”¹å‘½ä»¤ä¾æ¬¡ä¼ ç»™slave,å®ŒæˆåŒæ­¥
    ä½†æ˜¯åªè¦æ˜¯é‡æ–°è¿æ¥master,ä¸€æ¬¡å®Œå…¨åŒæ­¥ï¼ˆå…¨é‡å¤åˆ¶)å°†è¢«è‡ªåŠ¨æ‰§è¡Œ
```



> å“¨å…µæ¨¡å¼(sentinel)

```
æ˜¯ä»€ä¹ˆ
	åå®¢ä¸ºä¸»çš„è‡ªåŠ¨ç‰ˆï¼Œèƒ½å¤Ÿåå°ç›‘æ§ä¸»æœºæ˜¯å¦æ•…éšœï¼Œå¦‚æœæ•…éšœäº†æ ¹æ®æŠ•ç¥¨æ•°è‡ªåŠ¨å°†ä»åº“è½¬æ¢ä¸ºä¸»åº“

æ€ä¹ˆç©
	è‡ªå®šä¹‰çš„/myredisç›®å½•ä¸‹æ–°å»ºsentinel.confæ–‡ä»¶ï¼Œåå­—ç»ä¸èƒ½é”™
	sentinel.confå†…å®¹ï¼š sentinel monitor è¢«ç›‘æ§ä¸»åº“(è‡ªå·±èµ·åå­—) 127.0.0.1 6379 1
	ä¸Šé¢æœ€åä¸€ä¸ªæ•°å­—1ï¼Œè¡¨ç¤ºä¸»æœºæŒ‚æ‰åsalveæŠ•ç¥¨çœ‹è®©è°æ¥æ›¿æˆä¸ºä¸»æœºï¼Œå¾—ç¥¨æ•°å¤šå°‘åæˆä¸ºä¸»æœº
	redis-sentinel /myredis/sentinel.conf 
```





### Redisç¼“å­˜

SpringBootä¸Redisæ•´åˆ

> pom.xmlé…ç½®

```pom.xml
<!-- redis -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-data-redis</artifactId>
</dependency>

<!-- spring2.Xé›†æˆredisæ‰€éœ€common-pool2-->
<dependency>
    <groupId>org.apache.commons</groupId>
    <artifactId>commons-pool2</artifactId>
    <version>2.6.0</version>
</dependency>
```



> application.propertiesé…ç½®

```properties
spring.redis.host=127.0.0.1
spring.redis.port=6379
spring.redis.database=0
spring.redis.timeout=1800000

spring.redis.lettuce.pool.max-active=20
spring.redis.lettuce.pool.max-wait=-1
#æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´(è´Ÿæ•°è¡¨ç¤ºæ²¡é™åˆ¶)
spring.redis.lettuce.pool.max-idle=5
spring.redis.lettuce.pool.min-idle=0
```



> Redisç¼“å­˜é…ç½®ç±»

```java
@EnableCaching //å¼€å¯ç¼“å­˜
@Configuration  //é…ç½®ç±»
public class RedisConfig extends CachingConfigurerSupport {

    @Bean
    public RedisTemplate<String, Object> redisTemplate(RedisConnectionFactory factory) {
        RedisTemplate<String, Object> template = new RedisTemplate<>();
        RedisSerializer<String> redisSerializer = new StringRedisSerializer();
        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);
        ObjectMapper om = new ObjectMapper();
        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);
        jackson2JsonRedisSerializer.setObjectMapper(om);
        template.setConnectionFactory(factory);
        //keyåºåˆ—åŒ–æ–¹å¼
        template.setKeySerializer(redisSerializer);
        //valueåºåˆ—åŒ–
        template.setValueSerializer(jackson2JsonRedisSerializer);
        //value hashmapåºåˆ—åŒ–
        template.setHashValueSerializer(jackson2JsonRedisSerializer);
        return template;
    }

    @Bean
    public CacheManager cacheManager(RedisConnectionFactory factory) {
        RedisSerializer<String> redisSerializer = new StringRedisSerializer();
        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);
        //è§£å†³æŸ¥è¯¢ç¼“å­˜è½¬æ¢å¼‚å¸¸çš„é—®é¢˜
        ObjectMapper om = new ObjectMapper();
        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);
        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);
        jackson2JsonRedisSerializer.setObjectMapper(om);
        // é…ç½®åºåˆ—åŒ–ï¼ˆè§£å†³ä¹±ç çš„é—®é¢˜ï¼‰,è¿‡æœŸæ—¶é—´600ç§’
        RedisCacheConfiguration config = RedisCacheConfiguration.defaultCacheConfig()
                .entryTtl(Duration.ofSeconds(600))
                .serializeKeysWith(RedisSerializationContext.SerializationPair.fromSerializer(redisSerializer))
                .serializeValuesWith(RedisSerializationContext.SerializationPair.fromSerializer(jackson2JsonRedisSerializer))
                .disableCachingNullValues();
        RedisCacheManager cacheManager = RedisCacheManager.builder(factory)
                .cacheDefaults(config)
                .build();
        return cacheManager;
    }
}
```



> SpringBootç¼“å­˜æ³¨è§£

```
//keyåŠ ä¸Šå•å¼•å·
@Cacheable(key="'getUserList'",value="userList")
æ ¹æ®æ–¹æ³•å¯¹å…¶æ–¹æ³•ç»“æœè¿›è¡Œç¼“å­˜ï¼Œä¸‹æ¬¡è¯·æ±‚æ—¶ï¼Œå¦‚æœç¼“å­˜å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¯»å–ç¼“å­˜æ•°æ®è¿”å›ï¼›å¦‚æœç¼“å­˜ä¸å­˜åœ¨ï¼Œåˆ™æ‰§è¡Œæ–¹æ³•ï¼Œ å¹¶å°†è¿”å›ç»“æœå­˜å…¥ç¼“å­˜ä¸­ã€‚ä¸€èˆ¬ç”¨åœ¨æŸ¥è¯¢æ–¹æ³•ä¸Šã€‚

@CachePut
ä½¿ç”¨è¯¥æ³¨è§£æ ‡å¿—çš„æ–¹æ³•ï¼Œæ¯æ¬¡éƒ½ä¼šæ‰§è¡Œå¹¶å°†ç»“æœå­˜å…¥æŒ‡å®šçš„ç¼“å­˜ä¸­ã€‚å…¶ä»–æ–¹æ³•å¯ä»¥ç›´æ¥ä»å“åº”çš„ç¼“å­˜ä¸­è¯»å–ç¼“å­˜æ•°æ®ï¼Œ
è€Œä¸éœ€è¦å†å»æŸ¥è¯¢æ•°æ®åº“ã€‚ä¸€èˆ¬ç”¨åœ¨æ–°å¢æ–¹æ³•ä¸Šã€‚

@CacheEvict
ä½¿ç”¨è¯¥æ³¨è§£æ ‡å¿—çš„æ–¹æ³•ï¼Œä¼šæ¸…ç©ºæŒ‡å®šçš„ç¼“å­˜ï¼Œä¸€èˆ¬ç”¨åœ¨æ›´æ–°æˆ–è€…åˆ é™¤æ–¹æ³•ä¸Šã€‚allEntriesæ¸…ç©ºæ‰€æœ‰ç¼“å­˜å±æ€§
```



### Redis+RabbitMQ å®ç°è®¢å•ç§’æ€

å‚è€ƒï¼š[ç§’æ€æ€è·¯](https://blog.csdn.net/WayneLee0809/article/details/100930245)



### GETå’ŒPOSTä¸¤ç§åŸºæœ¬è¯·æ±‚æ–¹æ³•çš„åŒºåˆ«

å‚è€ƒï¼š[GETå’ŒPOSTä¸¤ç§åŸºæœ¬è¯·æ±‚æ–¹æ³•çš„åŒºåˆ«](http://cnblogs.com/songanwei/p/9387815.html)

```
é™¤äº†ä¸€äº›å¸¸è§çš„åŒºåˆ«ï¼Œä»–ä»¬åœ¨è¯·æ±‚é€Ÿåº¦ä¸Šä¹Ÿä¼šæ‰€åŒºåˆ«ï¼Œ
GETäº§ç”Ÿä¸€ä¸ªTCPæ•°æ®åŒ…ï¼›POSTäº§ç”Ÿä¸¤ä¸ªTCPæ•°æ®åŒ…ã€‚
å¯¹äºGETæ–¹å¼çš„è¯·æ±‚ï¼Œæµè§ˆå™¨ä¼šæŠŠhttp headerå’Œdataä¸€å¹¶å‘é€å‡ºå»ï¼ŒæœåŠ¡å™¨å“åº”200ï¼ˆè¿”å›æ•°æ®ï¼‰ï¼›
è€Œå¯¹äºPOSTï¼Œæµè§ˆå™¨å…ˆå‘é€headerï¼ŒæœåŠ¡å™¨å“åº”100 continueï¼Œæµè§ˆå™¨å†å‘é€dataï¼ŒæœåŠ¡å™¨å“åº”200 okï¼ˆè¿”å›æ•°æ®ï¼‰ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼ŒGETåªéœ€è¦æ±½è½¦è·‘ä¸€è¶Ÿå°±æŠŠè´§é€åˆ°äº†ï¼Œè€ŒPOSTå¾—è·‘ä¸¤è¶Ÿï¼Œç¬¬ä¸€è¶Ÿï¼Œå…ˆå»å’ŒæœåŠ¡å™¨æ‰“ä¸ªæ‹›å‘¼â€œå—¨ï¼Œæˆ‘ç­‰ä¸‹è¦é€ä¸€æ‰¹è´§æ¥ï¼Œä½ ä»¬æ‰“å¼€é—¨è¿æ¥æˆ‘â€ï¼Œç„¶åå†å›å¤´æŠŠè´§é€è¿‡å»ã€‚
å› ä¸ºPOSTéœ€è¦ä¸¤æ­¥ï¼Œæ—¶é—´ä¸Šæ¶ˆè€—çš„è¦å¤šä¸€ç‚¹ï¼Œçœ‹èµ·æ¥GETæ¯”POSTæ›´æœ‰æ•ˆã€‚å› æ­¤Yahooå›¢é˜Ÿæœ‰æ¨èç”¨GETæ›¿æ¢POSTæ¥ä¼˜åŒ–ç½‘ç«™æ€§èƒ½ã€‚ä½†è¿™æ˜¯ä¸€ä¸ªå‘ï¼è·³å…¥éœ€è°¨æ…ã€‚ä¸ºä»€ä¹ˆï¼Ÿ
1. GETä¸POSTéƒ½æœ‰è‡ªå·±çš„è¯­ä¹‰ï¼Œä¸èƒ½éšä¾¿æ··ç”¨ã€‚
2. æ®ç ”ç©¶ï¼Œåœ¨ç½‘ç»œç¯å¢ƒå¥½çš„æƒ…å†µä¸‹ï¼Œå‘ä¸€æ¬¡åŒ…çš„æ—¶é—´å’Œå‘ä¸¤æ¬¡åŒ…çš„æ—¶é—´å·®åˆ«åŸºæœ¬å¯ä»¥æ— è§†ã€‚è€Œåœ¨ç½‘ç»œç¯å¢ƒå·®çš„æƒ…å†µä¸‹ï¼Œä¸¤æ¬¡åŒ…çš„TCPåœ¨éªŒè¯æ•°æ®åŒ…å®Œæ•´æ€§ä¸Šï¼Œæœ‰éå¸¸å¤§çš„ä¼˜ç‚¹ã€‚
3. å¹¶ä¸æ˜¯æ‰€æœ‰æµè§ˆå™¨éƒ½ä¼šåœ¨POSTä¸­å‘é€ä¸¤æ¬¡åŒ…ï¼ŒFirefoxå°±åªå‘é€ä¸€æ¬¡ã€‚
```





### ä¸¤ä¸ªæ•°ç»„å–å·®é›†

```js
let newUser = res.result;
newUser = newUser.filter(a => {
    return !this.lr.peopleData.find(b => {
     	return a.userSerial == b.userSerial   
    })
})
this.lr.peopleData.push(...newUser)
```



### è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„åŒºåˆ«

å‚è€ƒï¼š[è¿‡æ»¤å™¨ä¸æ‹¦æˆªå™¨çš„åŒºåˆ«](https://blog.csdn.net/zxd1435513775/article/details/80556034)



### å•ç‚¹ç™»å½•

å‚è€ƒï¼š[å•ç‚¹ç™»å½•](https://ke.qq.com/course/295318?taid=1976011373969814)

> ä»€ä¹ˆæ˜¯å•ç‚¹ç™»å½•?

```
å•ç‚¹ç™»å½•å…¨ç§°single Sign On (ä»¥ä¸‹ç®€ç§°SSO)ï¼Œæ˜¯æŒ‡åœ¨å¤šç³»ç»Ÿåº”ç”¨ç¾¤ä¸­ç™»å½•- -ä¸ªç³»ç»Ÿï¼Œä¾¿å¯åœ¨å…¶ä»–æ‰€æœ‰ç³»ç»Ÿä¸­å¾—åˆ°æˆæƒè€Œæ— éœ€å†æ¬¡ç™»å½•ï¼ŒåŒ…æ‹¬å•ç‚¹ç™»å½•ä¸å•ç‚¹æ³¨é”€ä¸¤éƒ¨åˆ†.
```



> ç™»å½•

```
ç›¸æ¯”äºå•ç³»ç»Ÿç™»å½•ï¼Œssoéœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„è®¤è¯ä¸­å¿ƒï¼Œåªæœ‰è®¤è¯ä¸­å¿ƒèƒ½æ¥å—ç”¨æˆ·çš„ç”¨æˆ·åå¯†ç ç­‰å®‰å…¨ä¿¡æ¯ï¼Œå…¶ä»–ç³»ç»Ÿä¸æä¾›ç™»å½•å…¥å£ï¼Œåªæ¥å—è®¤è¯ä¸­å¿ƒçš„é—´æ¥æˆæƒã€‚
é—´æ¥æˆæƒé€šè¿‡ä»¤ç‰Œå®ç°ï¼Œssoè®¤è¯ä¸­å¿ƒéªŒè¯ç”¨æˆ·çš„ç”¨æˆ·åå¯†ç æ²¡é—®é¢˜ï¼Œåˆ›å»ºæˆæƒä»¤ç‰Œï¼Œåœ¨æ¥ä¸‹æ¥çš„è·³è½¬è¿‡ç¨‹ä¸­ï¼Œæˆæƒä»¤ç‰Œä½œä¸ºå‚æ•°å‘é€ç»™å„ä¸ªå­ç³»ç»Ÿï¼Œå­ç³»ç»Ÿæ‹¿åˆ°ä»¤ç‰Œï¼Œå³å¾—åˆ°äº†æˆæƒï¼Œå¯ä»¥å€Ÿæ­¤åˆ›å»ºå±€éƒ¨ä¼šè¯ï¼Œå±€éƒ¨ä¼šè¯ç™»å½•æ–¹å¼ä¸å•ç³»ç»Ÿçš„ç™»å½•å¼ç›¸åŒã€‚è¿™ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯å•ç‚¹ç™»å½•çš„åŸç†ï¼Œç”¨ä¸‹å›¾è¯´æ˜
```



> æµç¨‹

```
1.è®¿é—®AåŸŸå
2.éªŒè¯æ²¡æœ‰ç™»é™† é‡å®šå‘åˆ°ç»Ÿä¸€ç™»é™†è®¤è¯ä¸­å¿ƒ
3.éªŒè¯æ˜¯å¦æœ‰å…¨å±€å¯¹è¯ â‘ æ²¡æœ‰åˆ™å“åº”åˆ°åŒæ„ç™»å½•é¡µé¢ â‘¡æœ‰ åˆ™ç›¸åº”åˆ°AåŸŸåä¸»é¡µ
4.æ²¡æœ‰çš„è¯ åˆ™è¿›è¡Œç™»å½•åˆ›å»ºå…¨å±€
```



### Httpsé…ç½®

> ç”Ÿæˆå¯†é’¥æ–‡ä»¶

```cmd
keytool -genkey -v -alias nianshaoyouwei -keyalg RSA -keystore C:/keys/nianshaoyouwei.keystore -validity 36500
```

> ç”Ÿæˆè¯ä¹¦

```cmd
keytool -export -alias nianshaoyouwei -storepass a9530.A. -file C:/keys/nianshaoyouwei.cer -keystore C:/keys/nianshaoyouwei.keystore
```

> å¯¼å…¥è¯ä¹¦ éœ€è¦å…ˆåˆ é™¤ jre\lib\security\cacerts æ–‡ä»¶

```cmd
keytool -import -keystore "C:\Program Files\Java\jdk1.8.0_131\jre\lib\security\cacerts" -storepass changeit -keypass changeit -alias emailcert -file C:/keys/nianshaoyouwei.cer
```



### MyBatis-Plus

> Mybatis-Plusï¼ˆç®€ç§°MPï¼‰æ˜¯ä¸€ä¸ª Mybatis çš„å¢å¼ºå·¥å…·ï¼Œåœ¨ Mybatis çš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿ 

```
<!--mybatis-plus-->
<dependency>
    <groupId>com.baomidou</groupId>
    <artifactId>mybatis-plus-boot-starter</artifactId>
    <version>3.0.5</version>
</dependency>

<!--mysql-->
<!--mysql6ä»¥åŠä»¥ä¸Šæ˜¯com.mysql.cj.jdbc.Driver å¹¶ä¸”åœ¨urlä¹‹åè¦æŒ‡å®šæ—¶åŒº-->
<!--å¦‚æœä½ çš„é…ç½®æ•°æ®åº“æ–‡ä»¶æ˜¯ com.mysql.jdbc.Driver è¿™ä¸ªjaråŒ…ç‰ˆæœ¬æ¢æˆ5.1.8çš„-->
<dependency>
    <groupId>mysql</groupId>
    <artifactId>mysql-connector-java</artifactId>
    <version>5.1.8</version>
</dependency>

mapper ç»§æ‰¿ BaseMapper<Entity>
```



> ä¸»é”®ç”Ÿæˆç­–ç•¥

```java
/*
    AUTOã€INPUTã€NONEã€
    mpè‡ªå¸¦ç­–ç•¥ï¼šID_WORKER(19ä½æ•°å­—)ã€ID_WORKER_STR(19ä½å­—ç¬¦)
*/
@TalbleId(type=IdType.AUTO)
private Loing id;

1.è‡ªåŠ¨å¢é•¿
	AUTO_INCREMENT
2.UUID
	æ¯æ¬¡ç”Ÿæˆéšæœºå”¯ä¸€çš„å€¼
3.Rediså®ç°
    å¯ä»¥ä½¿ç”¨Redisé›†ç¾¤æ¥è·èŒæ›´é«˜çš„è´¡åé‡Œã€‚å‡å¦‚ä¸€ä¸ªé›†ç¾¤ä¸­æœ‰5å°Redis.
    å¯ä»¥åˆå§‹åŒ–æ¯å°Redisçš„å€¼åˆ†åˆ«æ˜¯1,2,3,4,5,ç„¶åæ­¥é•¿éƒ½æ˜¯Sã€‚å¤‡ä¸ªRedisç”Ÿæˆçš„IDä¸º:
        A: 1,6,11,16,21
        B: 2,7,12,17,22
        C: 1,3,8,13,18,23
        D: 4,9,14,19,24
        E: 5,10,15,20,25
4.mpè‡ªå¸¦ç­–ç•¥
	snowflakeç®—æ³•
	æ ¸å¿ƒæ€æƒ³æ˜¯:
		ä½¿ç”¨41bitä½œä¸ºæ¯«ç§’æ•°ï¼Œ10bitä½œä¸ºæœºå™¨çš„ID (5ä¸ªbitæ˜¯æ•°æ®ä¸­å¿ƒï¼Œ5ä¸ªbitçš„æœºå™¨ID)
		12bitä½œä¸ºæ¯«ç§’å†…çš„æµæ°´å·æ„æ˜§ç€æ¯ä¸ªèŠ‚ç‚¹åœ¨æ¯æ¯«ç§’å¯ä»¥äº§ç”Ÿ4096ä¸ªID)
```



> è‡ªåŠ¨å¡«å……

```java
1.åœ¨å®ä½“ç±»å±æ€§æ·»åŠ æ³¨è§£
	@TableField(fill=Field.INSERT)
	private Date createTime;
	@TableField(file=Field.INSERT_UPDATE)
	private Date updateTime;
2.åˆ›å»ºç±»ï¼Œå®ç°MetaObjectHandleå®ç°æ¥å£çš„æ–¹æ³•
    @Component
    public class MyMetaObjectHandler implements MetaObjectHandler {
        //è‡ªåŠ¨å¡«å……ï¼šæ‰§è¡Œæ’å…¥æ“ä½œ
        @Override
        public void insertFill(MetaObject metaObject) {
            this.setFieldValByName("version",1,metaObject);
            this.setFieldValByName("createDateTime",new Date(),metaObject);
            this.setFieldValByName("updateDateTime",new Date(),metaObject);
        }

        //è‡ªåŠ¨å¡«å……ï¼šæ‰§è¡Œæ›´æ–°æ“ä½œ
        @Override
        public void updateFill(MetaObject metaObject) {
            this.setFieldValByName("updateDateTime",new Date(),metaObject);
        }
    }
```



> ä¹è§‚é”

```
æ‚²è§‚é” ä¹è§‚é”æ˜¯ä¸€ç§æ€æƒ³ã€‚

æ‚²è§‚é”è¿™æ˜¯ä¸€ç§å¯¹æ•°æ®çš„ä¿®æ”¹æŠ±æœ‰æ‚²è§‚æ€åº¦çš„å¹¶å‘æ§åˆ¶æ–¹å¼ã€‚æˆ‘ä»¬ä¸€èˆ¬è®¤ä¸ºæ•°æ®è¢«å¹¶å‘ä¿®æ”¹çš„æ¦‚ç‡æ¯”è¾ƒå¤§ï¼Œæ‰€ä»¥éœ€è¦åœ¨ä¿®æ”¹ä¹‹å‰å…ˆåŠ é”ã€‚ä½†æ˜¯åœ¨æ•ˆç‡æ–¹é¢ï¼Œå¤„ç†åŠ é”çš„æœºåˆ¶ä¼šè®©æ•°æ®åº“äº§ç”Ÿé¢å¤–çš„å¼€é”€ï¼Œè¿˜æœ‰å¢åŠ äº§ç”Ÿæ­»é”çš„æœºä¼šã€‚ä½¿ç”¨çš„è¯ï¼Œå…ˆå°†è‡ªåŠ¨æäº¤äº‹åŠ¡å…³é—­ï¼Œå¼€å¯äº‹åŠ¡ï¼Œselectâ€¦for updateä¼šæŠŠæ•°æ®ç»™é”ä½ï¼Œæ›´æ–°æ•°æ®ï¼Œå…³é—­äº‹åŠ¡

ä¹è§‚é”åœ¨å¯¹æ•°æ®åº“è¿›è¡Œå¤„ç†çš„æ—¶å€™ï¼Œä¹è§‚é”å¹¶ä¸ä¼šä½¿ç”¨æ•°æ®åº“æä¾›çš„é”æœºåˆ¶ã€‚ä¸€èˆ¬çš„å®ç°ä¹è§‚é”çš„æ–¹å¼å°±æ˜¯è®°å½•æ•°æ®ç‰ˆæœ¬ã€‚è§£å†³ä¸¢å¤±æ›´æ–°ï¼Œæ›´æ–°æ—¶å¸¦ä¸Šç‰ˆæœ¬å·æ¡ä»¶ã€‚ä½¿ç”¨çš„è¯update items set age = 2where id = 1 and version = 3;
```



> ä¹è§‚é”ï¼šMyBatisPluså®ç°

```java
1.å†å®ä½“ç±»å±æ€§æ·»åŠ æ³¨è§£
    @Version
    @TableField(fill = FieldFill.INSERT)
    private Integer version;
2.æ·»åŠ ä¹è§‚é”æ’ä»¶
    @Bean
    public OptimisticLockerInterceptor optimisticLockerInterceptor() {
        return new OptimisticLockerInterceptor();
    }
3.ä»£ç å®ç°
    //æµ‹è¯•ä¹è§‚é”ï¼šå…ˆæŸ¥è¯¢ å†ä¿®æ”¹
    User user = userMapper.selectById(2);
    user.setUserName("äºŒå“¥");
    int num = userMapper.updateById(user);
    System.out.println(num);
```



> åˆ†é¡µæŸ¥è¯¢

```java
1.æ·»åŠ åˆ†é¡µæ’ä»¶
    //åˆ†é¡µæ’ä»¶
    @Bean
    public PaginationInterceptor paginationInterceptor() {
        return new PaginationInterceptor();
    }
2.ä»£ç å®ç°
    Page<User> userPage = new Page<>(1,3);
    userPage.setDesc("id");
    userMapper.selectPage(userPage,null);

    System.out.println(userPage.getCurrent());
    System.out.println(userPage.getSize());
    System.out.println(userPage.getTotal());
    System.out.println(userPage.getRecords().toString());
```



> é€»è¾‘åˆ é™¤

```java
1.å†å®ä½“ç±»å±æ€§æ·»åŠ æ³¨è§£
    @TableLogic
	private Integer is_delete;
2.æ·»åŠ é€»è¾‘åˆ é™¤æ’ä»¶
    @Bean
    public ISqlInjector sqlInjector() {
        return new LogicSqlInjector();
    }
3.å®ç°ä»£ç 
    //é€»è¾‘åˆ é™¤ï¼Œåº•å±‚æ‰§è¡Œçš„æ›´æ–°æ“ä½œ
    int num = userMapper.deleteById(2);
	//é…ç½®é€»è¾‘åˆ é™¤æ’ä»¶ï¼ŒæŸ¥è¯¢æ—¶ä¼šå¸¦ä¸Šis_deleteæ¡ä»¶ï¼Œæƒ³æŸ¥è¯¢åˆ é™¤çš„æ•°æ®ï¼Œåªèƒ½é€šè¿‡.xmlæŸ¥è¯¢
    List<User> userList = userMapper.selectList(null);
```



> æ€§èƒ½åˆ†æ

```java
1.æ·»åŠ æ€§èƒ½åˆ†ææ’ä»¶
    @Bean
    @Profile({"dev","test"})// è®¾ç½® dev test ç¯å¢ƒå¼€å¯
    public PerformanceInterceptor performanceInterceptor() {
        PerformanceInterceptor performanceInterceptor = new PerformanceInterceptor();
        performanceInterceptor.setMaxTime(500);//msï¼Œè¶…è¿‡æ­¤å¤„è®¾ç½®çš„msåˆ™sqlä¸æ‰§è¡Œ
        performanceInterceptor.setFormat(true);
        return performanceInterceptor;
    }
```



> å¤æ‚æŸ¥è¯¢

```java
//Wrapperå®ç°ç±»
QueryWrapper<User> userQueryWrapper = new QueryWrapper<>();
//æŸ¥è¯¢æ¡ä»¶
userQueryWrapper.eq("user_name","é‡‡å…ˆç”Ÿi");
//æŸ¥è¯¢éœ€è¦çš„å­—æ®µ
userQueryWrapper.select("id","user_name","create_date_time");
//æ‰§è¡ŒæŸ¥è¯¢
List<User> userList = userMapper.selectList(userQueryWrapper);
```



### ES6

> è§£æ„

```
let user = {name:'å¼ ä¸‰',age:18}
let {name,age} = user;
```



> ç®­å¤´å‡½æ•°

```
var f1 = function(m){
	return m;
}
var f2 = m => m;
```



> æ¨¡æ¿å­—ç¬¦ä¸²

```0
let name = 'å¼ ä¸‰';
let str = `æˆ‘æ˜¯${name}`;//æˆ‘æ˜¯å¼ ä¸‰

function f1(){
	return 'æå››'
}
let str = `æˆ‘æ˜¯${f1()}`;//æˆ‘æ˜¯æå››
```



> å·§å¦™ï¼š

```js
var a = "";
console.log(a || 'é»˜è®¤å€¼');//å½“aä¸ºç©ºçš„æ—¶å€™ï¼Œä¼šè¾“å‡ºé»˜è®¤å€¼

printNum(2);
function printNum(num='é»˜è®¤å€¼'){
    console.log(num);//å½“ä¸ä¼ å‚æ•°æ—¶ï¼Œä¼šè¾“å‡ºé»˜è®¤å€¼
}
```



> sort

```js
let fPersons = persons.sort(function(x,y){
    return x-y;//å‡åº
    //reutrn y-x;//é™åº
})
```



> filter

```js
let fPersons = persons.filter(p => p.name.indexOf())
```



> map æ¥æ”¶ä¸€ä¸ªå‡½æ•°ï¼Œå°†åŸæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ç”¨è¿™ä¸ªå‡½æ•°å¤„ç†åæ”¾å…¥æ–°æ•°ç»„è¿”å›ã€‚

```js
let fPersons = persons.map(item => ({
	id:item.userId,
	name:item.userName
    //é‡æ–°å®šä¹‰å¯¹è±¡å±æ€§çš„key
}))
```



> reduce ä¸ºæ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä¾æ¬¡æ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œä¸åŒ…æ‹¬æ•°ç»„ä¸­è¢«åˆ é™¤æˆ–ä»æœªè¢«èµ‹å€¼çš„å…ƒç´ 

```
arr.reduce(callback,[initialValue])
1ã€previousValue (ä¸Šä¸€æ¬¡è°ƒç”¨å›è°ƒè¿”å›çš„å€¼ï¼Œæˆ–è€…æ˜¯æä¾›çš„åˆå§‹å€¼( initialValue) )
2ã€currentValue (æ•°ç»„ä¸­å½“å‰è¢«å¤„ç†çš„å…ƒç´ )
3ã€index (å½“å‰å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ç´¢å¼•) 
4ã€array (è°ƒç”¨reduceçš„æ•°ç»„) 

let arr = [2,-10,30,13];
let result = arr.reduce((a,b)=>{
	console.log("ä¸Šæ¬¡å¤„ç†å:"+a);
	console.log("ä¸Šæ¬¡å¤„ç†å:"+b);
	return a+b;
})
console.log(result);
```



> promise å°è£…å¼‚æ­¥æ“ä½œ

```js
function get(url,data){
	return new Promise(resolve,reject) => {
		$.ajax({
			url: url,
			data: data,
			success: function(data){
				resolve(data)''
			},
			error: function(err){
				reject(err);
			}
		})
	}
}

get("mock/user.json")
    .then((data) =>{
        console.log('ç”¨æˆ·æŸ¥è¯¢æˆåŠŸ:'+data);
        return get(`mock/user_score_${data.id}.json`);
    }).then((data)=>{
		console.log('è¯¾ç¨‹æŸ¥è¯¢æˆåŠŸ:'+data);
    	return get(`mock/corse_score_${data.id}.json`);
    }).then((data)=>{
    	console.log('è¯¾ç¨‹æˆç»©æŸ¥è¯¢æˆåŠŸ:'+data);
	}).catch((err)=>{
    	console.log('å‡ºç°å¼‚å¸¸:'+err);
	});
```



> æ¨¡å—åŒ–

å‚è€ƒï¼š[ES6æ¨¡å—èŠ±åŒ–](https://blog.csdn.net/qq_33295794/article/details/75338575)

```js
/*es5æ¨¡å—åŒ–*/

//åˆ›å»ºæ¨¡å—åŒ–
const num1 = 1;
const num2 = 2;
module.export = {
	num1,num2
}
//å¼•ç”¨æ¨¡å—åŒ–
const m = request('./æ–‡ä»¶å.js');
console.log(m.num1);



/*es6æ¨¡å—åŒ–ï¼šes6å®ç°æ¨¡å—åŒ–æ“ä½œï¼Œä¸èƒ½ç›´æ¥åœ¨node.jsä¸­ç›´æ¥è¿è¡Œï¼Œéœ€è¦ç”¨babelè½¬ä¸ºess5*/
//åˆ›å»ºæ¨¡å—åŒ–
export function fun1(){
    console.log('fun1');
}
export function fun2(){
    console.log('fun2');
}
//å¼•ç”¨æ¨¡å—åŒ–
import {fun1,fun2} from './æ–‡ä»¶å.js'
fun1();
fun2();
```



### é˜¿é‡Œäº‘OSS

å‚è€ƒï¼š[é˜¿é‡Œäº‘](https://www.aliyun.com/ )  [å­¦ä¹ è·¯å¾„](https://help.aliyun.com/learn/learningpath/oss.html?spm=5176.7933691.1309819.8.7f392a66swxJkC&aly_as=3eLSnC9NS)

```java
//è§£å†³Failed to configure a DataSource: 'url' attribute is not specified and no embedded datasource could be configured.
@SpringBootApplication(exclude = DataSourceAutoConfiguration.class)
```



### é˜¿é‡Œäº‘çŸ­ä¿¡éªŒè¯

å‚è€ƒï¼š[é˜¿é‡Œäº‘](https://www.aliyun.com/ )  



### é˜¿é‡Œäº‘ICON

å‚è€ƒï¼š[é˜¿é‡Œäº‘ICON](https://www.iconfont.cn/)



### OAuth2

å‚è€ƒï¼š[å¦‚ä½•ç†è§£OAuth2](http://www.ruanyifeng.com/blog/2019/04/oauth_design.html)  [OAuth 2.0 çš„å››ç§æ–¹å¼](http://www.ruanyifeng.com/blog/2019/04/oauth-grant-types.html)  

```
JWTï¼Œæ˜¯TOKENçš„ä¸€ç§å½¢å¼ï¼ŒTOKENè¯´ç®€å•äº†ï¼Œå°±æ˜¯ä¸€ä¸ªç§˜é’¥(éšæœºæ•°ï¼‰ã€‚ä»¥å¾€çš„TOKENï¼Œä½ æ‹¿åˆ°ä¹‹åè¦è·å–ç”¨æˆ·ä¿¡æ¯ï¼Œéœ€è¦å†å»æ•°æ®åº“åŒ¹é…æŸ¥è¯¢ï¼Œè€ŒJWTå¹²è„†å°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åœ¨äº†TOKENé‡Œï¼Œä½ è§£æå°±å¯ä»¥è·å¾—ã€‚æ‰€ä»¥ï¼Œä¸¤è€…æ ¹æœ¬å°±ä¸æ˜¯ä¸€ç§ä¸œè¥¿ã€‚

OAUTH2.0æ˜¯ä¸€ç§æˆæƒæ–¹å¼ï¼Œä¸€ç§æµç¨‹è§„èŒƒã€‚æ¯”å¦‚è¯´ä½ è¦è®¿é—®æŸä¸ªè®ºå›ï¼Œä½†æ˜¯ä½ ä¸æƒ³é‡æ–°æ³¨å†Œï¼Œä½ æƒ³ç”¨QQå·ç™»é™†ï¼ï¼ˆéœ€è¦è®ºå›å…ˆåœ¨QQå¼€æ”¾å¹³å°æ³¨å†Œï¼‰ï¼Œé‚£ä¹ˆä½ ç™»å½•çš„æ—¶å€™ï¼Œé€‰æ‹©QQï¼Œå®ƒå°±ä¼šè·³è½¬åˆ°QQçš„ç™»å½•é¡µé¢ï¼Œä½ ç™»å½•å®Œï¼Œå†è·³è½¬åˆ°è®ºå›ã€‚è®ºå›å°±ä¼šè·å–QQç»™çš„æˆæƒä¿¡æ¯ã€‚æˆ‘è¿™é‡Œåªæ˜¯ç®€å•è¯´ä¸€ä¸‹æµç¨‹ï¼Œå…·ä½“ä¼šå¤æ‚å¾ˆå¤šã€‚

OAuth2ç”¨åœ¨ä½¿ç”¨ç¬¬ä¸‰æ–¹è´¦å·ç™»å½•çš„æƒ…å†µ(æ¯”å¦‚ä½¿ç”¨weibo, qq, githubç™»å½•æŸä¸ªapp)ã€‚OAuth2æ˜¯ä¸€ä¸ªç›¸å¯¹å¤æ‚çš„åè®®, æœ‰4ç§æˆæƒæ¨¡å¼, å…¶ä¸­çš„access codeæ¨¡å¼åœ¨å®ç°æ—¶å¯ä»¥ä½¿ç”¨jwtæ‰ç”Ÿæˆcode, ä¹Ÿå¯ä»¥ä¸ç”¨. å®ƒä»¬ä¹‹é—´æ²¡æœ‰å¿…ç„¶çš„è”ç³». 
```



> å¾®ä¿¡ç™»é™†

```
1.ç”ŸæˆäºŒç»´ç 
https://open.weixin.qq.com/connect/qrconnect" +
                "?appid=%s" +
                "&redirect_uri=%s" +
                "&response_type=code" +
                "&scope=snsapi_login" +
                "&state=%s" +
                "#wechat_redirect


2.ç”¨æˆ·æ‰«ç ä¼šå›è°ƒä¸€ä¸ªè‡ªå®šä¹‰å‡½æ•°ï¼Œä¸¤ä¸ªå½¢å‚codeã€state
æ¥ç€æ ¹æ®codeè·å–ä¸´æ—¶ç¥¨æ®,å¾—åˆ°accsess_token å’Œ openid
https://api.weixin.qq.com/sns/oauth2/access_token" +
                    "?appid=%s" +
                    "&secret=%s" +
                    "&code=%s" +
                    "&grant_type=authorization_code
                    
                    
3.æ‹¿ç€å¾—åˆ°accsess_token å’Œ openidï¼Œå†å»è¯·æ±‚å¾®ä¿¡æä¾›å›ºå®šçš„åœ°å€ï¼Œè·å–åˆ°æ‰«æäººä¿¡æ¯
https://api.weixin.qq.com/sns/userinfo" +
                        "?access_token=%s" +
                        "&openid=%s

appid: wxed9954c01bb89b47

# å¾®ä¿¡å¼€æ”¾å¹³å° appsecret
appsecret: a7482517235173ddb4083788de60b90e

# å¾®ä¿¡å¼€æ”¾å¹³å° é‡å®šå‘urlï¼ˆguli.shopéœ€è¦åœ¨å¾®ä¿¡å¼€æ”¾å¹³å°é…ç½®ï¼‰
redirecturl: http://guli.shop/api/ucenter/wx/callback
```





### SSOå•ç‚¹ç™»é™†

å‚è€ƒï¼š[springBoot+redis å®ç°sessionå…±äº«ç†è§£ï¼Œåº”ç”¨åœºæ™¯å•ç‚¹ç™»å½•](https://blog.csdn.net/qq_33251859/article/details/79972551 )

> 1.sessionå¹¿æ’­

```
sessionå¤åˆ¶
```



> 2.cookie+redis

```
1.åœ¨é¡¹ç›®ä¸­ä»»ä½•ä¸€ä¸ªæ¨¡å—è¿›è¡Œç™»å½•ï¼Œè³½å½•ä¹‹åï¼ŒæŠŠæ•°æ®æ”¾åˆ°ä¸¤ä¸ªåœ°æ–¹
(1) redis,åœ¨keyç”Ÿæˆå”¯ä¸€éšæœºå€¼(ipã€ç”¨æˆ·idç­‰ç­‰)ã€‚åœ¨valueè·å–ç”¨æˆ·æ•°æ®
(2) cookie;æŠŠredisé‡Œé¢ç”Ÿæˆkeyå€¼æ”¾åˆ°cookieé‡Œé¢
2ã€è®¿é—®é¡¹ç›®ä¸­å…¶ä»–æ¨¡å—ï¼Œå‘é€è¯·æ±‚å¸¦ç€cookieè¿›è¡Œå‘é€ã€‚è·å–cookieå€¼ï¼Œæ‹¿ç€cookieåšäº‹æƒ…
(1)æŠŠcookieè·å–å€¼ï¼Œåˆ°redisè¿›è¡ŒæŸ¥è¯¢ï¼Œæ ¹æ®keyè¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœæŸ¥è¯¢æ•°æ®å°±æ˜¯ç™»å½•
```



> 3.ä½¿ç”¨token

```
tokenï¼šæŒ‰ç…§ä¸€å®šè§„åˆ™ç”Ÿæˆå­—ç¬¦ä¸²ï¼Œå­—ç¬¦ä¸²å¯ä»¥åŒ…å«ç”¨æˆ·ä¿¡æ¯
1.åœ¨é¡¹ç›®æŸä¸ªæ¨¡å—è¿›è¡ŒæŸ¥å½•ï¼ŒæŸ¥å½•ä¹‹åï¼ŒæŒ‰ç…§è§„åˆ™ç”Ÿæˆå­—ç¬¦ä¸²ï¼ŒæŠŠç™»å½•ä¹‹åç”¨æˆ·åŒ…å«åˆ°ç”Ÿæˆå­—ç¬¦ä¸²é‡Œé¢ï¼ŒæŠŠå­—ç¬¦ä¸²è¿”å›
(1)å¯ä»¥æŠŠå­—ç¬¦ä¸²é€šè¿‡cookieè¿”å›
(2)æŠŠå­—ç¬¦ä¸²é€šè¿‡åœ°å€æ è¿”å›
2ã€å†å»è®¿é—®é¡¹ç›®å…¶ä»–æ¨¡å—ï¼Œæ¯æ¬¡è®¿é—®åœ¨åœ°å€æ å¸¦ç€ç”Ÿæˆå­—ç¬¦ä¸²ï¼Œåœ¨è®¿é—®æ¨¡å—é‡Œé¢è·å–åœ°å€æ å­—ç¬¦ä¸²,æ ¹æ®å­—ç¬¦ä¸²è·å–ç”¨æˆ·ä¿¡æ¯ã€‚å¦‚ä½•å¯ä»¥è·å–åˆ°ï¼Œå°±æ˜¯ç™»å½•
```



### JWTå®ç°TokenéªŒè¯

å‚è€ƒï¼š[JWT](https://www.jianshu.com/p/e88d3f8151db)   [JWTå¸¸è§é—®é¢˜](https://blog.csdn.net/u013089490/article/details/84443667)  [JWTé¢è¯•](https://blog.csdn.net/MINGJU2020/article/details/103039418?depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1&utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromBaidu-1)  Tokenç†è§£

```
1.è°ƒç”¨ç™»å½•æ¥å£è¿”å›token
2.å‰ç«¯æŠŠtokenæ”¾å…¥cookieä¸­(ä½¿ç”¨æ’ä»¶cnpm install js-cookie)
3.åˆ›å»ºå‰ç«¯æ‹¦æˆªå™¨ï¼Œåˆ¤æ–­cookieé‡Œé¢æ˜¯å¦æœ‰tokenå­—ç¬¦ä¸²ï¼Œå¦‚æœæœ‰æŠŠtokenå­—ç¬¦ä¸²æ”¾å…¥header(è¯·æ±‚å¤´ä¸­)
4.æ ¹æ®tokenå€¼ï¼Œè°ƒç”¨æ¥å£æ ¹æ®tokenè·å–ç”¨æˆ·ä¿¡æ¯ï¼Œä¸ºäº†é¦–é¡µæ˜¾ç¤ºï¼ŒæŠŠè¿”å›ç”¨æˆ·ä¿¡æ¯æ”¾å…¥cookieä¸­
5.é¦–é¡µé¢æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯ï¼Œä»cookieä¸­è·å–

jwtç”Ÿæˆçš„tokenæ¯æ¬¡è¯·æ±‚è¦æºå¸¦ä¸Š,åå°è§£ætokenå°±èƒ½è·å–åˆ°å¸å·ä¿¡æ¯
èƒ½å¾ˆå¥½è§£å†³åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸è§çš„sessionä¸åŒæ­¥å¤±æ•ˆçš„é—®é¢˜,å†…å®¹å¯ä»¥è‡ªå·±å®šä¹‰
æˆ‘ä»¬ç”¨jwté‡Œæ—¶å­˜çš„æ˜¯åŸºæœ¬ä¿¡æ¯,JSONæ ¼å¼,åªå­˜äº†ç”¨æˆ·IDã€ç”¨æˆ·åã€æ˜µç§°
```



> pom.xml

```xml
<!-- JWT-->
<dependency>
    <groupId>io.jsonwebtoken</groupId>
    <artifactId>jjwt</artifactId>
    <version>0.7.0</version>
</dependency>
```



> JWTUtils

```java
package com.atguigu.commonutils;

import io.jsonwebtoken.Claims;
import io.jsonwebtoken.Jws;
import io.jsonwebtoken.Jwts;
import io.jsonwebtoken.SignatureAlgorithm;
import org.springframework.http.server.reactive.ServerHttpRequest;
import org.springframework.util.StringUtils;

import javax.servlet.http.HttpServletRequest;
import java.util.Date;

public class JwtUtils {
    //å¸¸é‡
    public static final long EXPIRE = 1000 * 60 * 60 * 24; //tokenè¿‡æœŸæ—¶é—´
    public static final String APP_SECRET = "ukc8BDbRigUDaY6pZFfWus2jZWLPHO"; //ç§˜é’¥

    //ç”Ÿæˆtokenå­—ç¬¦ä¸²çš„æ–¹æ³•
    public static String getJwtToken(String id, String nickname){
        String JwtToken = Jwts.builder()
                .setHeaderParam("typ", "JWT")
                .setHeaderParam("alg", "HS256")

                .setSubject("guli-user")
            	//ä»ä»€ä¹ˆæ—¶é—´è®¡ç®—
                .setIssuedAt(new Date())
            	//è¿‡æœŸæ—¶é—´
                .setExpiration(new Date(System.currentTimeMillis() + EXPIRE))
				
            	//è®¾ç½®tokenä¸»ä½“éƒ¨åˆ† ï¼Œå­˜å‚¨ç”¨æˆ·ä¿¡æ¯
                .claim("id", id)  
                .claim("nickname", nickname)

                .signWith(SignatureAlgorithm.HS256, APP_SECRET)
                .compact();

        return JwtToken;
    }

    /**
     * åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ä¸æœ‰æ•ˆ
     * @param jwtToken
     * @return
     */
    public static boolean checkToken(String jwtToken) {
        if(StringUtils.isEmpty(jwtToken)) return false;
        try {
            Jwts.parser().setSigningKey(APP_SECRET).parseClaimsJws(jwtToken);
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        return true;
    }

    /**
     * åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ä¸æœ‰æ•ˆ
     * @param request
     * @return
     */
    public static boolean checkToken(HttpServletRequest request) {
        try {
            String jwtToken = request.getHeader("token");
            if(StringUtils.isEmpty(jwtToken)) return false;
            Jwts.parser().setSigningKey(APP_SECRET).parseClaimsJws(jwtToken);
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
        return true;
    }

    /**
     * æ ¹æ®tokenå­—ç¬¦ä¸²è·å–ä¼šå‘˜id
     * @param request
     * @return
     */
    public static String getMemberIdByJwtToken(HttpServletRequest request) {
        String jwtToken = request.getHeader("token");
        if(StringUtils.isEmpty(jwtToken)) return "";
        Jws<Claims> claimsJws = Jwts.parser().setSigningKey(APP_SECRET).parseClaimsJws(jwtToken);
        Claims claims = claimsJws.getBody();
        return (String)claims.get("id");
    }
}
```



### Vue

æ¡†æ¶ï¼šnuxtã€elementã€antã€vant

> è¿‡æ»¤å™¨ï¼š

```js
{{new Date() || formatDate('yyyy-MM-dd HH:mm:ss')}}

Vue.filter('formatDate'),function(value,format='yyyy-MM-dd'){
	//format='yyyy-MM-dd' es6å†™æ³•ï¼Œé»˜è®¤å€¼ yyyy-MM-dd
    return '';
}
```



> ç»Ÿè®¡ï¼š

```js
let items = [1,2,3,4,5];
return this.items.reduce((preTotal,item) => preTotal+item ,0)
```



> å†…ç½®æŒ‡ä»¤ï¼š

è¿™äº›æŒ‡ä»¤è§£æåï¼ŒæŸ¥çœ‹HTMLå°±ä¼šæ¶ˆå¤±ï¼Œv-cloakå°±æ˜¯åˆ©ç”¨è¿™ä¸€ç‚¹é˜²æ­¢é—ªç°

```txt
v:text		æ›´æ–°å…ƒç´ çš„testContent
v-html		æ›´æ–°å…ƒç´ çš„innerHTML
v-if		å¦‚æœä¸ºtrue,å½“å‰æ ‡ç­¾æ‰ä¼šè¾“å‡ºåˆ°é¡µé¢
v-else 		å¦‚æœä¸ºfalse,å½“å‰æ ‡ç­¾æ‰ä¼šè¾“å‡ºåˆ°é¡µé¢
v-show		é€šè¿‡æ§åˆ¶displayæ ·å¼æ¥æ§åˆ¶æ˜¾ç¤º/éšè—
v-for		éå†æ•°ç»„/å¯¹è±¡
v-on		ç»‘å®šé‚£ä¸ªäº‹ä»¶,ä¸€èˆ¬ç®€å†™ä¸º@
v-bind		å¼ºåˆ¶ç»‘å®šè§£æè¡¨è¾¾å¼,ä¸€èˆ¬ç®€å†™ä¸º:
v-model		æ “é¦™æ¸¯iæ˜‚æ•°æ®ç»‘å®š
ref			ä¸ºæŸä¸ªå…ƒç´ æ³¨å†Œä¸€ä¸ªå”¯ä¸€è¡¨ç¤º,vueç‹¬äº«é€šè¿‡$relså±æ€§è®¿é—®è¿™ä¸ªå…ƒç´ å¯¹è±¡
v-cloak		ä½¿ç”¨å®ƒé˜²æ­¢é—ªç°è¡¨è¾¾å¼,ä¸cssé…åˆ:[v-cloak]{display:none}
```



> å®šä¹‰æŒ‡ä»¤ï¼š

å…¨å±€æŒ‡ä»¤

```js
<p v-upper-text="'Just do It'"></p>

Vue.directive('upper-text',function(el,binding){
    console.log(el,binding);
    el.textContent = binding.value.toUpperCase();
})
```

å±€éƒ¨æŒ‡ä»¤

```js
<p v-lower-text="msg">Just do It</p>

new Vue({
    el:"#app",
    data:{
       msg:"Just like this"
    },
    directives:{
    	'lower-text':function(el,binding){
        	el.textContent = binding.value.toLowerCase();
            //æ–‡æœ¬å†…å®¹å˜æˆå°å†™ï¼Œä»…ä»…æ˜¯æ–‡æœ¬å†…å®¹ï¼Œmsgå˜é‡å†…å®¹ä¸å˜
    	}
    }
})
```



> ç»‘å®šç›‘å¬ï¼š

```js
<button @click="test1()>test1</button>
<button @click="test2('123')">test2</button>
<button @click="test2('123',$event)">test2</button>

new Vue({
    el:"#app",
    data:{
        test1(event){
            alert(event.target.innerHTML);//è¾“å‡ºtest1
        },
        test2(content){
            alert(content);//è¾“å‡º123
        },
        test1(content,event){
            alert(content);//è¾“å‡º123
            alert(event.target.innerHTML);//è¾“å‡ºtest
        }
    }
})
```



> æ—¶é—´ä¿®é¥°ç¬¦ï¼š

```html
<!-- é˜»æ­¢å•å‡»äº‹ä»¶å†’æ³¡ -->
<a @click.stop="doThis"></a>

<!-- æäº¤äº‹ä»¶ä¸å†é‡è½½é¡µé¢ï¼Œé˜»æ­¢äº‹ä»¶é»˜è®¤è¡Œä¸º -->
<form @submit.prevent="onSubmit"></form>

<!-- ä¿®é¥°ç¬¦å¯ä»¥ä¸²è”  -->
<a @click.stop.prevent="doThat"></a>

<!-- åªå½“äº‹ä»¶åœ¨è¯¥å…ƒç´ æœ¬èº«ï¼ˆè€Œä¸æ˜¯å­å…ƒç´ ï¼‰è§¦å‘æ—¶è§¦å‘å›è°ƒ -->
<div @click.self="doThat">...</div>

<!-- click äº‹ä»¶åªèƒ½ç‚¹å‡»ä¸€æ¬¡ï¼Œ2.1.4ç‰ˆæœ¬æ–°å¢ -->
<a @click.once="doThis"></a>
```



> æŒ‰é”®ä¿®é¥°ç¬¦ï¼š

```html
<input @keyup.enter="submit">
<input @keyup.delete (æ•è· "åˆ é™¤" å’Œ "é€€æ ¼" é”®)="submit">
```



> è‡ªå®šä¹‰äº‹ä»¶ï¼š

```js
1.ç»‘å®šäº‹ä»¶
<TodoHeader @addTodo="addTodo" ref='header'/>
<!-- å£°æ˜refï¼Œå†jsä¸­èƒ½è°ƒç”¨è¯¥ç»„ä»¶ï¼Œthis.$refs.header -->

2.è§¦å‘äº‹ä»¶
const data {
    name:'_Cps',
    check:true
};
this.$emit('addTodo',data);
```



> æ’ä»¶ï¼š

```js
/*********Begin-MyPlugin.js*********/
(function (window) {
      const MyPlugin = {}
      MyPlugin.install = function (Vue, options) {
        // 1. æ·»åŠ å…¨å±€æ–¹æ³•æˆ–å±æ€§
        Vue.myGlobalMethod = function () {
          console.log('Vueå‡½æ•°å¯¹è±¡çš„myGlobalMethod()')
        }

        // 2. æ·»åŠ å…¨å±€èµ„æº
        Vue.directive('my-directive',function (el, binding) {
          el.textContent = 'my-directive----'+binding.value
        })

        // 4. æ·»åŠ å®ä¾‹æ–¹æ³•
        Vue.prototype.$myMethod = function () {
          console.log('vm $myMethod()')
        }
      }
      //å‘å¤–æš´éœ²
      window.MyPlugin = MyPlugin
})(window)
/*********End-MyPlugin.js*********/

<div id="test">
  <p v-my-directive="msg"></p>
</div>

<script type="text/javascript" src="../js/vue.js"></script>
<script type="text/javascript" src="vue-myPlugin.js"></script>
<script type="text/javascript">
  Vue.use(MyPlugin) // å£°æ˜ä½¿ç”¨æ’ä»¶,å†…éƒ¨ä¼šè°ƒç”¨æ’ä»¶å¯¹è±¡çš„install()
  const vm = new Vue({
    el: '#test',
    data: {
      msg: 'HaHa'
    }
  });
  Vue.myGlobalMethod();
  vm.$myMethod();
</script>
```



ç”Ÿå‘½å‘¨æœŸï¼š

```
1.beforeCreate
	æ•°æ®æ¨¡å‹æœªåŠ è½½
	æ–¹æ³•æœªåŠ è½½
	htmlæ¨¡æ¿æœªåŠ è½½

2.created
	æ•°æ®æ¨¡å‹å·²åŠ è½½
    æ–¹æ³•å·²åŠ è½½
    htmlæ¨¡æ¿å·²åŠ è½½(å¯ä»¥è·å–åˆ°)
    htmlæ¨¡æ¿æœªæ¸²æŸ“(è·å–çš„æ˜¯{{num}})

3.beforeMount
	htmlæ¨¡æ¿æœªæ¸²æŸ“

4.mounted
	htmlå·²æ¸²æŸ“

5.beforeUpdate
	æ•°æ®æ¨¡å‹å·²æ›´æ–°
	htmlæ¨¡æ¿æœªæ›´æ–°

6.update
	æ•°æ®æ¨¡å‹å·²æ›´æ–°
	htmlæ¨¡æ¿å·²æ›´æ–°
    	
```

![](image\Vueç”Ÿå‘½å‘¨æœŸ.png)



```js
new Vue({
    el:"#app",
    data:{
        isShow = true;
    },
    mounted(){//åˆå§‹åŒ–æ˜¾ç¤ºä¹‹åç«‹å³è°ƒç”¨
        this.intervalId = setInterval(
        	consolot.log('-------');
        	this.isShow = !this.isShow
        ),1000)
    },
    beforeDestory(){//æ­»äº¡ä¹‹å‰è°ƒç”¨
        //æ¸…é™¤å®šæ—¶å™¨
        clearInterval(this.intervalId);//è¿™é‡Œèƒ½è°ƒåˆ°intervarIdï¼Œåªå› ä¸ºåˆå§‹åŒ–ç»™äº†vueå®ä¾‹
    }
})
```



> Vueç»„ä»¶åŒ–ç¼–ç 

1. æ‹†åˆ†ç»„ä»¶
2. é™æ€ç»„ä»¶
3. åŠ¨æ€ç»„ä»¶ï¼ˆåˆå§‹åŒ–æ˜¾ç¤ºã€äº¤äº’ï¼‰



æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒ

ç»„ä»¶è¿›è¡Œé€šä¿¡ï¼Œæ²¡æœ‰ä»»ä½•ä½ç½®çš„é™åˆ¶ï¼Œå°±ä¸ç”¨ç»„ä»¶é—´ä¼ é€’æ•°æ®äº†

```js
cnpm install  --save pubsub-js

import PubSub from pubsub-js

//è®¢é˜…æ¶ˆæ¯
PubSub.subscribe('deleteTodo',function(msg,data){
    //è¿™é‡Œé¢çš„thiså°±ä¸æ˜¯ä»£è¡¨vueç»„ä»¶äº†å¯ä»¥è¿™æ ·å†™ä¸‹é¢
})

//å‘å¸ƒæ¶ˆæ¯
PubSub.publish('deleteTodo',param)

---------------------------------------------------------------------------------------

//è®¢é˜…æ¶ˆæ¯
PubSub.subscribe('deleteTodo',(msg,data) => {
	//è¿™é‡Œçš„thiså°±å¯ä»¥ä»£è¡¨vueç»„ä»¶ï¼Œè¿™ä¸ªå‡½æ•°æ²¡æœ‰è‡ªå·±çš„thisï¼Œå°±ä¼šä½¿ç”¨å¤–éƒ¨çš„this
})

//å‘å¸ƒæ¶ˆæ¯
PubSub.publish('deleteTodo',(msg,data) => {
    //å…¶ä»–çŸ¥è¯†ï¼Œå¦‚æœæ˜¯è¦è¿”å›å¯¹è±¡çš„è¯,è¿™æ ·å†™ => ({
    //
	//})
})

```

> slot

æ­¤æ–¹å¼ç”¨äºçˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’`æ ‡ç­¾æ•°æ®`

```js
//å­ç»„ä»¶
<template>
	<div>
        <slotname="xxx">ä¸ç¡®å®šçš„æ ‡ç­¾ç»“æ„ 1</slot>
        <div>ç»„ä»¶ç¡®å®šçš„æ ‡ç­¾ç»“æ„</div>
        <slotname="yyy">ä¸ç¡®å®šçš„æ ‡ç­¾ç»“æ„ 2</slot>
	</div>
</template>

//çˆ¶ç»„ä»¶
<div>
    <divslot="xxx">xxx å¯¹åº”çš„æ ‡ç­¾ç»“æ„</div>
    <divslot="yyy">yyyy å¯¹åº”çš„æ ‡ç­¾ç»“æ„</div>
</div>
```



> è·¯ç”±å‚æ•°

```js
1ã€æ‰‹å†™å®Œæ•´çš„ path:
 
    this.$router.push({path: `/user/${userId}`});
 
    //è·å–å‚æ•°ï¼šthis.$route.params.userId
 
2ã€ç”¨ params ä¼ é€’ï¼š
 
    this.$router.push({name:'user', params:{userId: '123'}});
 
    //è·å–å‚æ•°ï¼šthis.$route.params.userId
    //url å½¢å¼ï¼šurl ä¸å¸¦å‚æ•°ï¼Œhttp:localhost:8080/#/user
 
3ã€ç”¨ query ä¼ é€’ï¼š
 
    this.$router.push({path:'/user', query:{userId: '123'}});
 
    //è·å–å‚æ•°ï¼šthis.$route.query.userId
    //url å½¢å¼ï¼šurl å¸¦å‚æ•°ï¼Œhttp:localhost:8080/#/user?userId=123

/**
    this.$router.push({path:'/user', params:{userId}});  //->/user
    //è¿™é‡Œçš„ params ä¸ç”Ÿæ•ˆ,å¦‚æœæä¾›äº† pathï¼Œåˆ™params ä¼šè¢«å¿½ç•¥
    
    query  ç›¸å½“äº get è¯·æ±‚ï¼Œé¡µé¢è·³è½¬çš„æ—¶å€™å¯ä»¥åœ¨åœ°å€æ çœ‹åˆ°è¯·æ±‚å‚æ•°ï¼Œ
    params ç›¸å½“äº post è¯·æ±‚ï¼Œå‚æ•°ä¸åœ¨åœ°å€æ ä¸­æ˜¾ç¤ºã€‚
    è¦æ³¨æ„ï¼Œä»¥ / å¼€å¤´çš„åµŒå¥—è·¯å¾„ä¼šè¢«å½“ä½œæ ¹è·¯å¾„ã€‚ è¿™è®©ä½ å……åˆ†çš„ä½¿ç”¨åµŒå¥—ç»„ä»¶è€Œæ— é¡»è®¾ç½®åµŒå¥—çš„è·¯å¾„ã€‚
*/
```



> è·¯ç”±ç›‘å¬

```
//ç›‘å¬
watch:{
	//è·¯ç”±å˜åŒ–å‘ç”Ÿå˜åŒ–ï¼Œåˆ™ä¼šæ‰§è¡Œè¯¥ä»£ç å—
	$router(to,from){
		//åŒä¸€ä¸ªç»„ä»¶ç‚¹å‡»ä¸¤æ¬¡ï¼Œä¸ä¼šå†æ¬¡æ‰§è¡Œcreatedæ–¹æ³•ï¼Œæ‰€ä»¥æœ‰æ—¶å€™éœ€æ±‚å¯èƒ½è¦è¿›è¡Œä¸€äº›å¤„ç†ã€‚
	}
}
```



> Ajaxè¯·æ±‚

ä¸€ã€vue-resourceæ¨¡å—

```js
//åœ¨é¡¹ç›®ä¸­å®‰è£…
cnpm install vue-resource --save

// å¼•å…¥æ¨¡å— 
importVueResourcefrom'vue-resource' 
// ä½¿ç”¨æ’ä»¶ 
Vue.use(VueResource)
// é€šè¿‡ vue/ç»„ä»¶å¯¹è±¡å‘é€ ajax è¯·æ±‚ 
this.$http.get('/someUrl').then((response)=>{ //successcallback 
    console.log(response.data)//è¿”å›ç»“æœæ•°æ®
},(response)=>{ //errorcallback
    console.log(response.statusText)//é”™è¯¯ä¿¡æ¯
})
```

äºŒã€axiosæ¨¡å—

```js
//åœ¨é¡¹ç›®ä¸­å®‰è£…
cnpm install axios --save

// å¼•å…¥æ¨¡å— 
import axios from 'axios'

// å‘é€ ajax è¯·æ±‚ 
axios.get(url) .then(response=>{ 
    console.log(response.data)// å¾—åˆ°è¿”å›ç»“æœæ•°æ® 
}) .catch(error=>{ 
    console.log(error.message)//é”™è¯¯ä¿¡æ¯
})
```



> Vue + Axios å¯¼å…¥Excel

```js
import reqwest from 'reqwest'

//çœŸæ­£çš„å¯¼å…¥
handleOkImport(e) {
    let _this = this;
    const { fileList } = this;
    const formData = new FormData();
    if(fileList.length==0){
        this.$message.warning('è¯·é€‰æ‹©æ–‡ä»¶!');
    }else{
        fileList.forEach((file) => {
            formData.append('file', file);
        });
        //console.log("fileList:"+fileList[0]);
        reqwest({
            url: _this.apiUrl+'importAttendance/importExcel',
            method: 'post',
            processData: false,
            data: formData,
            success: (result) => {
                if(result.code=='200'){
                    this.fileList = []
                    this.uploading = false
                    this.$message.success('å¯¼å…¥æˆåŠŸ!');
                    this.visibleImport = false;
                }else{
                    this.uploading = false
                    this.$message.error(result.message);
                }
                this.getLogList();
            },
            error: () => {
                this.uploading = false
                this.$message.error('å¯¼å…¥å¤±è´¥!');
            },
        });
    }

},
```



> Vue + Ant å…¼å®¹IEæµè§ˆå™¨

å‚è€ƒï¼š[å…¼å®¹æ€§](https://blog.csdn.net/lydxwj/article/details/89912983)

babel.config.js`æ–‡ä»¶

```js
module.exports = {
  presets: [
    '@vue/app',
    // å…¼å®¹é…ç½®
    [
      '@babel/preset-env',
      {
        'useBuiltIns': 'entry'
      }
    ]
  ],
  // æŒ‰éœ€åŠ è½½é…ç½®
  plugins: [
    [
      'import',
      {
        libraryName: 'ant-design-vue',
        libraryDirectory: 'es',
        style: 'css'
      },
    ]
  ]
}
```



`main.js`æ–‡ä»¶ï¼ˆé¡¹ç›®å…¥å£ï¼‰

```js
// å¼•å…¥@babel/polyfillå¤„ç†å…¼å®¹ 
import '@babel/polyfill'

import Vue from 'vue'
import App from './App.vue'
import router from './router/router'
import store from './store/store'
import './plugins/antd.js'
new Vue({
  router,
  store,
  render: h => h(App)
}).$mount('#app')
```



é˜²æ­¢æ•°æ®è¯»å–ç¼“å­˜

å‚è€ƒï¼š[é˜²æ­¢æ•°æ®è¯»å–ç¼“å­˜](https://blog.csdn.net/weixin_38659265/article/details/90265999)

![](image\è§£å†³IEæ€»æ˜¯è¯»å–ç¼“å­˜.png)

```js
//æˆ‘ä»¬å¯ä»¥åœ¨å°è£…axiosæ—¶ï¼Œé»˜è®¤ç»™è¯·æ±‚åŠ ä¸Šæ—¶é—´æˆ³ï¼Œä¸‹é¢æ˜¯ç»™getå’Œpostè¯·æ±‚é»˜è®¤æ·»åŠ æ—¶é—´æˆ³ï¼š
// æ·»åŠ æ—¶é—´æˆ³       
 if (config.method === 'post') {            
 	config.data = {                
 		...config.data,                
 		t: Date.parse(new Date()) / 1000           
 	}       
 } else if (config.method === 'get') {          
 	 config.params = {               
 	 	 t: Date.parse(new Date()) / 1000,               
 	 	...config.params            
 	}       
 }
```



IEè·¯ç”±é¡µé¢è·¯ç”± ä¸åˆ·æ–°é—®é¢˜ï¼Œåœ¨App.vueé¡µé¢

```js
mounted() {
    if (!!window.ActiveXObject || "ActiveXObject" in window) {
      window.addEventListener(
        "hashchange",
        () => {
          let currentPath = window.location.hash.slice(1);
          if (this.$route.path !== currentPath) {
            this.$router.push(currentPath);
          }
        },
        false
      );
    }
}
```





`router.js`ï¼Œè¦è€ƒè™‘ï¼ŒIEè·¯ç”±é—®é¢˜ï¼ŒIEçš„URLå¦‚æœåŠ  ''#'' å·ï¼Œé¡µé¢åˆ™ä¸ä¼šåˆ·æ–°ï¼Œæ‰€ä»¥è¦æƒ³åŠæ³•å»æ‰è·¯ç”±ä¸­çš„ ''#'' å·

```js
export default new Router({
  mode : "history",	//è¯¥å±æ€§å¯ä»¥å»æ‰ #
  routes: [ 
    {
      path: '/admin',
      component: admin
    },{
      path: '/home',
      component: home
    }
  ]
})
```



å¦‚æœå»æ‰äº†#å·ï¼ŒVueæ‰“åŒ…è¿‡åæ‰¾ä¸åˆ°é¡µé¢è§£å†³åŠæ³•

å‚è€ƒï¼š[é¡µé¢æ‰¾ä¸åˆ°](https://blog.csdn.net/IsITMan/article/details/85121729)

```

```



> Vue + Ant ä¸­æ–‡å›½é™…åŒ–é…ç½®

```vue
<template>
  <a-locale-provider :locale="locale">
    <router-view/>
  </a-locale-provider>
</template>

<script>

import zhCN from "ant-design-vue/lib/locale-provider/zh_CN";
export default {
  data() {
    return {
      locale: zhCN
    };
  }
}
```



> Vue + Ant è¡¨æ ¼åˆ†é¡µ

å‚è€ƒï¼š[è¡¨æ ¼åˆ†é¡µ](https://www.cnblogs.com/zhaogaojian/p/11162280.html)

1ã€è®¾ç½®pagination

```html
 <a-table :columns="columns" :dataSource="data" :rowSelection="rowSelection" 	:pagination="pagination">
     <a slot="action" href="javascript:;">æŸ¥çœ‹</a>
  </a-table>
```

2ã€è‡ªå®šä¹‰paginationï¼Œæ³¨æ„å†™æˆonChange,changeä¸è¡Œï¼Œç°è‰²éƒ¨åˆ†è¯·æ ¹æ®è‡ªå·±å®é™…ä»£ç ä¿®æ”¹ã€‚

```js
data () {
    let _this = this;
    return {
      collapsed: false,
      data,
      sels,
      columns,
      rowSelection,
      pagination: {
        pageNo: 1,
        pageSize: 20, // é»˜è®¤æ¯é¡µæ˜¾ç¤ºæ•°é‡
        showSizeChanger: true, // æ˜¾ç¤ºå¯æ”¹å˜æ¯é¡µæ•°é‡
        pageSizeOptions: ['10', '20', '50', '100'], // æ¯é¡µæ•°é‡é€‰é¡¹
        showTotal: total => `Total ${total} items`, // æ˜¾ç¤ºæ€»æ•°
        onShowSizeChange: (pageNo, pageSize) => _this.changePage(1,pageSize),
        onChange:(pageNo,pageSize)=>_this.changePage(pageNo,pageSize),//ç‚¹å‡»é¡µç äº‹ä»¶
        total:0 //æ€»æ¡æ•°
       }
    }
  },
```

3ã€Ajaxè¯»å–æ•°æ®åˆ—è¡¨æ—¶pagination.totalèµ‹æ€»æ¡æ•°å³å¯

```js
.then((response) => {
    that.data = response.data.items
    that.pagination.total=response.data.total
    console.log(response)
})
```

4ã€å®šä¹‰æ”¹å˜é¡µç äº‹ä»¶

```js
changePage(pageNo,pageSize){
    that.pagination.pageNo = pageNo;
    that.pagination.pageSize = pageSize;
    searchUser();//è¯·æ±‚æ•°æ®
}
```

5ã€è¯»å–æ•°æ®æ—¶å¸¦ä¸Šå½“å‰é¡µã€åˆ†é¡µå¤§å°ï¼Œè¿‡æ»¤æ¡ä»¶ï¼Œåç«¯ä»£ç å¯ä»¥ç®€å•ä½¿ç”¨é€šç”¨åˆ†é¡µæ–¹æ³•è¿”å›Jsonæ•°æ®å³å¯ï¼Œ

```js
searchUser () {
    let param= {pageNo:this.pagination.pageNo,pageSize:this.pagination.pageSize};
    this.getUser(param);
},
```



> Vue ç»„ä»¶æ•°æ®åŒå‘ç»‘å®š

å‚è€ƒï¼š[åŒå‘ç»‘å®š](https://blog.csdn.net/w390058785/article/details/81076569)

```js
<body>
<script src="https://cdn.bootcss.com/vue/2.5.16/vue.js"></script>
<div id="box">
    <new-input v-bind:name.sync="name"></new-input>
    {{name}}
</div>
<script>
	Vue.component('new-input',{
        props: ['name'],
        data: function(){
            return {
                newName: this.name
            }	
        },
        template:'<label><input @keyup="changeName" v-model="newName" />ä½ çš„åå­—</label>',
        methods: {
            changeName: function(){
                this.$emit('update:name',this.newName);
            }
        }	
    });
    new Vue({
        el:'#box',	
        data: {
        	name:'nick'		
        }
    });
</script>
</body>

/* ------------------------------------------------------------------------------- */
/*
	é€šè¿‡ä¸æ–¹æ³•ä¸€è¿›è¡Œæ¯”è¾ƒï¼šä¼šå‘ç°

    <new-input v-bind:name="name" v-on:update:name="name = $event"></new-input>

    è¢«ç®€åŒ–æˆäº†

    <new-input v-bind:name.sync="name"></new-input>

    è€Œå…¶ä»–ä»£ç ä¸å˜ã€‚

    æ‰€ä»¥æˆ‘ä»¬åœ¨ä½¿ç”¨.syncä¿®é¥°ç¬¦çš„æ—¶å€™ï¼Œåªéœ€è¦æ³¨æ„ï¼Œv-bind:xxï¼Œv-on:update:xxï¼Œv-bind:xx.syncçš„å·®å¼‚å°±è¡Œäº†ã€‚

    è€Œä¸”æ³¨å†Œäº‹ä»¶çš„æ—¶å€™ä¸€å®šè¦ç”¨this.$emit( 'update:xx' );

*/

```



### å¾®ä¿¡æ”¯ä»˜æ¥å£

é€šä¿—æ¥è®²ï¼Œæˆ‘ä»¬å°±æ˜¯è¦å’Œå¾®ä¿¡è¿›è¡Œæ‰“äº¤é“ï¼Œä½ è°ƒæˆ‘APIï¼Œæˆ‘è°ƒä½ çš„APIã€‚è¿™é‡Œå¤§ä½“æ€è·¯æ˜¯å…ˆ ç”Ÿæˆé¢„è®¢å•ï¼Œç„¶åæ”¯ä»˜å®Œæˆï¼Œä½†æ˜¯ç”Ÿæˆè®¢å•éœ€è¦ä¸€äº›å‡†å¤‡æ¡ä»¶ï¼ˆcodeã€openIdã€signç­‰ç­‰ï¼‰

1. è·å–code
2. é€šè¿‡codeè·å–openId
3. ç”Ÿæˆé¢„è®¢å•ï¼Œéœ€è¦ä¼ å¾ˆå¤šå‚æ•°ï¼ˆè¿™é‡Œçš„è·å–signç¨å¾®éº»çƒ¦äº†ä¸€ç‚¹ï¼‰ï¼Œè¿”å›ä¸è®¢å•ä¿¡æ¯ï¼Œç„¶åç”¨æˆ·ç¡®è®¤æ”¯ä»˜

```
weixin:
  pay:
    #å…³è”çš„å…¬ä¼—å·appid
    appid: wx74862e0dfcf69954
    #å•†æˆ·å·
    partner: 1558950191
    #å•†æˆ·key
    partnerkey: T6m9iK73b0kn9g5v426MKfHQH7X8rKwb
    #å›è°ƒåœ°å€
    notifyurl: http://guli.shop/api/order/weixinPay/weixinNotify
    
    
    <dependency>
        <groupId>com.github.wxpay</groupId>
        <artifactId>wxpay-sdk</artifactId>
        <version>0.0.3</version>
    </dependency>
```



>JSAPIæ”¯ä»˜

å‚è€ƒï¼š[JSAPIæ”¯ä»˜](https://www.cnblogs.com/wuer888/p/7839139.html)	 [JSAPIæ”¯ä»˜å®˜ç½‘](https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=7_1)

```
1.ç»Ÿä¸€ä¸‹å•ï¼Œå¾—åˆ°é¢„æ”¯ä»˜id
å…¶ä¸­ä¼šç”¨åˆ°å¾ˆå¤šå‚æ•°ï¼Œappid mch_id openid signè¿™äº›ï¼Œè€Œopenidå’Œsignéœ€è¦è¿›è¡Œä¸€äº›å¤„ç†æ‰èƒ½å¾—åˆ°ï¼Œ
		æŒ‰ç…§è§„å®šå°†Mapçš„å‚æ•°è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸²çš„å½¢å¼(å­—æ®µå=å­—æ®µå€¼&å­—æ®µå=å­—æ®µå€¼)å¹¶ä¸”è¿›è¡Œå­—æ®µåå­—å…¸æ’åº
		å…¶å®æˆ‘ä»¬æœ€ç»ˆä¸‹å•çš„å‚æ•°æ˜¯ä¸€ä¸ªxmlçš„Stringç±»å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦æŠŠé‚£äº›å‚æ•°æ”¾å…¥Mapä¸­è½¬æ¢æˆxml
```

```
2.ç»„è£…è°ƒèµ·æ”¯ä»˜çš„å‚æ•°
è¿™ä¸ªæ­¥éª¤å…¶å®å°±æ˜¯å°è£…å‚æ•°ï¼Œé¢„æ”¯ä»˜idã€å…¶ä»–çš„é…ç½®ä¿¡æ¯signç­¾åç”Ÿæˆè¯·æ±‚æ•°æ®
```

```
3.è°ƒèµ·æ”¯ä»˜
ä½¿ç”¨jssdkæˆ–è€…h5æ¥å£è°ƒèµ·æ”¯ä»˜è¿›è¡Œæ”¯ä»˜ï¼Œæ ¹æ®æ”¯ä»˜ç»“æœå†è¿›è¡Œç›¸å¯¹åº”çš„æ“ä½œ
```





```js
//JSæ‹‰å–æ”¯ä»˜
function onBridgeReady(){
   WeixinJSBridge.invoke(
      'getBrandWCPayRequest', {
         "appId":"wx2421b1c4370ec43b",     //å…¬ä¼—å·åç§°ï¼Œç”±å•†æˆ·ä¼ å…¥     
         "timeStamp":"1395712654",         //æ—¶é—´æˆ³ï¼Œè‡ª1970å¹´ä»¥æ¥çš„ç§’æ•°     
         "nonceStr":"e61463f8efa94090b1f366cccfbbb444", //éšæœºä¸²     
         "package":"prepay_id=u802345jgfjsdfgsdg888",     
         "signType":"MD5",         //å¾®ä¿¡ç­¾åæ–¹å¼ï¼š     
         "paySign":"70EA570631E4BB79628FBCA90534C63FF7FADD89" //å¾®ä¿¡ç­¾å 
      },
      function(res){
      if(res.err_msg == "get_brand_wcpay_request:ok" ){
      // ä½¿ç”¨ä»¥ä¸Šæ–¹å¼åˆ¤æ–­å‰ç«¯è¿”å›,å¾®ä¿¡å›¢é˜Ÿéƒ‘é‡æç¤ºï¼š
            //res.err_msgå°†åœ¨ç”¨æˆ·æ”¯ä»˜æˆåŠŸåè¿”å›okï¼Œä½†å¹¶ä¸ä¿è¯å®ƒç»å¯¹å¯é ã€‚
      } 
   }); 
}
if (typeof WeixinJSBridge == "undefined"){
   if( document.addEventListener ){
       document.addEventListener('WeixinJSBridgeReady', onBridgeReady, false);
   }else if (document.attachEvent){
       document.attachEvent('WeixinJSBridgeReady', onBridgeReady); 
       document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
   }
}else{
   onBridgeReady();
}



//å¾®ä¿¡å°ç¨‹åº
wx.chooseWXPay({
    timestamp: 0, // æ”¯ä»˜ç­¾åæ—¶é—´æˆ³ï¼Œæ³¨æ„å¾®ä¿¡jssdkä¸­çš„æ‰€æœ‰ä½¿ç”¨timestampå­—æ®µå‡ä¸ºå°å†™ã€‚ä½†æœ€æ–°ç‰ˆçš„æ”¯ä»˜åå°ç”Ÿæˆç­¾åä½¿ç”¨çš„timeStampå­—æ®µåéœ€å¤§å†™å…¶ä¸­çš„Så­—ç¬¦
    nonceStr: '', // æ”¯ä»˜ç­¾åéšæœºä¸²ï¼Œä¸é•¿äº 32 ä½
    package: '', // ç»Ÿä¸€æ”¯ä»˜æ¥å£è¿”å›çš„prepay_idå‚æ•°å€¼ï¼Œæäº¤æ ¼å¼å¦‚ï¼šprepay_id=***ï¼‰
    signType: '', // ç­¾åæ–¹å¼ï¼Œé»˜è®¤ä¸º'SHA1'ï¼Œä½¿ç”¨æ–°ç‰ˆæ”¯ä»˜éœ€ä¼ å…¥'MD5'
    paySign: '', // æ”¯ä»˜ç­¾å
    success: function (res) {
        // æ”¯ä»˜æˆåŠŸåçš„å›è°ƒå‡½æ•°
    }
});
```



> Nativeæ”¯ä»˜

å‚è€ƒï¼š[Nativeæ”¯ä»˜](<https://pay.weixin.qq.com/wiki/doc/api/native.php?chapter=9_1>)

1. ä½¿ç”¨åœºæ™¯ï¼šç”¨æˆ·æ‰«æå•†æˆ·å±•ç¤ºåœ¨å„ç§åœºæ™¯çš„äºŒç»´ç è¿›è¡Œæ”¯ä»˜ã€‚

2. Nativeæ”¯ä»˜æµç¨‹ï¼šä¹Ÿç§°ä¹‹ä¸ºæ‰«ç æ”¯ä»˜ï¼Œæ˜¯æ”¯ä»˜æŒ‡å®šçš„å•†å“ï¼Œæ‰€ä»¥ä¸éœ€è¦ç”¨æˆ·é€‰æ‹©å•†å“ï¼Œå®¢æˆ·ç«¯ç›´æ¥å‡†å¤‡å¥½æ‰€æœ‰çš„è®¢å•ä¿¡æ¯ï¼Œç›´æ¥è°ƒç”¨å¾®ä¿¡ä¸‹å•APIç”Ÿæˆé¢„è®¢å•ï¼ŒåŒæ—¶æ¥å—å¾®ä¿¡è¿”å›çš„code_urlï¼Œç”ŸæˆäºŒç»´ç ç»™ç”¨æˆ·ã€‚ç”¨æˆ·æ‰«ç é“¾æ¥ï¼Œå¾®ä¿¡ä¼šéªŒè¯è¯¥é“¾æ¥æœ‰æ•ˆæ€§ï¼Œæ»¡è¶³çš„è¯è¿”å›æ”¯ä»˜æˆæƒï¼Œä¹Ÿå°±æ˜¯æ‹‰èµ·æ”¯ä»˜ï¼Œè¾“å…¥å¯†ç è¿‡åï¼Œæäº¤æˆæƒç›´æ¥åˆ°å¾®ä¿¡ï¼Œå¾®ä¿¡ä¼šç»™äºˆæ”¯ä»˜çš„ç»“æœï¼ŒåŒæ—¶ä¹Ÿä¼šå¼‚æ­¥é€šçŸ¥å®¢æˆ·ç«¯ã€‚



```

//1 æ ¹æ®è®¢å•å·æŸ¥è¯¢è®¢å•ä¿¡æ¯
QueryWrapper<Order> wrapper = new QueryWrapper<>();
wrapper.eq("order_no",orderNo);
Order order = orderService.getOne(wrapper);

//2 ä½¿ç”¨mapè®¾ç½®ç”ŸæˆäºŒç»´ç éœ€è¦å‚æ•°
Map m = new HashMap();
m.put("appid","wx74862e0dfcf69954");
m.put("mch_id", "1558950191");
m.put("nonce_str", WXPayUtil.generateNonceStr());
m.put("body", order.getCourseTitle()); //è¯¾ç¨‹æ ‡é¢˜
m.put("out_trade_no", orderNo); //è®¢å•å·
m.put("total_fee", order.getTotalFee().multiply(new BigDecimal("100")).longValue()+"");
m.put("spbill_create_ip", "127.0.0.1");
m.put("notify_url", "http://guli.shop/api/order/weixinPay/weixinNotify\n");
m.put("trade_type", "NATIVE");

//3 å‘é€httpclientè¯·æ±‚ï¼Œä¼ é€’å‚æ•°xmlæ ¼å¼ï¼Œå¾®ä¿¡æ”¯ä»˜æä¾›çš„å›ºå®šçš„åœ°å€
HttpClient client = new HttpClient("https://api.mch.weixin.qq.com/pay/unifiedorder");
//è®¾ç½®xmlæ ¼å¼çš„å‚æ•°
client.setXmlParam(WXPayUtil.generateSignedXml(m,"T6m9iK73b0kn9g5v426MKfHQH7X8rKwb"));
client.setHttps(true);
//æ‰§è¡Œpostè¯·æ±‚å‘é€
client.post();

//4 å¾—åˆ°å‘é€è¯·æ±‚è¿”å›ç»“æœ
//è¿”å›å†…å®¹ï¼Œæ˜¯ä½¿ç”¨xmlæ ¼å¼è¿”å›
String xml = client.getContent();

//æŠŠxmlæ ¼å¼è½¬æ¢mapé›†åˆï¼ŒæŠŠmapé›†åˆè¿”å›
Map<String,String> resultMap = WXPayUtil.xmlToMap(xml);

//æœ€ç»ˆè¿”å›æ•°æ® çš„å°è£…
Map map = new HashMap();
map.put("out_trade_no", orderNo);
map.put("course_id", order.getCourseId());
map.put("total_fee", order.getTotalFee());
map.put("result_code", resultMap.get("result_code"));  //è¿”å›äºŒç»´ç æ“ä½œçŠ¶æ€ç 
map.put("code_url", resultMap.get("code_url"));        //äºŒç»´ç åœ°å€

```



### Docker

å‚è€ƒï¼š[Dockerå®‰è£…](https://www.cnblogs.com/bigben0123/p/11350200.html)



#### Dockerç®€ä»‹

> ä¸‰å¤§è¦ç´ ï¼šé•œåƒ å®¹å™¨ ä»“åº“



> é•œåƒ

```
Docker é•œåƒï¼ˆImageï¼‰å°±æ˜¯ä¸€ä¸ªåªè¯»çš„æ¨¡æ¿ã€‚é•œåƒå¯ä»¥ç”¨æ¥åˆ›å»º Docker å®¹å™¨ï¼Œä¸€ä¸ªé•œåƒå¯ä»¥åˆ›å»ºå¾ˆå¤šå®¹å™¨ã€‚
```



> å®¹å™¨

```
Â Docker åˆ©ç”¨å®¹å™¨ï¼ˆContainerï¼‰ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ã€‚å®¹å™¨æ˜¯ç”¨é•œåƒåˆ›å»ºçš„è¿è¡Œå®ä¾‹ã€‚
Â 
å®ƒå¯ä»¥è¢«å¯åŠ¨ã€å¼€å§‹ã€åœæ­¢ã€åˆ é™¤ã€‚æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç›¸äº’éš”ç¦»çš„ã€ä¿è¯å®‰å…¨çš„å¹³å°ã€‚
Â 
å¯ä»¥æŠŠå®¹å™¨çœ‹åšæ˜¯ä¸€ä¸ªç®€æ˜“ç‰ˆçš„ Linux ç¯å¢ƒï¼ˆåŒ…æ‹¬rootç”¨æˆ·æƒé™ã€è¿›ç¨‹ç©ºé—´ã€ç”¨æˆ·ç©ºé—´å’Œç½‘ç»œç©ºé—´ç­‰ï¼‰å’Œè¿è¡Œåœ¨å…¶ä¸­çš„åº”ç”¨ç¨‹åºã€‚


å®¹å™¨çš„å®šä¹‰å’Œé•œåƒå‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€å †å±‚çš„ç»Ÿä¸€è§†è§’ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äºå®¹å™¨çš„æœ€ä¸Šé¢é‚£ä¸€å±‚æ˜¯å¯è¯»å¯å†™çš„ã€‚
```



> ä»“åº“

```
Â ä»“åº“ï¼ˆRepositoryï¼‰æ˜¯é›†ä¸­å­˜æ”¾é•œåƒæ–‡ä»¶çš„åœºæ‰€ã€‚
ä»“åº“(Repository)å’Œä»“åº“æ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰æ˜¯æœ‰åŒºåˆ«çš„ã€‚ä»“åº“æ³¨å†ŒæœåŠ¡å™¨ä¸Šå¾€å¾€å­˜æ”¾ç€å¤šä¸ªä»“åº“ï¼Œæ¯ä¸ªä»“åº“ä¸­åˆåŒ…å«äº†å¤šä¸ªé•œåƒï¼Œæ¯ä¸ªé•œåƒæœ‰ä¸åŒçš„æ ‡ç­¾ï¼ˆtagï¼‰ã€‚
Â 
ä»“åº“åˆ†ä¸ºå…¬å¼€ä»“åº“ï¼ˆPublicï¼‰å’Œç§æœ‰ä»“åº“ï¼ˆPrivateï¼‰ä¸¤ç§å½¢å¼ã€‚
æœ€å¤§çš„å…¬å¼€ä»“åº“æ˜¯ Docker Hub(https://hub.docker.com/)ï¼Œ
å­˜æ”¾äº†æ•°é‡åºå¤§çš„é•œåƒä¾›ç”¨æˆ·ä¸‹è½½ã€‚å›½å†…çš„å…¬å¼€ä»“åº“åŒ…æ‹¬é˜¿é‡Œäº‘ ã€ç½‘æ˜“äº‘ ç­‰
```



> æ€»ç»“

```
éœ€è¦æ­£ç¡®çš„ç†è§£ä»“å‚¨/é•œåƒ/å®¹å™¨è¿™å‡ ä¸ªæ¦‚å¿µ:
Â 
Docker æœ¬èº«æ˜¯ä¸€ä¸ªå®¹å™¨è¿è¡Œè½½ä½“æˆ–ç§°ä¹‹ä¸ºç®¡ç†å¼•æ“ã€‚æˆ‘ä»¬æŠŠåº”ç”¨ç¨‹åºå’Œé…ç½®ä¾èµ–æ‰“åŒ…å¥½å½¢æˆä¸€ä¸ªå¯äº¤ä»˜çš„è¿è¡Œç¯å¢ƒï¼Œè¿™ä¸ªæ‰“åŒ…å¥½çš„è¿è¡Œç¯å¢ƒå°±ä¼¼ä¹ imageé•œåƒæ–‡ä»¶ã€‚åªæœ‰é€šè¿‡è¿™ä¸ªé•œåƒæ–‡ä»¶æ‰èƒ½ç”Ÿæˆ Docker å®¹å™¨ã€‚image æ–‡ä»¶å¯ä»¥çœ‹ä½œæ˜¯å®¹å™¨çš„æ¨¡æ¿ã€‚Docker æ ¹æ® image æ–‡ä»¶ç”Ÿæˆå®¹å™¨çš„å®ä¾‹ã€‚åŒä¸€ä¸ª image æ–‡ä»¶ï¼Œå¯ä»¥ç”Ÿæˆå¤šä¸ªåŒæ—¶è¿è¡Œçš„å®¹å™¨å®ä¾‹ã€‚
Â 
* Â image æ–‡ä»¶ç”Ÿæˆçš„å®¹å™¨å®ä¾‹ï¼Œæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œç§°ä¸ºé•œåƒæ–‡ä»¶ã€‚
Â 
* Â ä¸€ä¸ªå®¹å™¨è¿è¡Œä¸€ç§æœåŠ¡ï¼Œå½“æˆ‘ä»¬éœ€è¦çš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡dockerå®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„è¿è¡Œå®ä¾‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„å®¹å™¨
Â 
* è‡³äºä»“å‚¨ï¼Œå°±æ˜¯æ”¾äº†ä¸€å †é•œåƒçš„åœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé•œåƒå‘å¸ƒåˆ°ä»“å‚¨ä¸­ï¼Œéœ€è¦çš„æ—¶å€™ä»ä»“å‚¨ä¸­æ‹‰ä¸‹æ¥å°±å¯ä»¥äº†ã€‚
```



> Dockerä¸è™šæ‹Ÿæœºæ¯”è¾ƒ

```
1.Dockeræœ‰ç€æ¯”è™šæ‹Ÿæœºæ›´å°‘çš„æŠ½è±¡å±‚ï¼Œç”±äºDockerä¸éœ€è¦Hypervisorå®ç°ç¡¬ä»¶èµ„æºè™šæ‹ŸåŒ–ï¼Œè¿è¡Œåœ¨Dockerå®¹å™¨ä¸Šçš„ç¨‹åºç›´æ¥ä½¿ç”¨çš„éƒ½æ˜¯å®é™…ç‰©ç†æœºçš„ç¡¬ä»¶èµ„æºï¼Œå› æ­¤åœ¨Cpuã€å†…å­˜åˆ©ç”¨ç‡ä¸ŠDockerå°†ä¼šåœ¨æ•ˆç‡ä¸Šæœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚

2.Dockeråˆ©ç”¨çš„æ˜¯å®¿ä¸»æœºçš„å†…æ ¸ï¼Œè€Œä¸éœ€è¦Guest OS(è™šæ‹Ÿæœºå®‰è£…çš„æ“ä½œç³»ç»Ÿ)ï¼Œå› æ­¤ï¼Œå½“æ–°å»ºä¸€ä¸ªå®¹å™¨æ—¶ï¼ŒDockerä¸éœ€è¦å’Œè™šæ‹Ÿæœºä¸€æ ·é‡æ–°åŠ è½½ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼Œé¿å…äº†å¼•å¯¼ã€åŠ è½½æ“ä½œç³»ç»Ÿå†…æ ¸è¿™ä¸ªæ¯”è¾ƒè´¹æ—¶è´¹èµ„æºçš„è¿‡ç¨‹ï¼Œå½“æ–°å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ—¶ï¼Œè™šæ‹Ÿæœºè½¯ä»¶éœ€è¦åŠ è½½Guest OSï¼Œè¿™ä¸ªæ–°å»ºè¿‡ç¨‹æ˜¯åˆ†é’Ÿçº§åˆ«çš„ï¼Œè€ŒDockerç”±äºç›´æ¥åˆ©ç”¨å®¿ä¸»æœºçš„æ“ä½œç³»ç»Ÿåˆ™çœç•¥äº†è¿™ä¸ªè¿‡ç¨‹ï¼Œå› æ­¤æ–°å»ºä¸€ä¸ªDockerå®¹å™¨åªéœ€è¦å‡ ç§’é’Ÿã€‚
```

<img src="image\Dockerä¸è™šæ‹Ÿæœºæ¯”è¾ƒ.png" style="zoom: 67%;" />



#### Dockerå®‰è£…

> ä¸‹è½½Dockerä¾èµ–çš„ç¯å¢ƒ

```sh
yum -y install yum-utils device-mapper-persistent-data lvm2
```

> æŒ‡å®šDockeré•œåƒæº

```sh
yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
```

> å®‰è£…Docker

```sh
#ä¾ç„¶é‡‡ç”¨yumçš„æ–¹å¼å®‰è£…
yum makacache
yum -y install docker-ce
```

> å¯åŠ¨Dockerå¹¶æµ‹è¯•

```sh
å®‰è£…æˆåŠŸåï¼Œéœ€è¦æ‰‹åŠ¨å¯åŠ¨ï¼Œè®¾ç½®ä¸ºå¼€æœºè‡ªå¯ï¼Œå¹¶æµ‹è¯•ä¸€ä¸‹Docker

#å¯åŠ¨DockeræœåŠ¡
systemctl start docker
#è®¾ç½®å¼€æœºè‡ªåŠ¨å¯åŠ¨
systemctl enable docker
#æµ‹è¯•
docker run hello-world
```

> Dockerä¸­å¤®ä»“åº“

```sh
Dockerå®˜æ–¹çš„ä¸­å¤®ä»“åº“:è¿™ä¸ªä»“åº“æ˜¯é•œåƒæœ€å…¨çš„ï¼Œä½†æ˜¯ä¸‹è½½é€Ÿåº¦è¾ƒæ…¢ã€‚
https://hub.docker.com/

å›½å†…çš„é•œåƒç½‘ç«™:ç½‘æ˜“èœ‚å·¢ï¼ŒdaoCloudç­‰ï¼Œä¸‹è½½é€Ÿåº¦å¿«ï¼Œä½†æ˜¯é•œåƒç›¸å¯¹ä¸å…¨ã€‚
https://c.163yun.com/hub#/home
http://hub.daocloud.io/(æ¨èä½¿ç”¨ï¼‰

åœ¨å…¬å¸å†…éƒ¨ä¼šé‡‡ç”¨ç§æœçš„æ–¹å¼æ‹‰å–é•œåƒï¼Œéœ€è¦æ·»åŠ é…ç½®ï¼Œå¦‚ä¸‹......
éœ€è¦åˆ›å»º/etc/docker/daemon.jsonï¼Œå¹¶æ·»åŠ å¦‚ä¸‹å†…å®¹
{
	"registry-mirrors":["https://registry.docker-cn.com"],
	"insecure-registries":["ip:port"]
}
#é‡å¯ä¸¤ä¸ªæœåŠ¡
systemctl daemon-reload
systemctl restart docker
```



#### Dockerå¸¸ç”¨å‘½ä»¤

> Docker é•œåƒå‘½ä»¤

```
systemctl start docker å¯åŠ¨docker

docker --hple	dockerå¸¸ç”¨å‘½ä»¤
docker ps		æŸ¥çœ‹dockerè¿›ç¨‹

docker images	åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šçš„é•œåƒ
	-a :åˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼ˆå«ä¸­é—´æ˜ åƒå±‚ï¼Œå«æ²¡æœ‰è¿è¡Œï¼‰
	-q :åªæ˜¾ç¤ºé•œåƒID
	--digests :æ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯
	--no-trunc :æ˜¾ç¤ºå®Œæ•´çš„é•œåƒä¿¡æ¯
	è¯´æ˜ï¼šREPOSITORYé•œåƒåã€TAGæ ‡ç­¾ã€IMAGE_IDå”¯ä¸€ã€CREATEDåˆ›å»ºæ—¶é—´ã€VIRTUAL SIZEé•œåƒå¤§å°
	åŒä¸€ä»“åº“æºå¯ä»¥æœ‰å¤šä¸ªTAGï¼Œä»£è¡¨è¿™ä¸ªä»“åº“æºçš„ä¸åŒä¸ªç‰ˆæœ¬ï¼Œæˆ‘ä»¬ä½¿ç”¨REPOSITORY:TAGæ¥å®šä¹‰ä¸åŒçš„é•œåƒã€‚å¦‚æœä½ ä¸æŒ‡å®šä¸€ä¸ªé•œåƒçš„ç‰ˆæœ¬æ ‡ç­”ï¼Œä¾‹å¦‚ä½ åªä½“ç”¨ubuntu.dockerå°†é»˜è®¤ä½“ç”¨ubuntu:latesté•œåƒ
	
	
docker search xxx æŸ¥è¯¢æŸä¸ªé•œåƒ
	-s : åˆ—å‡ºæ”¶è—æ•°ä¸å°äºæŒ‡å®šå€¼çš„é•œåƒ
	--no-trunc :æ˜¾ç¤ºå®Œæ•´çš„é•œåƒä¿¡æ¯
	--automated : åªåˆ—å‡º automated buildç±»å‹çš„é•œåƒï¼›

    # æ˜Ÿæ•°è¶…è¿‡30çš„tomcat
    docker search -s 30 tomcat
    
    
docker pull xxx[:TAG] æ‹‰å–é•œåƒ
	docker pull tomcat ç­‰ä»·äº docker pull tomcat:latest
	
	
docker rmi xxx åˆ é™¤æŸä¸ªé•œåƒ/é•œåƒID
	-f é•œåƒID :å•ä¸ªåˆ é™¤æŸä¸ªé•œåƒ
	-f é•œåƒå[:TAG] :å•ä¸ªåˆ é™¤æŸä¸ªé•œåƒ
	-f é•œåƒå[:TAG] é•œåƒå[:TAG] :å¤šä¸ªåˆ é™¤é•œåƒ
	-f $(docker images -qa) åˆ é™¤æ‰€æœ‰é•œåƒ
	docker rmi -f hello-world å¼ºåˆ¶åˆ é™¤æŸä¸ªé•œåƒ
	docker rmi hello-world ç­‰ä»·äº docker rmi hello-world:latest


#ä»å®¹å™¨åˆ›å»ºä¸€ä¸ªæ–°çš„é•œåƒ
docker commit -m=â€œæäº¤çš„æè¿°ä¿¡æ¯â€ -a=â€œä½œè€…â€ å®¹å™¨ID è¦åˆ›å»ºçš„ç›®æ ‡é•œåƒå:[æ ‡ç­¾å]
```



> Docker å®¹å™¨å‘½ä»¤

```
æœ‰é•œåƒæ‰èƒ½åˆ›å»ºå®¹å™¨


docker run [OPTIONS] xxx IMAGE [COMMAND] å¯åŠ¨äº¤äº’å¼å®¹å™¨
	--name="å®¹å™¨æ–°åå­—": ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼›
    -d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼Œä¹Ÿå³å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨ï¼›
    -iï¼šä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼›
    -tï¼šä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼›
    -P: éšæœºç«¯å£æ˜ å°„ï¼›
    -p: æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæœ‰ä»¥ä¸‹å››ç§æ ¼å¼
            ip:hostPort:containerPort
            ip::containerPort
            hostPort:containerPort
            containerPort
     docker run -it centos	å¯åŠ¨centoså¹¶åˆ†é…ç»ˆç«¯      
     docker run -it -p 8081:8080 tomcat  å°†Linux8081æ˜ å°„åˆ°dockerçš„8080

docker ps æŸ¥çœ‹å½“å‰æ­£åœ¨è¿›è¡Œçš„dockerè¿›ç¨‹
	-a :åˆ—å‡ºå½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨+å†å²ä¸Šè¿è¡Œè¿‡çš„
    -l :æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨ã€‚
    -nï¼šæ˜¾ç¤ºæœ€è¿‘nä¸ªåˆ›å»ºçš„å®¹å™¨ã€‚
    -q :é™é»˜æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå®¹å™¨ç¼–å·ã€‚
    --no-trunc :ä¸æˆªæ–­è¾“å‡ºã€‚


docker restart å®¹å™¨ID  è¿”å›å®¹å™¨ä¿¡æ¯ä»¥JSONå­—ç¬¦ä¸²æ–¹å¼

åœ¨å®¹å™¨ä¸­
    exit å®¹å™¨åœæ­¢é€€å‡º
    Ctrl+P+Q å®¹å™¨ä¸åœæ­¢é€€å‡º

docker start å®¹å™¨ID

docker stop å®¹å™¨ID åœæ­¢å®¹å™¨
docker stop $(docker ps -qa) åœæ­¢æ‰€æœ‰å®¹å™¨

docker kill å®¹å™¨ID å¼ºåˆ¶å…³é—­å®¹å™¨

docker rm å®¹å™¨ID åˆ é™¤å·²åœæ­¢çš„å®¹å™¨
	-f :åœæ­¢å¹¶åˆ é™¤å®¹å™¨
	
	ä¸€æ¬¡æ€§åˆ é™¤å¤šä¸ªå®¹å™¨
	docker rm -f $(docker ps -a -q)
	docker ps -a -q | xargs docker rm
	
	
	

docker run -d xxx å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨	
    é—®é¢˜ï¼šç„¶ådocker ps -a è¿›è¡ŒæŸ¥çœ‹,Â ä¼šå‘ç°å®¹å™¨å·²ç»é€€å‡º
    å¾ˆé‡è¦çš„è¦è¯´æ˜çš„ä¸€ç‚¹:Â Dockerå®¹å™¨åå°è¿è¡Œ,å°±å¿…é¡»æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹.
    å®¹å™¨è¿è¡Œçš„å‘½ä»¤å¦‚æœä¸æ˜¯é‚£äº›ä¸€ç›´æŒ‚èµ·çš„å‘½ä»¤ï¼ˆæ¯”å¦‚è¿è¡Œtopï¼Œtailï¼‰ï¼Œå°±æ˜¯ä¼šè‡ªåŠ¨é€€å‡ºçš„ã€‚

    è¿™ä¸ªæ˜¯dockerçš„æœºåˆ¶é—®é¢˜,æ¯”å¦‚ä½ çš„webå®¹å™¨,æˆ‘ä»¬ä»¥nginxä¸ºä¾‹ï¼Œæ­£å¸¸æƒ…å†µä¸‹,æˆ‘ä»¬é…ç½®å¯åŠ¨æœåŠ¡åªéœ€è¦å¯åŠ¨å“åº”çš„
    serviceå³å¯ã€‚ä¾‹å¦‚service nginx start
    ä½†æ˜¯,è¿™æ ·åš,nginxä¸ºåå°è¿›ç¨‹æ¨¡å¼è¿è¡Œ,å°±å¯¼è‡´dockerå‰å°æ²¡æœ‰è¿è¡Œçš„åº”ç”¨,
    è¿™æ ·çš„å®¹å™¨åå°å¯åŠ¨å,ä¼šç«‹å³è‡ªæ€å› ä¸ºä»–è§‰å¾—ä»–æ²¡äº‹å¯åšäº†.
    æ‰€ä»¥ï¼Œæœ€ä½³çš„è§£å†³æ–¹æ¡ˆæ˜¯,å°†ä½ è¦è¿è¡Œçš„ç¨‹åºä»¥å‰å°è¿›ç¨‹çš„å½¢å¼è¿è¡Œ
	
	
docker logs -f -t --tail å®¹å™¨ID  æŸ¥çœ‹å®¹å™¨æ—¥å¿—
	-t æ˜¯åŠ å…¥æ—¶é—´æˆ³
	-f è·Ÿéšæœ€æ–°çš„æ—¥å¿—æ‰“å°
	--tail æ•°å­— æ˜¾ç¤ºæœ€åå¤šå°‘æ¡


docker top å®¹å™¨ID	æŸ¥çœ‹å®¹å™¨å†…è¿è¡Œçš„è¿›ç¨‹

docker inspect å®¹å™¨ID æŸ¥çœ‹å®¹å™¨å†…éƒ¨ç»†èŠ‚


è¿›å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨å¹¶ä»¥å‘½ä»¤è¡Œäº¤äº’
	docker exec -it å®¹å™¨ID bashShell 	åœ¨å¤–éƒ¨æ‰§è¡Œdockerå®¹å™¨çš„å‘½ä»¤ [/bin/bashè¿è¡Œdockerç»ˆç«¯]

	docker attach å®¹å™¨ID	é‡æ–°è¿›å…¥
    
	exec æ˜¯åœ¨å®¹å™¨ä¸­æ‰“å¼€æ–°çš„ç»ˆç«¯ï¼Œå¹¶ä¸”å¯ä»¥å¯åŠ¨æ–°çš„è¿›ç¨‹
	
	attach ç›´æ¥è¿›å…¥å®¹å™¨å¯åŠ¨å‘½ä»¤çš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„è¿›ç¨‹

docker cp å®¹å™¨ID:å®¹å™¨å†…è·¯å¾„ ç›®çš„ä¸»æœºè·¯å¾„
```



#### Dockeré•œåƒ

> UnionFS(è”åˆæ–‡ä»¶ç³»ç»Ÿ)

```
UnionFSï¼ˆè”åˆæ–‡ä»¶ç³»ç»Ÿï¼‰ï¼šUnionæ–‡ä»¶ç³»ç»Ÿï¼ˆUnionFSï¼‰æ˜¯ä¸€ç§åˆ†å±‚ã€è½»é‡çº§å¹¶ä¸”é«˜æ€§èƒ½çš„æ–‡ä»¶ç³»ç»Ÿï¼Œå®ƒæ”¯æŒå¯¹æ–‡ä»¶ç³»ç»Ÿçš„ä¿®æ”¹ä½œä¸ºä¸€æ¬¡æäº¤æ¥ä¸€å±‚å±‚çš„å åŠ ï¼ŒåŒæ—¶å¯ä»¥å°†ä¸åŒç›®å½•æŒ‚è½½åˆ°åŒä¸€ä¸ªè™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿä¸‹(unite several directories into a single virtual filesystem)ã€‚Union æ–‡ä»¶ç³»ç»Ÿæ˜¯ Docker é•œåƒçš„åŸºç¡€ã€‚é•œåƒå¯ä»¥é€šè¿‡åˆ†å±‚æ¥è¿›è¡Œç»§æ‰¿ï¼ŒåŸºäºåŸºç¡€é•œåƒï¼ˆæ²¡æœ‰çˆ¶é•œåƒï¼‰ï¼Œå¯ä»¥åˆ¶ä½œå„ç§å…·ä½“çš„åº”ç”¨é•œåƒã€‚
Â 
ç‰¹æ€§ï¼šä¸€æ¬¡åŒæ—¶åŠ è½½å¤šä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œä½†ä»å¤–é¢çœ‹èµ·æ¥ï¼Œåªèƒ½çœ‹åˆ°ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼Œè”åˆåŠ è½½ä¼šæŠŠå„å±‚æ–‡ä»¶ç³»ç»Ÿå åŠ èµ·æ¥ï¼Œè¿™æ ·æœ€ç»ˆçš„æ–‡ä»¶ç³»ç»Ÿä¼šåŒ…å«æ‰€æœ‰åº•å±‚çš„æ–‡ä»¶å’Œç›®å½•
```



> Dockeré•œåƒåŠ è½½åŸç†

```
Â 
Â Dockeré•œåƒåŠ è½½åŸç†ï¼š

dockerçš„é•œåƒå®é™…ä¸Šç”±ä¸€å±‚ä¸€å±‚çš„æ–‡ä»¶ç³»ç»Ÿç»„æˆï¼Œè¿™ç§å±‚çº§çš„æ–‡ä»¶ç³»ç»ŸUnionFSã€‚
bootfs(boot file system)ä¸»è¦åŒ…å«bootloaderå’Œkernel, bootloaderä¸»è¦æ˜¯å¼•å¯¼åŠ è½½kernel, Linuxåˆšå¯åŠ¨æ—¶ä¼šåŠ è½½bootfsæ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨Dockeré•œåƒçš„æœ€åº•å±‚æ˜¯bootfsã€‚è¿™ä¸€å±‚ä¸æˆ‘ä»¬å…¸å‹çš„Linux/Unixç³»ç»Ÿæ˜¯ä¸€æ ·çš„ï¼ŒåŒ…å«bootåŠ è½½å™¨å’Œå†…æ ¸ã€‚å½“bootåŠ è½½å®Œæˆä¹‹åæ•´ä¸ªå†…æ ¸å°±éƒ½åœ¨å†…å­˜ä¸­äº†ï¼Œæ­¤æ—¶å†…å­˜çš„ä½¿ç”¨æƒå·²ç”±bootfsè½¬äº¤ç»™å†…æ ¸ï¼Œæ­¤æ—¶ç³»ç»Ÿä¹Ÿä¼šå¸è½½bootfsã€‚
Â 
rootfs (root file system) ï¼Œåœ¨bootfsä¹‹ä¸Šã€‚åŒ…å«çš„å°±æ˜¯å…¸å‹ Linux ç³»ç»Ÿä¸­çš„ /dev, /proc, /bin, /etc ç­‰æ ‡å‡†ç›®å½•å’Œæ–‡ä»¶ã€‚rootfså°±æ˜¯å„ç§ä¸åŒçš„æ“ä½œç³»ç»Ÿå‘è¡Œç‰ˆï¼Œæ¯”å¦‚Ubuntuï¼ŒCentosç­‰ç­‰ã€‚Â 
å¹³æ—¶æˆ‘ä»¬å®‰è£…è¿›è™šæ‹Ÿæœºçš„CentOSéƒ½æ˜¯å¥½å‡ ä¸ªGï¼Œä¸ºä»€ä¹ˆdockerè¿™é‡Œæ‰200Mï¼Ÿï¼Ÿ

å¯¹äºä¸€ä¸ªç²¾ç®€çš„OSï¼Œrootfså¯ä»¥å¾ˆå°ï¼Œåªéœ€è¦åŒ…æ‹¬æœ€åŸºæœ¬çš„å‘½ä»¤ã€å·¥å…·å’Œç¨‹åºåº“å°±å¯ä»¥äº†ï¼Œå› ä¸ºåº•å±‚ç›´æ¥ç”¨Hostçš„kernelï¼Œè‡ªå·±åªéœ€è¦æä¾› rootfs å°±è¡Œäº†ã€‚ç”±æ­¤å¯è§å¯¹äºä¸åŒçš„linuxå‘è¡Œç‰ˆ, bootfsåŸºæœ¬æ˜¯ä¸€è‡´çš„, rootfsä¼šæœ‰å·®åˆ«, å› æ­¤ä¸åŒçš„å‘è¡Œç‰ˆå¯ä»¥å…¬ç”¨bootfsã€‚

ä»¥æˆ‘ä»¬çš„pullä¸ºä¾‹ï¼Œåœ¨ä¸‹è½½çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°dockerçš„é•œåƒå¥½åƒæ˜¯åœ¨ä¸€å±‚ä¸€å±‚çš„åœ¨ä¸‹è½½
```



> ä¸ºä»€ä¹ˆ Docker é•œåƒè¦é‡‡ç”¨è¿™ç§åˆ†å±‚ç»“æ„å‘¢

```
æœ€å¤§çš„ä¸€ä¸ªå¥½å¤„å°±æ˜¯ - å…±äº«èµ„æº
Â 
æ¯”å¦‚ï¼šæœ‰å¤šä¸ªé•œåƒéƒ½ä»ç›¸åŒçš„ base é•œåƒæ„å»ºè€Œæ¥ï¼Œé‚£ä¹ˆå®¿ä¸»æœºåªéœ€åœ¨ç£ç›˜ä¸Šä¿å­˜ä¸€ä»½baseé•œåƒï¼Œ
åŒæ—¶å†…å­˜ä¸­ä¹Ÿåªéœ€åŠ è½½ä¸€ä»½ base é•œåƒï¼Œå°±å¯ä»¥ä¸ºæ‰€æœ‰å®¹å™¨æœåŠ¡äº†ã€‚è€Œä¸”é•œåƒçš„æ¯ä¸€å±‚éƒ½å¯ä»¥è¢«å…±äº«ã€‚

Dockeré•œåƒéƒ½æ˜¯åªè¯»çš„
å½“å®¹å™¨å¯åŠ¨æ—¶ï¼Œä¸€ä¸ªæ–°çš„å¯å†™å±‚è¢«åŠ è½½åˆ°é•œåƒçš„é¡¶éƒ¨(ä¾‹å¦‚å›¾ä¸‹çš„tomcat)ã€‚
è¿™ä¸€å±‚é€šå¸¸è¢«ç§°ä½œâ€œå®¹å™¨å±‚â€ï¼Œâ€œå®¹å™¨å±‚â€ä¹‹ä¸‹çš„éƒ½å«â€œé•œåƒå±‚â€ã€‚
```

![](image\é•œåƒåˆ†å±‚.png)



#### Dockeræ•°æ®åˆ¸

> åˆ›å»ºæ•°æ®åˆ¸ä¹‹åï¼Œé»˜è®¤ä¼šå­˜æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸‹ /var/lib/docker/volumes/æ•°æ®åˆ¸å/_data

```sh
docker volume create æ•°æ®åˆ¸åç§°
```

> æŸ¥çœ‹æ•°æ®åˆ¸è¯¦æƒ…

```sh
docker volume inspect æ•°æ®åˆ¸åç§°
```

> æŸ¥çœ‹å…¨éƒ¨æ•°æ®åˆ¸ä¿¡æ¯

```sh
docker volume ls
```

> åˆ é™¤æ•°æ®åˆ¸

```sh
docker volume rm æ•°æ®åˆ¸åç§°
```

> å®¹å™¨æ˜ å°„æ•°æ®åˆ¸

```sh
æ˜ å°„æœ‰ä¸¤ç§æ–¹å¼:
1.é€šè¿‡è·¯å¾„æ˜ å°„æ•°æ®å·ï¼Œç›´æ¥æŒ‡å®šä¸€ä¸ªè·¯å¾„ä½œä¸ºæ•°æ®å·çš„å­˜æ”¾ä½ç½®ã€‚ä½†æ˜¯è¿™ä¸ªè·¯å¾„ä¸‹æ˜¯ç©ºçš„ã€‚
#é€šè¿‡æ•°æ®å·åç§°æ˜ å°„
docker run -væ•°æ®å·åç§°:å®¹å™¨å†…éƒ¨çš„è·¯å¾„é•œåƒid

2.é€šè¿‡æ•°æ®å·åç§°æ˜ å°„ï¼Œå¦‚æœæ•°æ®å·ä¸å­˜åœ¨ã€‚Dockerä¼šå¸®ä½ è‡ªåŠ¨åˆ›å»ºï¼Œä¼šå°†å®¹å™¨å†…éƒ¨è‡ªå¸¦çš„æ–‡ä»¶ï¼Œå­˜å‚¨åœ¨é»˜è®¤çš„å­˜æ”¾è·¯å¾„ä¸­ã€‚
#é€šè¿‡è·¯å¾„æ˜ å°„æ•°æ®å·
docker run -vè·¯å¾„:å®¹å™¨å†…éƒ¨çš„è·¯å¾„é•œåƒid

docker run -it -v /å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•:/å®¹å™¨å†…ç›®å½• é•œåƒå 	å®¹å™¨å®¿ä¸»å…±äº«æ•°æ®
docker run -it -v /å®¿ä¸»æœºç»å¯¹è·¯å¾„ç›®å½•:/å®¹å™¨å†…ç›®å½•:ro é•œåƒå	æºå¸¦æƒé™
docker run -it -v /cps_hose:/cps_contain centos:6.8

æ•°æ®å·å®¹å™¨ å®¹å™¨é—´ä¼ é€’å…±äº«(--volumes-from çˆ¶å®¹å™¨ID)
å‘½åçš„å®¹å™¨æŒ‚è½½æ•°æ®å·ï¼Œå…¶å®ƒå®¹å™¨é€šè¿‡æŒ‚è½½è¿™ä¸ª(çˆ¶å®¹å™¨)å®ç°æ•°æ®å…±äº«ï¼ŒæŒ‚è½½æ•°æ®å·çš„å®¹å™¨ï¼Œç§°ä¹‹ä¸ºæ•°æ®å·å®¹å™¨
docker run -it --name dc02 --volumes-from dc01 zzyy/centos

å®¹å™¨ä¹‹é—´é…ç½®ä¿¡æ¯çš„ä¼ é€’ï¼Œæ•°æ®å·çš„ç”Ÿå‘½å‘¨æœŸä¸€ç›´æŒç»­åˆ°æ²¡æœ‰å®¹å™¨ä½¿ç”¨å®ƒä¸ºæ­¢
```



#### DockerFileè§£æ

> DockerFileæ„å»ºè¿‡ç¨‹è§£æ

```
DockerFileæ˜¯ç”¨æ¥æ„å»ºDockeré•œåƒçš„æ„å»ºæ–‡ä»¶ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—å‘½ä»¤å’Œå‚æ•°æ„æˆçš„è„šæœ¬ã€‚

æ„å»ºä¸‰æ­¥éª¤ï¼šDockerFile â†’(build)â†’ Dockeré•œåƒ â†’(run)â†’ Dockerå®¹å™¨

ä»åº”ç”¨è½¯ä»¶çš„è§’åº¦æ¥çœ‹ï¼ŒDockerfileã€Dockeré•œåƒä¸Dockerå®¹å™¨åˆ†åˆ«ä»£è¡¨è½¯ä»¶çš„ä¸‰ä¸ªä¸åŒé˜¶æ®µï¼Œ
* Â Dockerfileæ˜¯è½¯ä»¶çš„åŸææ–™
* Â Dockeré•œåƒæ˜¯è½¯ä»¶çš„äº¤ä»˜å“
* Â Dockerå®¹å™¨åˆ™å¯ä»¥è®¤ä¸ºæ˜¯è½¯ä»¶çš„è¿è¡Œæ€ã€‚
Dockerfileé¢å‘å¼€å‘ï¼ŒDockeré•œåƒæˆä¸ºäº¤ä»˜æ ‡å‡†ï¼ŒDockerå®¹å™¨åˆ™æ¶‰åŠéƒ¨ç½²ä¸è¿ç»´ï¼Œä¸‰è€…ç¼ºä¸€ä¸å¯ï¼ŒåˆåŠ›å……å½“Dockerä½“ç³»çš„åŸºçŸ³ã€‚
```



> DockerFileä½“ç³»ç»“æ„(ä¿ç•™å­—æŒ‡ä»¤)

```sh
FROM		åŸºç¡€é•œåƒï¼Œå½“å‰æ–°é•œåƒæ˜¯åŸºäºå“ªä¸ªé•œåƒçš„
MAINTAINER	é•œåƒç»´æŠ¤è€…çš„å§“åå’Œé‚®ç®±åœ°å€
RUN			å®¹å™¨æ„å»ºæ—¶éœ€è¦è¿è¡Œçš„å‘½ä»¤
EXPOSE		å½“å‰å®¹å™¨å¯¹å¤–æš´éœ²å‡ºçš„ç«¯å£
WORKDIR		æŒ‡å®šåœ¨åˆ›å»ºå®¹å™¨åï¼Œç»ˆç«¯é»˜è®¤ç™»é™†çš„è¿›æ¥å·¥ä½œç›®å½•ï¼Œä¸€ä¸ªè½è„šç‚¹
ENV			ç”¨æ¥åœ¨æ„å»ºé•œåƒè¿‡ç¨‹ä¸­è®¾ç½®ç¯å¢ƒå˜é‡
ADD			å°†å®¿ä¸»æœºç›®å½•ä¸‹çš„æ–‡ä»¶æ‹·è´è¿›é•œåƒä¸”ADDå‘½ä»¤ä¼šè‡ªåŠ¨å¤„ç†URLå’Œè§£å‹tarå‹ç¼©åŒ…
COPY		ç±»ä¼¼ADDï¼Œæ‹·è´æ–‡ä»¶å’Œç›®å½•åˆ°é•œåƒä¸­ã€‚ <æºè·¯å¾„> çš„æ–‡ä»¶/æ–°ä¸€å±‚çš„é•œåƒå†… <ç›®æ ‡è·¯å¾„> ä½ç½®
VOLUME		å®¹å™¨æ•°æ®å·ï¼Œç”¨äºæ•°æ®ä¿å­˜å’ŒæŒä¹…åŒ–å·¥ä½œ

CMD			æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤
			Dockerfile ä¸­å¯ä»¥æœ‰å¤šä¸ª CMD æŒ‡ä»¤ï¼Œä½†åªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆï¼ŒCMD ä¼šè¢«docker runä¹‹åçš„å‚æ•°æ›¿æ¢

ENTRYPOINT 	æŒ‡å®šä¸€ä¸ªå®¹å™¨å¯åŠ¨æ—¶è¦è¿è¡Œçš„å‘½ä»¤
			ENTRYPOINT çš„ç›®çš„å’Œ CMD ä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨æŒ‡å®šå®¹å™¨å¯åŠ¨ç¨‹åºåŠå‚æ•°
			
ONBUILD		å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿çš„Dockerfileæ—¶è¿è¡Œå‘½ä»¤ï¼Œçˆ¶é•œåƒåœ¨è¢«å­ç»§æ‰¿åçˆ¶é•œåƒçš„onbuildè¢«è§¦å‘
```



>è‡ªå®šä¹‰é•œåƒmycentos

```sh
1.ç¼–å†™DockerFileæ–‡ä»¶
-------------------------------
FROM centosMAINTAINER zzyy<zzyy167@126.com>
ENV MYPATH /usr/localWORKDIR $MYPATH
RUN yum -y install vim 
RUN yum -y install net-tools
EXPOSE 80
CMD echo $MYPATHCMD echo "success--------------ok"CMD /bin/bashÂ 
-------------------------------

2.æ„å»ºå‡ºæ–°é•œåƒ
docker build -f myDockerfile -t æ–°é•œåƒåå­—:TAG .

3.è¿è¡Œ
docker run -it æ–°é•œåƒåå­—:TAG 

4.åˆ—å‡ºé•œåƒå˜æ›´å†å²
docker history é•œåƒå

# tomcatå¯åŠ¨å®¹å™¨
docker run -d -p 8888:8080 --name my_tomcat 
-v /myDocker/tomcat/test:/usr/local/apache-tomcat-9.0.8/webapps/test 
-v /myDocker/tomcat/logs/:/usr/local/apache-tomcat-9.0.8/logs/ --privileged=true


docker run -p 12345:3306 
--name mysql 
-v /myDocker/mysql/conf:/etc/mysql/conf.d 
-v /myDocker/mysql/logs:/logs 
-v /myDocker/mysql/data:/var/lib/mysql 
-e MYSQL_ROOT_PASSWORD=123456 
-d mysql:5.7


-p 12345:3306 #å°†ä¸»æœºçš„12345ç«¯å£æ˜ å°„åˆ°dockerå®¹å™¨çš„3306ç«¯å£ã€‚
--name mysql #è¿è¡ŒæœåŠ¡åå­—
-v /zzyyuse/mysql/conf:/etc/mysql/conf.d #å°†ä¸»æœº/zzyyuse/mysqlå½•ä¸‹çš„conf/my.cnf æŒ‚è½½åˆ°å®¹å™¨çš„ /etc/mysql/conf.d
-v /zzyyuse/mysql/logs:/logs #å°†ä¸»æœº/zzyyuse/mysqlç›®å½•ä¸‹çš„ logs ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ /logsã€‚
-v /zzyyuse/mysql/data:/var/lib/mysql #å°†ä¸»æœº/zzyyuse/mysqlç›®å½•ä¸‹çš„dataç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„ /var/lib/mysqlÂ 
-e MYSQL_ROOT_PASSWORD=a9530.A. #åˆå§‹åŒ– root ç”¨æˆ·çš„å¯†ç ã€‚
-d mysql:5.6 #åå°ç¨‹åºè¿è¡Œmysql5.6
Â 
docker exec -it MySQLè¿è¡ŒæˆåŠŸåçš„å®¹å™¨ID/bin/bash
```



> MyTomcatçš„DockerFile

```sh
FROM Â Â Â Â Â Â Â  centos
MAINTAINER Â Â Cai Peishen<peishen.cai@foxmail.com>

#æŠŠå®¿ä¸»æœºå½“å‰ä¸Šä¸‹æ–‡çš„Cps.txtæ‹·è´åˆ°å®¹å™¨/usr/local/è·¯å¾„ä¸‹
COPY index.html /usr/local/tomcat/cps/index.html

#æŠŠjavaä¸tomcatæ·»åŠ åˆ°å®¹å™¨ä¸­
ADD jdk-8u171-linux-x64.tar.gz /usr/local/
ADD apache-tomcat-9.0.8.tar.gz /usr/local/

#å®‰è£…vimç¼–è¾‘å™¨
RUN yum -y install vim

#è®¾ç½®å·¥ä½œè®¿é—®æ—¶å€™çš„WORKDIRè·¯å¾„ï¼Œç™»å½•è½è„šç‚¹
ENV MYPATH /usr/local
WORKDIR $MYPATH

#é…ç½®javaä¸tomcatç¯å¢ƒå˜é‡
ENV JAVA_HOME /usr/local/jdk1.8.0_171
ENV CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar
ENV CATALINA_HOME /usr/local/apache-tomcat-9.0.8
ENV CATALINA_BASE /usr/local/apache-tomcat-9.0.8
ENV PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/lib:$CATALINA_HOME/bin

#å®¹å™¨è¿è¡Œæ—¶ç›‘å¬çš„ç«¯å£
EXPOSE 8080

#å¯åŠ¨æ—¶è¿è¡Œtomcat
# ENTRYPOINT ["/usr/local/apache-tomcat-9.0.8/bin/startup.sh"]
# CMD ["/usr/local/apache-tomcat-9.0.8/bin/catalina.sh","run"]
CMD /usr/local/apache-tomcat-9.0.8/bin/startup.sh && tail -F /usr/local/apache-tomcat-9.0.8/bin/logs/catalina.out
```



#### Docker Compose

> Compose ç®€ä»‹

```
Compose æ˜¯ç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨ Docker åº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚é€šè¿‡ Composeï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ YML æ–‡ä»¶æ¥é…ç½®åº”ç”¨ç¨‹åºéœ€è¦çš„æ‰€æœ‰æœåŠ¡ã€‚ç„¶åï¼Œä½¿ç”¨ä¸€ä¸ªå‘½ä»¤ï¼Œå°±å¯ä»¥ä» YML æ–‡ä»¶é…ç½®ä¸­åˆ›å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡ã€‚

1.ä½¿ç”¨ Dockerfile å®šä¹‰åº”ç”¨ç¨‹åºçš„ç¯å¢ƒ
2.ä½¿ç”¨ docker-compose.yml å®šä¹‰æ„æˆåº”ç”¨ç¨‹åºæœåŠ¡ï¼Œè¿™æ ·å®ƒä»¬å¯ä»¥åœ¨éš”ç¦»ç¯å¢ƒä¸­ä¸€èµ·è¿è¡Œ
3.æœ€åï¼Œæ‰§è¡Œ docker-compose up å‘½ä»¤æ¥å¯åŠ¨å¹¶è¿è¡Œæ•´ä¸ªåº”ç”¨ç¨‹åº
```



> å®‰è£…

```sh
#å»githubå®˜ç½‘æœç´¢docker-composeï¼Œä¸‹è½½1.24.1ç‰ˆæœ¬çš„Docker-Compose ä¹Ÿå¯ä»¥ç›´æ¥å†Linuxä¸­ä¸‹è½½
wget https://github.com/docker/compose/releases/download/1.24.1/docker-compose-Linux-x86_64
#èµ‹äºˆæƒé™ æœ¬èº«å°±æ˜¯å¯ä»¥æ‰§è¡Œçš„æ–‡ä»¶ åªæ˜¯æƒé™ä¸å¤Ÿ
chmod 777 docker-compose-Linux-x86_64
#æ”¾è¿›/usr/local/binç›®å½•ä¸‹å¹¶ä¿®æ”¹æ–‡ä»¶å etc/profileç¯å¢ƒå˜é‡ä¸­ä¼šé…ç½®è¯¥è·¯å¾„ è¯¥ç›®å½•ä¸‹éƒ½æ˜¯å¯ä»¥ç›´æ¥æ‰§è¡Œçš„å‘½ä»¤
mv docker-compose-Linux-x86_64 /usr/local/bin/docker-compose
#åœ¨ä»»æ„ç›®å½•ä¸‹è¾“å…¥
docker-compose
```



> docker-compose.ymlçš„ é…ç½®æ¡ˆä¾‹å¦‚ä¸‹ï¼ˆé…ç½®å‚æ•°å‚è€ƒä¸‹æ–‡ï¼‰ï¼š 

```yml
# yaml é…ç½®å®ä¾‹
version: '3'
services:
  web:
    build: .
    ports:
      - "5000:5000"
    volumes:
      - .:/code
      - logvolume01:/var/log
    links:
      - redis
  redis:
    image: redis
  volumes:
    logvolume01: {}
```



> Docker-Composeç®¡ç†MySQLå’ŒTomcatå®¹å™¨

```yml
version: '3.1'
services:
  mysql: #æœåŠ¡çš„åç§°
    restart: always #ä»£è¡¨åªè¦dockerå¯åŠ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå®¹å™¨å°±è·Ÿç€ä¸€èµ·å¯åŠ¨
    image: daocloud.io/library/mysql:5.7.4 #æŒ‡å®šé•œåƒè·¯å¾„
    container_name: mysql #æŒ‡å®šå®¹å™¨åç§°
    ports: 
      - 3307:3306 #æŒ‡å®šç«¯å£å·çš„æ˜ å°„ Linuxçš„3307ä¸å®¹å™¨çš„3306æ˜ å°„èµ·æ¥
    environment: 
      MYSQL_ROOT_PASSWORD: a9530.A. #æŒ‡å®šMySQLçš„ROOTç”¨æˆ·ç™»å½•å¯†ç 
      TZ: Asia/Shanghai #æŒ‡å®šæ—¶åŒº
    volumes: 
      - /opt/docker/docker_mysql_tomcat/mysql_data:/var/lib/mysql #æ˜ å°„æ•°æ®å·
  tomcat:
    restart: always
    image: daocloud.io/library/tomcat:8.5.15-jre8
    container_name: tomcat
    ports:
      - 8081:8080
    environment: 
      TZ: Asia/Shanghai
    volumes: 
      - /opt/docker/docker_mysql_tomcat/tomcat_webapps:/usr/local/tomcat/webapps
      - /opt/docker/docker_mysql_tomcat/tomcat_logs:/usr/local/tomcat/logs
```



>ä½¿ç”¨docker-composeå‘½ä»¤ç®¡ç†å®¹å™¨

```sh
#åœ¨ä½¿ç”¨docker-composeçš„å‘½ä»¤æ—¶ï¼Œé»˜è®¤ä¼šåœ¨å½“å‰ç›®å½•ä¸‹æ‰¾docker-compose.ymlæ–‡ä»¶

#1.åŸºäºdocker-compose.ymlå¯åŠ¨ç®¡ç†çš„å®¹å™¨
docker-compose up -d

#2.å…³é—­å¹¶åˆ é™¤å®¹å™¨
docker-compose down

#3.å¼€å¯|å…³é—­|é‡å¯å·²ç»å­˜åœ¨çš„ç”±docker-composeç»´æŠ¤çš„å®¹å™¨
docker-compose start|stop|restart

#4.æŸ¥çœ‹ç”±docker-composeç®¡ç†çš„å®¹å™¨
docker-compose ps

#5.æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```



> docker-composeé…åˆDockerfileä½¿ç”¨

```sh
#ä½¿ç”¨docker-compose.ymlæ–‡ä»¶ä»¥åŠDockerfileæ–‡ä»¶åœ¨ç”Ÿæˆè‡ªå®šä¹‰é•œåƒçš„åŒæ—¶å¯åŠ¨å½“å‰é•œåƒï¼Œå¹¶ä¸”ç”±docker-composeå»ç®¡ç†å®¹å™¨
```

------

```yml
#ç¼–å†™docker-compose.ymlæ–‡ä»¶
# ymlæ–‡ä»¶
version: '3.1'
services:
  ssm:
    restart: always
    build: #æ„å»ºè‡ªå®šä¹‰é•œåƒ
      context: ./ #æŒ‡å®šdockerfileæ–‡ä»¶çš„æ‰€åœ¨è·¯å¾„
      dockerfile: Dockerfile #æŒ‡å®šDockerfileæ–‡ä»¶åç§°
    image: ssm:1.0.1
    container_name: ssm
    ports:
      - 8082:8080
    environment:
      TZ:Asia/Shanghai
```

------

```dockerfile
#ç¼–å†™Dockerfileæ–‡ä»¶
FROM daocloud.io/library/tomcat:8.5.15-jre8
COPY ssm /usr/local/tomcat/webapps/ssm
#è¿™é‡Œssmæ˜¯ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚æœæ˜¯waråŒ…ï¼Œåˆ™åé¢ä¸ç”¨åŠ ssmè·¯å¾„ï¼Œ
#å…·ä½“æŸ¥çœ‹https://www.cnblogs.com/zdz8207/p/linux-docker-add-copy.html
```

------

```sh
#å¯ä»¥ç›´æ¥å¯åŠ¨åŸºäºdocker-compose .ym1ä»¥åŠDockerfileæ–‡ä»¶æ„å»ºçš„è‡ªå®šä¹‰é•œåƒ
docker-compose up -d
#å¦‚æœè‡ªå®šä¹‰é•œåƒä¸å­˜åœ¨ï¼Œä¼šå¸®åŠ©æˆ‘ä»¬æ„å»ºå‡ºè‡ªå®šä¹‰é•œåƒï¼Œå¦‚æœè‡ªå®šä¹‰é•œåƒå·²ç»å­˜åœ¨ï¼Œä¼šç›´æ¥è¿è¡Œè¿™ä¸ªè‡ªå®šä¹‰é•œåƒ
#é‡æ–°æ„å»ºçš„è¯ã€‚
#é‡æ–°æ„å»ºè‡ªå®šä¹‰é•œåƒ
docker-compose build
#è¿è¡Œå½“å‰å†…å®¹ï¼Œå¹¶é‡æ–°æ„å»º
docker-compose up -d --build
```



### Spring Security

å‚è€ƒï¼š[Spring Securityç³»åˆ—](https://blog.csdn.net/yuanlaijike/category_9283872.html)  [å¦ä¸€ä¸ª](https://blog.csdn.net/qq_22172133/category_8615344.html)  [é…ç½®æ–¹å¼](https://blog.csdn.net/fellhair/article/details/91410281)  [æ±Ÿå—ä¸€ç‚¹é›¨Spring Security](https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI1NDY0MTkzNQ==&action=getalbum&album_id=1319828555819286528&scene=173#wechat_redirect)    [FilterChainProxy](https://my.oschina.net/u/2518341/blog/2874530)

![](image\spring-securityæ‰§è¡Œæµç¨‹.jpg)



#### æ·»åŠ éªŒè¯ç éªŒè¯

> ä¸€ã€è‡ªå®šä¹‰è¿‡æ»¤å™¨å¤„ç†éªŒè¯ç 

1. è‡ªå®šä¹‰è¿‡æ»¤å™¨ç»§æ‰¿è‡ª GenericFilterBeanï¼Œå¹¶å®ç°å…¶ä¸­çš„ doFilter æ–¹æ³• 

   ```
   @Component
   publicclass VerifyCodeFilter extends GenericFilterBean {
       private String defaultFilterProcessUrl = "/doLogin";
   
       @Override
       public void doFilter(ServletRequest req, ServletResponse res, FilterChain chain)
               throws IOException, ServletException {
           HttpServletRequest request = (HttpServletRequest) req;
           HttpServletResponse response = (HttpServletResponse) res;
           if ("POST".equalsIgnoreCase(request.getMethod()) && defaultFilterProcessUrl.equals(request.getServletPath())) {
               // éªŒè¯ç éªŒè¯
               String requestCaptcha = request.getParameter("code");
               String genCaptcha = (String) request.getSession().getAttribute("index_code");
               if (StringUtils.isEmpty(requestCaptcha))
                   thrownew AuthenticationServiceException("éªŒè¯ç ä¸èƒ½ä¸ºç©º!");
               if (!genCaptcha.toLowerCase().equals(requestCaptcha.toLowerCase())) {
                   thrownew AuthenticationServiceException("éªŒè¯ç é”™è¯¯!");
               }
           }
           chain.doFilter(request, response);
       }
   }
   ```

   ```
   è‡ªå®šä¹‰è¿‡æ»¤å™¨ç»§æ‰¿è‡ª GenericFilterBeanï¼Œå¹¶å®ç°å…¶ä¸­çš„ doFilter æ–¹æ³•ï¼Œåœ¨ doFilter æ–¹æ³•ä¸­ï¼Œå½“è¯·æ±‚æ–¹æ³•æ˜¯ POSTï¼Œå¹¶ä¸”è¯·æ±‚åœ°å€æ˜¯ /doLogin æ—¶ï¼Œè·å–å‚æ•°ä¸­çš„ code å­—æ®µå€¼ï¼Œè¯¥å­—æ®µä¿å­˜äº†ç”¨æˆ·ä»å‰ç«¯é¡µé¢ä¼ æ¥çš„éªŒè¯ç ï¼Œç„¶åè·å– session ä¸­ä¿å­˜çš„éªŒè¯ç ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰ä¼ æ¥éªŒè¯ç ï¼Œåˆ™æŠ›å‡ºéªŒè¯ç ä¸èƒ½ä¸ºç©ºå¼‚å¸¸ï¼Œå¦‚æœç”¨æˆ·ä¼ å…¥äº†éªŒè¯ç ï¼Œåˆ™åˆ¤æ–­éªŒè¯ç æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœä¸æ­£ç¡®åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œå¦åˆ™æ‰§è¡Œ chain.doFilter(request, response); ä½¿è¯·æ±‚ç»§ç»­å‘ä¸‹èµ°ã€‚
   ```

   

2.  åœ¨ Spring Security çš„é…ç½®ä¸­ï¼Œé…ç½®è¿‡æ»¤å™¨ 

   ```java
   @Configuration
   publicclass SecurityConfig extends WebSecurityConfigurerAdapter {
   
       @Autowired
       VerifyCodeFilter verifyCodeFilter;
       ...
       ...
       @Override
       protected void configure(HttpSecurity http) throws Exception {
           http.addFilterBefore(verifyCodeFilter, UsernamePasswordAuthenticationFilter.class);
           http.authorizeRequests()
                   .antMatchers("/admin/**").hasRole("admin")
                   ...
                   ...
                   .permitAll()
                   .and()
                   .csrf().disable();
       }
   }
   ```

   ```
   è¿™é‡Œåªè´´å‡ºäº†éƒ¨åˆ†æ ¸å¿ƒä»£ç ï¼Œå³ http.addFilterBefore(verifyCodeFilter, UsernamePasswordAuthenticationFilter.class); ï¼Œå¦‚æ­¤ä¹‹åï¼Œæ•´ä¸ªé…ç½®å°±ç®—å®Œæˆäº†ã€‚
   ```

   

> äºŒã€è‡ªå®šä¹‰è¿‡æ»¤å™¨å¤„ç†éªŒè¯ç 

1. è‡ªå®šä¹‰WebAuthenticationDetails å’Œ è‡ªå®šä¹‰ AuthenticationProvider



#### è®¤è¯æµç¨‹





### Spring Cloud

å¾®æœåŠ¡ï¼š

```
ä½†é€šå¸¸è€Œè¨€ï¼Œå¾®æœåŠ¡æ˜¯ä¸€ç§æ¶æ„æ¨¡å¼æˆ–è€…è¯´æ˜¯ä¸€ç§æ¶æ„é£æ ¼, å®ƒæå€¡å°†å•ä¸€åº”ç”¨ç¨‹åºåˆ’åˆ†æˆä¸€ç»„å°çš„æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡è¿è¡Œï¼Œåœ¨å…¶ç‹¬ç«‹çš„è‡ªå·±çš„è¿›ç¨‹ä¸­ï¼ŒæœåŠ¡ä¹‹é—´äº’ç›¸åè°ƒã€äº’ç›¸é…åˆ,ä¸ºç”¨æˆ·æä¾›æœ€ç»ˆä»·å€¼ã€‚

æœåŠ¡ä¹‹é—´é‡‡ç”¨è½»é‡çº§çš„é€šä¿¡æœºåˆ¶äº’ç›¸æ²Ÿé€š(é€šå¸¸æ˜¯åŸºäºHTTPçš„RESTful API)ã€‚æ¯ä¸ªæœåŠ¡éƒ½å›´ç»•ç€å…·ä½“ä¸šåŠ¡è¿›è¡Œæ„å»º,å¹¶ç²—èƒ½å¤Ÿè¢«ç‹¬ç«‹åœ°éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒã€ç±»ç”Ÿäº§ç¯å¢ƒç­‰ã€‚

å¦å¤–,å°½é‡é¿å…ç»Ÿä¸€çš„ã€é›†ä¸­å¼çš„æœåŠ¡ç®¡ç†æœºåˆ¶ï¼Œå¯¹å…·ä½“çš„ä¸€ä¸ªæœåŠ¡è€Œè¨€,åº”æ ¹æ®ä¸šåŠ¡ä¸Šä¸‹æ–‡ï¼Œé€‰æ‹©åˆé€‚çš„è¯­è¨€ã€å·¥å…·å¯¹å…¶è¿›è¡Œæ„å»ºï¼Œå¯ä»¥æœ‰ä¸€ä¸ªéå¸¸è½»é‡çº§çš„é›†ä¸­å¼ç®¡ç†æ¥åè°ƒè¿™äº›æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ä¸åŒçš„è¯­è¨€æ¥ç¼–å†™æœåŠ¡,ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸åŒçš„æ•°æ®å­˜å‚¨ã€‚

-----------------------------------------------------------------------------------------

å¾®æœåŠ¡åŒ–çš„æ ¸å¿ƒå°±æ˜¯å°†ä¼ ç»Ÿçš„ä¸€ç«™å¼åº”ç”¨ï¼Œæ ¹æ®ä¸šåŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸€ä¸ªçš„æœåŠ¡,å½»åº•åœ°å»è€¦åˆæ¯ä¸€ä¸ªå¾®æœåŠ¡æä¾›å•ä¸ªä¸šåŠ¡åŠŸèƒ½çš„æœåŠ¡,ä¸€ä¸ªæœåŠ¡åšä¸€ä»¶äº‹,ä»æŠ€æœ¯è§’åº¦çœ‹å°±æ˜¯ä¸€ç§å°è€Œç‹¬ç«‹çš„å¤„ç†è¿‡ç¨‹ï¼Œç±»ä¼¼è¿›ç¨‹æ¦‚å¿µï¼Œèƒ½å¤Ÿè‡ªè¡Œå•ç‹¬å¯åŠ¨æˆ–é”€æ¯ï¼Œå¯ä»¥æ‹¥æœ‰è‡ªå·±ç‹¬ç«‹çš„æ•°æ®åº“ã€‚
```



#### EurekaæœåŠ¡æ³¨å†Œä¸å‘ç°

> Eureka Server æä¾›æœåŠ¡æ³¨å†Œå’Œå‘ç°

> Service ProvideræœåŠ¡æä¾›æ–¹å°†è‡ªèº«æœåŠ¡æ³¨å†Œåˆ°Eurekaï¼Œä»è€Œä½¿æœåŠ¡æ¶ˆè´¹æ–¹èƒ½å¤Ÿæ‰¾åˆ°

> Service ConsumeræœåŠ¡æ¶ˆè´¹æ–¹ä»Eurekaè·å–æ³¨å†ŒæœåŠ¡åˆ—è¡¨ï¼Œä»è€Œèƒ½å¤Ÿæ¶ˆè´¹æœåŠ¡



```
Spring Cloud å°è£…äº† Netflix å…¬å¸å¼€å‘çš„ Eureka æ¨¡å—æ¥å®ç°æœåŠ¡æ³¨å†Œå’Œå‘ç°(è¯·å¯¹æ¯”Zookeeper)ã€‚
Â 
Eureka é‡‡ç”¨äº† C-S çš„è®¾è®¡æ¶æ„ã€‚Eureka Server ä½œä¸ºæœåŠ¡æ³¨å†ŒåŠŸèƒ½çš„æœåŠ¡å™¨ï¼Œå®ƒæ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚
Â 
è€Œç³»ç»Ÿä¸­çš„å…¶ä»–å¾®æœåŠ¡ï¼Œä½¿ç”¨ Eureka çš„å®¢æˆ·ç«¯è¿æ¥åˆ° Eureka Serverå¹¶ç»´æŒå¿ƒè·³è¿æ¥ã€‚è¿™æ ·ç³»ç»Ÿçš„ç»´æŠ¤äººå‘˜å°±å¯ä»¥é€šè¿‡ Eureka Server æ¥ç›‘æ§ç³»ç»Ÿä¸­å„ä¸ªå¾®æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚SpringCloud çš„ä¸€äº›å…¶ä»–æ¨¡å—ï¼ˆæ¯”å¦‚Zuulï¼‰å°±å¯ä»¥é€šè¿‡ Eureka Server æ¥å‘ç°ç³»ç»Ÿä¸­çš„å…¶ä»–å¾®æœåŠ¡ï¼Œå¹¶æ‰§è¡Œç›¸å…³çš„é€»è¾‘ã€‚
è¯·æ³¨æ„å’ŒDubboçš„æ¶æ„å¯¹æ¯”

EurekaåŒ…å«ä¸¤ä¸ªç»„ä»¶ï¼šEureka Serverå’ŒEureka Client
Eureka Serveræä¾›æœåŠ¡æ³¨å†ŒæœåŠ¡
å„ä¸ªèŠ‚ç‚¹å¯åŠ¨åï¼Œä¼šåœ¨EurekaServerä¸­è¿›è¡Œæ³¨å†Œï¼Œè¿™æ ·EurekaServerä¸­çš„æœåŠ¡æ³¨å†Œè¡¨ä¸­å°†ä¼šå­˜å‚¨æ‰€æœ‰å¯ç”¨æœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ŒæœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯å¯ä»¥åœ¨ç•Œé¢ä¸­ç›´è§‚çš„çœ‹åˆ°
Â 
Â 
EurekaClientæ˜¯ä¸€ä¸ªJavaå®¢æˆ·ç«¯ï¼Œç”¨äºç®€åŒ–Eureka Serverçš„äº¤äº’ï¼Œå®¢æˆ·ç«¯åŒæ—¶ä¹Ÿå…·å¤‡ä¸€ä¸ªå†…ç½®çš„ã€ä½¿ç”¨è½®è¯¢(round-robin)è´Ÿè½½ç®—æ³•çš„è´Ÿè½½å‡è¡¡å™¨ã€‚åœ¨åº”ç”¨å¯åŠ¨åï¼Œå°†ä¼šå‘Eureka Serverå‘é€å¿ƒè·³(é»˜è®¤å‘¨æœŸä¸º30ç§’)ã€‚å¦‚æœEureka Serveråœ¨å¤šä¸ªå¿ƒè·³å‘¨æœŸå†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªèŠ‚ç‚¹çš„å¿ƒè·³ï¼ŒEurekaServerå°†ä¼šä»æœåŠ¡æ³¨å†Œè¡¨ä¸­æŠŠè¿™ä¸ªæœåŠ¡èŠ‚ç‚¹ç§»é™¤ï¼ˆé»˜è®¤90ç§’ï¼‰
```



> Eurekaä¿è¯AP

```
Eurekaçœ‹æ˜ç™½äº†è¿™ä¸€ç‚¹, å› æ­¤åœ¨è®¾è®¡æ—¶å°±ä¼˜å…ˆä¿è¯å¯ç”¨æ€§ã€‚Eurekaå„ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å¹³ç­‰çš„,å‡ ä¸ªèŠ‚ç‚¹æŒ‚æ‰ä¸ä¼šå½±å“æ­£å¸¸èŠ‚ç‚¹çš„å·¥ä½œï¼Œå‰©ä½™çš„èŠ‚ç‚¹ä¾ç„¶å¯ä»¥æä¾›æ³¨å†Œå’ŒæŸ¥è¯¢æœåŠ¡ã€‚è€ŒEurekaçš„å®¢æˆ·ç«¯åœ¨å‘æŸä¸ªEurekaæ³¨å†Œæˆ–æ—¶å¦‚æœå‘ç°è¿æ¥å¤±è´¥,åˆ™ä¼šè‡ªåŠ¨åˆ‡æ¢è‡³å…¶å®ƒèŠ‚ç‚¹ï¼Œåªè¦æœ‰ä¸€å°Eurekaè¿˜åœ¨,å°±èƒ½ä¿è¯æ³¨å†ŒæœåŠ¡å¯ç”¨(ä¿è¯å¯ç”¨æ€§)ï¼Œåªä¸è¿‡æŸ¥åˆ°çš„ä¿¡æ¯å¯èƒ½ä¸æ˜¯æœ€æ–°çš„(ä¸ä¿è¯å¼ºä¸€è‡´æ€§)ã€‚

é™¤æ­¤ä¹‹å¤–ï¼ŒEurekaè¿˜æœ‰ä¸€ç§è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œ å¦‚æœåœ¨15åˆ†é’Ÿå†…è¶…è¿‡85%çš„èŠ‚ç‚¹éƒ½æ²¡æœ‰æ­£å¸¸çš„å¿ƒè·³ï¼Œé‚£ä¹ˆEurekaå°±è®¤ä¸ºå®¢æˆ·ç«¯ ä¸æ³¨å†Œä¸­å¿ƒå‡ºç°äº†ç½‘ç»œæ•…éšœï¼Œæ­¤æ—¶ä¼šå‡ºç°ä»¥ä¸‹å‡ ç§æƒ…å†µ:

1. Eurekaä¸å†ä»æ³¨å†Œåˆ—è¡¨ä¸­ç§»é™¤å› ä¸ºé•¿æ—¶é—´æ²¡æ”¶åˆ°å¿ƒè·³è€Œåº”è¯¥è¿‡æœŸçš„æœåŠ¡
2. Eurekaä»ç„¶èƒ½å¤Ÿæ¥å—æ–°æœåŠ¡çš„æ³¨å†Œå’ŒæŸ¥è¯¢è¯·æ±‚,ä½†æ˜¯ä¸ä¼šè¢«åŒæ­¥åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸Š(å³ä¿è¯å½“å‰èŠ‚ç‚¹ä¾ç„¶å¯ç”¨)
3.å½“ç½‘ç»œç¨³å®šæ—¶ï¼Œå½“å‰å®ä¾‹æ–°çš„æ³¨å†Œä¿¡æ¯ä¼šè¢«åŒæ­¥åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸­
å› æ­¤ï¼ŒEurekaå¯ä»¥å¾ˆå¥½çš„åº”å¯¹å› ç½‘ç»œæ•…éšœå¯¼è‡´éƒ¨åˆ†èŠ‚ ç‚¹å¤±å»è”ç³»çš„æƒ…å†µï¼Œè€Œä¸ä¼šåƒzookeeperé‚£æ ·ä½¿æ•´ ä¸ªæ³¨å†ŒæœåŠ¡ç˜«ç—ªã€‚
```



> Zookepperä¿è¯CP

```
å½“å‘æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢æœåŠ¡åˆ—è¡¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å®¹å¿æ³¨å†Œä¸­å¿ƒè¿”å›çš„æ˜¯å‡ åˆ†é’Ÿä»¥å‰çš„æ³¨å†Œä¿¡æ¯ï¼Œä½†ä¸èƒ½æ¥å—æœåŠ¡ç›´æ¥downæ‰ä¸å¯ç”¨ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒæœåŠ¡æ³¨å†ŒåŠŸèƒ½å¯¹å¯ç”¨æ€§çš„è¦æ±‚è¦é«˜äºä¸€è‡´æ€§ã€‚

ä½†æ˜¯zkä¼šå‡ºç°è¿™æ ·ä¸€ç§æƒ…å†µï¼Œ å½“masterèŠ‚ ç‚¹å› ä¸ºç½‘ç»œæ•…éšœä¸å…¶ä»–èŠ‚ç‚¹å¤±å»è”ç³»æ—¶ï¼Œå‰©ä½™èŠ‚ç‚¹ä¼šé‡æ–°è¿›è¡Œleaderé€‰ä¸¾ã€‚é—®é¢˜åœ¨äºï¼Œé€‰ä¸¾leaderçš„æ—¶é—´å¤ªé•¿ï¼Œ 30 ~ 120s,ä¸”é€‰ä¸¾æœŸé—´æ•´ä¸ªzké›†ç¾¤éƒ½æ˜¯ä¸å¯ç”¨çš„,è¿™å°±å¯¼è‡´åœ¨é€‰ä¸¾æœŸé—´æ³¨å†ŒæœåŠ¡ç˜«ç—ªã€‚

åœ¨äº‘éƒ¨ç½²çš„ç¯å¢ƒä¸‹ï¼Œå› ç½‘ç»œé—®é¢˜ä½¿å¾—zké›†ç¾¤å¤±å»masterèŠ‚ç‚¹æ˜¯è¾ƒå¤§æ¦‚ç‡ä¼šå‘ç”Ÿçš„äº‹,è™½ç„¶æœåŠ¡èƒ½å¤Ÿæœ€ç»ˆæ¢å¤ï¼Œä½†æ˜¯æ¼«é•¿çš„é€‰ä¸¾æ—¶é—´å¯¼è‡´çš„æ³¨å†Œé•¿æœŸä¸å¯ç”¨æ˜¯ä¸èƒ½å®¹å¿çš„ã€‚
```



> è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶

```
é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœæ²¡æœ‰è‡ªæˆ‘ä¿æŠ¤ï¼ŒEurekaServeråœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªå¾®æœåŠ¡å®ä¾‹çš„å¿ƒè·³ï¼ŒEurekaServerå°†ä¼šæ³¨é”€è¯¥å®ä¾‹(é»˜è®¤90ç§’)ã€‚ä½†æ˜¯å½“ç½‘ç»œåˆ†åŒºæ•…éšœå‘ç”Ÿæ—¶ï¼Œå¾®æœåŠ¡ä¸EurekaServerä¹‹é—´æ— æ³•æ­£å¸¸é€šä¿¡ï¼Œä»¥ä¸Šè¡Œä¸ºå¯èƒ½å˜å¾—éå¸¸å±é™©äº†ä¸€å› ä¸ºå¾®æœåŠ¡æœ¬èº«å…¶å®æ˜¯å¥åº·çš„ï¼Œæ­¤æ—¶æœ¬ä¸åº”è¯¥æ³¨é”€è¿™ä¸ªå¾®æœåŠ¡ã€‚

Eurekaé€šè¿‡"è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼"æ¥è§£å†³è¿™ä¸ªé—®é¢˜ä¸€å½“EurekaServerèŠ‚ç‚¹åœ¨çŸ­æ—¶é—´å†…ä¸¢å¤±è¿‡å¤šå®¢æˆ·ç«¯æ—¶(å¯èƒ½å‘ç”Ÿäº†ç½‘ç»œåˆ†åŒºæ•…éšœ)ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚ä¸€æ—¦è¿›å…¥è¯¥æ¨¡å¼ï¼ŒEurekaServerå°±ä¼šä¿æŠ¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†åˆ é™¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„æ•°æ®(ä¹Ÿå°±æ˜¯ä¸ä¼šæ³¨é”€ä»»ä½•å¾®æœåŠ¡)ã€‚å½“ç½‘ç»œæ•…éšœæ¢å¤å,è¯¥Eureka ServerèŠ‚ç‚¹ä¼šè‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚

-- æ›´å®¹æ˜“ç†è§£çš„æ–¹å¼
åœ¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ä¸­ï¼ŒEureka Serverä¼šä¿æŠ¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯,ä¸å†æ³¨é”€ä»»ä½•æœåŠ¡å®ä¾‹ã€‚å½“å®ƒæ”¶åˆ°çš„å¿ƒè·³æ•°é‡æ–°æ¢å¤åˆ°é˜ˆå€¼ä»¥ä¸Šæ—¶ï¼Œè¯¥Eureka ServerèŠ‚ç‚¹å°±ä¼šè‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚å®ƒçš„è®¾è®¡å“²å­¦å°±æ˜¯å®å¯ä¿ç•™é”™è¯¯çš„æœåŠ¡æ³¨å†Œä¿¡æ¯ï¼Œä¹Ÿä¸ç›²ç›®æ³¨é”€ä»»ä½•å¯èƒ½å¥åº·çš„æœåŠ¡å®ä¾‹ã€‚ä¸€å¥è¯è®²è§£:å¥½æ­»ä¸å¦‚èµ–æ´»ç€ AP(å¯ç”¨å’Œå®¹é”™)
```



> Bibbonè´Ÿè½½å‡è¡¡

Ribbonæä¾›äº†å¤šç§è´Ÿè½½å‡è¡¡ç­–ç•¥ï¼šæ¯”å¦‚è½®è¯¢(RoundRobinRule)ã€éšæœº(RandomRule)å’Œæ’å—å¢™(RetyRule)ã€æ ¹æ®å“åº”æ—¶é—´åŠ æƒ

```
Spring Cloud Ribbonæ˜¯åŸºäºNetflix Ribbonå®ç°çš„ä¸€å¥— å®¢æˆ·ç«¯Â è´Ÿè½½å‡è¡¡çš„å·¥å…·ã€‚
Â 
ç®€å•çš„è¯´ï¼ŒRibbonæ˜¯Netflixå‘å¸ƒçš„å¼€æºé¡¹ç›®ï¼Œä¸»è¦åŠŸèƒ½æ˜¯æä¾›å®¢æˆ·ç«¯çš„è½¯ä»¶è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œå°†Netflixçš„ä¸­é—´å±‚æœåŠ¡è¿æ¥åœ¨ä¸€èµ·ã€‚Ribbonå®¢æˆ·ç«¯ç»„ä»¶æä¾›ä¸€ç³»åˆ—å®Œå–„çš„é…ç½®é¡¹å¦‚è¿æ¥è¶…æ—¶ï¼Œé‡è¯•ç­‰ã€‚ç®€å•çš„è¯´ï¼Œå°±æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­åˆ—å‡ºLoad Balancerï¼ˆç®€ç§°LBï¼‰åé¢æ‰€æœ‰çš„æœºå™¨ï¼ŒRibbonä¼šè‡ªåŠ¨çš„å¸®åŠ©ä½ åŸºäºæŸç§è§„åˆ™ï¼ˆå¦‚ç®€å•è½®è¯¢ï¼Œéšæœºè¿æ¥ç­‰ï¼‰å»è¿æ¥è¿™äº›æœºå™¨ã€‚æˆ‘ä»¬ä¹Ÿå¾ˆå®¹æ˜“ä½¿ç”¨Ribbonå®ç°è‡ªå®šä¹‰çš„è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚

LBï¼Œå³è´Ÿè½½å‡è¡¡(Load Balance)ï¼Œåœ¨å¾®æœåŠ¡æˆ–åˆ†å¸ƒå¼é›†ç¾¤ä¸­ç»å¸¸ç”¨çš„ä¸€ç§åº”ç”¨ã€‚
è´Ÿè½½å‡è¡¡ç®€å•çš„è¯´å°±æ˜¯å°†ç”¨æˆ·çš„è¯·æ±‚å¹³æ‘Šçš„åˆ†é…åˆ°å¤šä¸ªæœåŠ¡ä¸Šï¼Œä»è€Œè¾¾åˆ°ç³»ç»Ÿçš„HAã€‚
å¸¸è§çš„è´Ÿè½½å‡è¡¡æœ‰è½¯ä»¶Nginxï¼ŒLVSï¼Œç¡¬ä»¶ F5ç­‰ã€‚
ç›¸åº”çš„åœ¨ä¸­é—´ä»¶ï¼Œä¾‹å¦‚ï¼šdubboå’ŒSpringCloudä¸­å‡ç»™æˆ‘ä»¬æä¾›äº†è´Ÿè½½å‡è¡¡ï¼ŒSpringCloudçš„è´Ÿè½½å‡è¡¡ç®—æ³•å¯ä»¥è‡ªå®šä¹‰ã€‚Â 
```



> Feignè´Ÿè½½å‡è¡¡

Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„WebæœåŠ¡å®¢æˆ·ç«¯ï¼Œ ä½¿å¾—ç¼–å†™WebæœåŠ¡å®¢æˆ·ç«¯å˜å¾—éå¸¸å®¹æ˜“,
**åªéœ€è¦åˆ›å»ºä¸€ä¸ªæ¥å£ï¼Œç„¶ååœ¨ä¸Šé¢æ·»åŠ æ³¨è§£å³å¯**ã€‚
å‚è€ƒå®˜ç½‘: https://github.com/OpenFeign/feign



> Feignèƒ½å¹²ä»€ä¹ˆ

```
Feignæ—¨åœ¨ä½¿ç¼–å†™Java Httpå®¢æˆ·ç«¯å˜å¾—æ›´å®¹æ˜“ã€‚
å‰é¢åœ¨ä½¿ç”¨Ribbon + RestTemplateæ—¶ï¼Œåˆ©ç”¨RestTemplateå¯¹httpè¯·æ±‚çš„å°è£…å¤„ç†ï¼Œå½¢æˆäº†ä¸€å¥—æ¨¡ç‰ˆåŒ–çš„è°ƒç”¨æ–¹æ³•ã€‚ä½†æ˜¯åœ¨å®é™…
å¼€å‘ä¸­ï¼Œç”±äºå¯¹æœåŠ¡ä¾èµ–çš„è°ƒç”¨å¯èƒ½ä¸æ­¢ä¸€å¤„ï¼Œå¾€å¾€ä¸€ä¸ªæ¥å£ä¼šè¢«å¤šå¤„è°ƒç”¨ï¼Œæ‰€ä»¥é€šå¸¸éƒ½ä¼šé’ˆå¯¹æ¯ä¸ªå¾®æœåŠ¡è‡ªè¡Œå°è£…ä¸€ äº›å®¢æˆ·ç«¯
ç±»æ¥åŒ…è£…è¿™äº›ä¾èµ–æœåŠ¡çš„è°ƒç”¨ã€‚æ‰€ä»¥Feignåœ¨æ­¤åŸºç¡€ä¸Šåšäº†è¿›ä¸€ æ­¥å°è£…ï¼Œç”±ä»–æ¥å¸®åŠ©æˆ‘ä»¬å®šä¹‰å’Œå®ç°ä¾èµ–æœåŠ¡æ¥å£çš„å®šä¹‰ã€‚åœ¨
Feignçš„å®ç°ä¸‹ï¼Œæˆ‘ä»¬åªéœ€åˆ›å»ºä¸€ä¸ªæ¥å¹¶ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥é…ç½®å®ƒ(ä»¥å‰æ˜¯Daoæ¥å£ï¼Œä¸Šé¢æ ‡æ³¨Mapperæ³¨è§£ç°åœ¨æ˜¯ä¸€ ä¸ªå¾®æœåŠ¡æ¥å£
ä¸Šé¢æ ‡æ³¨ä¸€ä¸ªFeignæ³¨è§£å³å¯)ï¼Œ å³å¯å®Œæˆå¯¹æœåŠ¡æä¾›æ–¹çš„æ¥å£ç»‘å®š,ç®€åŒ–äº†ä½¿ç”¨Spring cloud Ribbonæ—¶ï¼Œè‡ªåŠ¨å°è£…æœåŠ¡è°ƒç”¨å®¢æˆ·
ç«¯çš„å¼€å‘é‡ã€‚
```



#### Ribbonä¸Feign

```
1.å¾®æœåŠ¡åå­—è·å¾—è°ƒç”¨åœ°å€
2.å°±æ˜¯é€šè¿‡æ¥å£+æ³¨è§£ï¼Œè·å¾—æˆ‘ä»¬çš„è°ƒç”¨æœåŠ¡ã€‚
```



#### Hystrixæ–­è·¯å™¨

å‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªç¬¦åˆé¢„æœŸçš„ã€å¯å¤„ç†çš„å¤‡é€‰å“åº”(FallBack) ,è€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…æˆ–è€…æŠ›å‡ºè°ƒç”¨æ–¹æ— æ³•å¤„ç†çš„å¼‚å¸¸

```
å¤æ‚åˆ†å¸ƒå¼ä½“ç³»ç»“æ„ä¸­çš„åº”ç”¨ç¨‹åºæœ‰æ•°åä¸ªä¾èµ–å…³ç³»ï¼Œæ¯ä¸ªä¾èµ–å…³ç³»åœ¨æŸäº›æ—¶å€™å°†ä¸å¯é¿å…åœ°å¤±è´¥ã€‚
Hystrixæ˜¯ä¸€ä¸ªç”¨äºå¤„ç†åˆ†å¸ƒå¼ç³»ç»Ÿçš„å»¶è¿Ÿå’Œå®¹é”™çš„å¼€æºåº“,åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œ,è®¸å¤šä¾èµ–ä¸å¯é¿å…çš„ä¼šè°ƒç”¨å¤±è´¥,æ¯”å¦‚è¶…æ—¶ã€å¼‚å¸¸ç­‰ï¼ŒHystrixèƒ½å¤Ÿä¿è¯åœ¨ä¸€ä¸ªä¾èµ–å‡ºé—®é¢˜çš„æƒ…å†µä¸‹ï¼Œä¸ä¼šå¯¼è‡´æ•´ä½“æœåŠ¡å¤±è´¥,é¿å…çº§è”æ•…éšœ,ä»¥æé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼¹æ€§ã€‚
"æ–­è·¯å™¨â€æœ¬èº«æ˜¯ä¸€ç§å¼€å…³è£…ç½®,å½“æŸä¸ªæœåŠ¡å•å…ƒå‘ç”Ÿæ•…éšœä¹‹å,é€šè¿‡æ–­è·¯å™¨çš„æ•…éšœç›‘æ§(ç±»ä¼¼ç†”æ–­ä¿é™©ä¸)ï¼Œå‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªç¬¦åˆé¢„æœŸçš„ã€å¯å¤„ç†çš„å¤‡é€‰å“åº”(FallBack) ,è€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…æˆ–è€…æŠ›å‡ºè°ƒç”¨æ–¹æ— æ³•å¤„ç†çš„å¼‚å¸¸,è¿™æ ·å°±ä¿è¯äº†æœåŠ¡è°ƒç”¨æ–¹çš„
çº¿ç¨‹ä¸ä¼šè¢«é•¿æ—¶é—´ã€ä¸å¿…è¦åœ°å ç”¨ï¼Œä»è€Œé¿å…äº†æ•…éšœåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è”“å»¶ï¼Œä¹ƒè‡³é›ªå´©ã€‚
```



>æœåŠ¡é›ªå´©

```
å¤šä¸ªå¾®æœåŠ¡ä¹‹é—´è°ƒç”¨çš„æ—¶å€™ï¼Œå‡è®¾å¾®æœåŠ¡Aè°ƒç”¨å¾®æœåŠ¡Bå’Œå¾®æœåŠ¡Cï¼Œå¾®æœåŠ¡Bå’Œå¾®æœåŠ¡Cåˆè°ƒç”¨å…¶å®ƒçš„å¾®æœåŠ¡,è¿™å°±æ˜¯æ‰€è°“çš„â€œæ‰‡å‡ºâ€ã€‚
å¦‚æœæ‰‡å‡ºçš„é“¾è·¯ä¸ŠæŸä¸ªå¾®æœåŠ¡çš„è°ƒç”¨å“åº”æ—¶é—´è¿‡é•¿æˆ–è€…ä¸å¯ç”¨ï¼Œå¯¹å¾®æœåŠ¡Açš„è°ƒç”¨å°±ä¼šå ç”¨è¶Šæ¥è¶Šå¤šçš„ç³»ç»Ÿèµ„æº,è¿›è€Œå¼•èµ·ç³»ç»Ÿå´©æºƒ,æ‰€è°“çš„â€œé›ªå´©æ•ˆåº”â€.

å¯¹äºé«˜æµé‡çš„åº”ç”¨æ¥è¯´ï¼Œå•ä¸€çš„åç«¯ä¾èµ–å¯èƒ½ä¼šå¯¼è‡´æ‰€æœ‰æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰èµ„æºéƒ½åœ¨å‡ ç§’é’Ÿå†…é¥±å’Œã€‚æ¯”å¤±è´¥æ›´ç³Ÿç³•çš„æ˜¯,è¿™äº›åº”ç”¨ç¨‹
åºè¿˜å¯èƒ½å¯¼è‡´æœåŠ¡ä¹‹é—´çš„å»¶è¿Ÿå¢åŠ ï¼Œå¤‡ä»½é˜Ÿåˆ—ï¼Œçº¿ç¨‹å’Œå…¶ä»–ç³»ç»Ÿèµ„æºç´§å¼ ï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå‘ç”Ÿæ›´å¤šçš„çº§è”æ•…éšœã€‚è¿™äº›éƒ½è¡¨ç¤ºéœ€è¦å¯¹
æ•…éšœå’Œå»¶è¿Ÿè¿›è¡Œéš”ç¦»å’Œç®¡ç†ï¼Œä»¥ä¾¿å•ä¸ªä¾èµ–å…³ç³»çš„å¤±è´¥ï¼Œä¸èƒ½å–æ¶ˆæ•´ä¸ªåº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿã€‚
```



> æœåŠ¡ç†”æ–­

ä¸€èˆ¬æ˜¯æŸä¸ªæœåŠ¡æ•…éšœæˆ–è€…å¼‚å¸¸å¼•èµ·ç±»ä¼¼ç°å®ä¸–ç•Œä¸­çš„â€œä¿é™©ä¸â€œï¼Œ å½“æŸä¸ªå¼‚å¸¸æ¡ä»¶è¢«è§¦å‘ï¼Œç›´æ¥ç†”æ–­æ•´ä¸ªæœåŠ¡ï¼Œè€Œä¸æ˜¯ä¸€ç›´ç­‰åˆ°æ­¤æœåŠ¡è¶…æ—¶å¯¼è‡´é›ªå´©ã€‚

```
ç†”æ–­æœºåˆ¶æ˜¯åº”å¯¹é›ªå´©æ•ˆåº”çš„ä¸€ç§å¾®æœåŠ¡é“¾è·¯ä¿æŠ¤æœºåˆ¶ã€‚
å½“æ‰‡å‡ºé“¾è·¯çš„æŸä¸ªå¾®æœåŠ¡ä¸å¯ç”¨æˆ–è€…å“åº”æ—¶é—´å¤ªé•¿æ—¶ï¼Œä¼šè¿›è¡ŒæœåŠ¡çš„é™çº§,è¿›è€Œç†”æ–­è¯¥èŠ‚ç‚¹å¾®æœåŠ¡çš„è°ƒç”¨,å¿«é€Ÿè¿”å›â€é”™è¯¯â€çš„å“åº”ä¿¡æ¯ã€‚
å½“æ£€æµ‹åˆ°è¯¥èŠ‚ç‚¹å¾®æœåŠ¡è°ƒç”¨å“åº”æ­£å¸¸åæ¢å¤è°ƒç”¨é“¾è·¯ã€‚åœ¨SpringCloudæ¡†æ¶é‡Œç†”æ–­æœºåˆ¶é€šè¿‡Hystrixå®ç°ã€‚
Hystrixä¼šç›‘æ§å¾®æœåŠ¡é—´è°ƒç”¨çš„çŠ¶å†µï¼Œå½“å¤±è´¥çš„è°ƒç”¨åˆ°ä¸€å®šé˜ˆå€¼,ç¼ºçœæ˜¯5ç§’å†…20æ¬¡è°ƒç”¨å¤±è´¥å°±ä¼šå¯åŠ¨ç†”æ–­æœºåˆ¶ã€‚ç†”æ–­æœºåˆ¶çš„æ³¨è§£æ˜¯@HystrixCommand.
```



> æœåŠ¡é™çº§

```
æ‰€è°“é™çº§ï¼Œ ä¸€èˆ¬æ˜¯ä»æ•´ä½“è´Ÿè·è€ƒè™‘ã€‚å°±æ˜¯å½“æŸä¸ªæœåŠ¡ç†”æ–­ä¹‹åï¼ŒæœåŠ¡å™¨å°†ä¸å†è¢«è°ƒç”¨
æ­¤æ—¶å®¢æˆ·ç«¯å¯ä»¥è‡ªå·±å‡†å¤‡ä¸€ä¸ªæœ¬åœ°çš„fallbackå›è°ƒï¼Œ è¿”å›ä¸€ä¸ªç¼ºçœå€¼ã€‚
è¿™æ ·åšï¼Œè™½ç„¶æœåŠ¡æ°´å¹³ä¸‹é™ï¼Œä½†å¥½æ­¹å¯ç”¨ï¼Œæ¯”ç›´æ¥æŒ‚æ‰è¦å¼ºã€‚

æ•´ä½“èµ„æºå¿«ä¸å¤Ÿäº†ï¼Œå¿ç—›å°†æŸäº›æœåŠ¡å…ˆå…³æ‰ï¼Œå¾…æ¸¡è¿‡éš¾å…³ï¼Œå†å¼€å¯å›æ¥
æœåŠ¡é™çº§å¤„ç†æ˜¯åœ¨å®¢æˆ·ç«¯å®ç°å®Œæˆçš„ï¼Œä¸æœåŠ¡ç«¯æ²¡æœ‰å…³ç³»
è®©å®¢æˆ·ç«¯åœ¨æœåŠ¡ç«¯ä¸å¯ç”¨æ—¶ä¹Ÿä¼šè·å¾—æç¤ºä¿¡æ¯è€Œä¸ä¼šæŒ‚èµ·è€—æ­»æœåŠ¡å™¨
```



> æœåŠ¡ç›‘æ§hystrixDashboard

```
é™¤äº†éš”ç¦»ä¾èµ–æœåŠ¡çš„è°ƒç”¨ä»¥å¤–ï¼ŒHystrixè¿˜æä¾›äº†å‡†å®æ—¶çš„è°ƒç”¨ç›‘æ§ï¼ˆHystrix Dashboardï¼‰ï¼ŒHystrixä¼šæŒç»­åœ°è®°å½•æ‰€æœ‰é€šè¿‡Hystrixå‘èµ·çš„è¯·æ±‚çš„æ‰§è¡Œä¿¡æ¯ï¼Œå¹¶ä»¥ç»Ÿè®¡æŠ¥è¡¨å’Œå›¾å½¢çš„å½¢å¼å±•ç¤ºç»™ç”¨æˆ·ï¼ŒåŒ…æ‹¬æ¯ç§’æ‰§è¡Œå¤šå°‘è¯·æ±‚å¤šå°‘æˆåŠŸï¼Œå¤šå°‘å¤±è´¥ç­‰ã€‚Netflixé€šè¿‡hystrix-metrics-event-streamé¡¹ç›®å®ç°äº†å¯¹ä»¥ä¸ŠæŒ‡æ ‡çš„ç›‘æ§ã€‚Spring Cloudä¹Ÿæä¾›äº†Hystrix Dashboardçš„æ•´åˆï¼Œå¯¹ç›‘æ§å†…å®¹è½¬åŒ–æˆå¯è§†åŒ–ç•Œé¢ã€‚
```



> å¦‚ä½•çœ‹ç›‘æµ‹æ•°æ®ï¼š7è‰² 1åœˆ 1çº¿

å‚è€ƒï¼š [Hystrixä»ªè¡¨ç›˜ç›‘æ§HystrixDashboard](https://www.cnblogs.com/coding-farmer/p/12032403.html)

```
7è‰²ï¼š
	ç»¿ æˆåŠŸè‰²
	è“ ç†”æ–­æ•°
	é’ é”™è¯¯è¯·æ±‚æ•°
	é»„ è¶…æ—¶æ•°
	ç´« çº¿ç¨‹æ‹’ç»æ•°
	çº¢ å¤±è´¥/å¼‚å¸¸æ•°
	ç° æœ€è¿‘10sé”™è¯¯ç™¾åˆ†æ¯”

å®å¿ƒåœ†ï¼šå…±æœ‰ä¸¤ç§å«ä¹‰ã€‚å®ƒé€šè¿‡é¢œè‰²çš„å˜åŒ–ä»£è¡¨äº†å®ä¾‹çš„å¥åº·ç¨‹åº¦ï¼Œå®ƒçš„å¥åº·åº¦ä»ç»¿è‰²<é»„è‰²<æ©™è‰²<çº¢è‰²é€’å‡ã€‚
è¯¥å®å¿ƒåœ†é™¤äº†é¢œè‰²çš„å˜åŒ–ä¹‹å¤–ï¼Œå®ƒçš„å¤§å°ä¹Ÿä¼šæ ¹æ®å®ä¾‹çš„è¯·æ±‚æµé‡å‘ç”Ÿå˜åŒ–ï¼Œæµé‡è¶Šå¤§è¯¥å®å¿ƒåœ†å°±è¶Šå¤§ã€‚æ‰€ä»¥é€šè¿‡è¯¥å®å¿ƒåœ†çš„å±•ç¤ºï¼Œå°±å¯ä»¥åœ¨å¤§é‡çš„å®ä¾‹ä¸­å¿«é€Ÿçš„å‘ç° æ•…éšœå®ä¾‹å’Œé«˜å‹åŠ›å®ä¾‹ã€‚

æ›²çº¿ï¼šç”¨æ¥è®°å½•2åˆ†é’Ÿå†…æµé‡çš„ç›¸å¯¹å˜åŒ–ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥è§‚å¯Ÿåˆ°æµé‡çš„ä¸Šå‡å’Œä¸‹é™è¶‹åŠ¿ã€‚
```



#### Zuulè·¯ç”±ç½‘å…³

ZuulåŒ…å«äº†å¯¹è¯·æ±‚çš„è·¯ç”±å’Œè¿‡æ»¤ä¸¤ä¸ªæœ€ä¸»è¦çš„åŠŸèƒ½ï¼š

```
å…¶ä¸­è·¯ç”±åŠŸèƒ½è´Ÿè´£å°†å¤–éƒ¨è¯·æ±‚è½¬å‘åˆ°å…·ä½“çš„å¾®æœåŠ¡å®ä¾‹ä¸Šï¼Œæ˜¯å®ç°å¤–éƒ¨è®¿é—®ç»Ÿä¸€å…¥å£çš„åŸºç¡€è€Œè¿‡æ»¤å™¨åŠŸèƒ½åˆ™è´Ÿè´£å¯¹è¯·æ±‚çš„å¤„ç†è¿‡ç¨‹è¿›è¡Œå¹²é¢„ï¼Œæ˜¯å®ç°è¯·æ±‚æ ¡éªŒã€æœåŠ¡èšåˆç­‰åŠŸèƒ½çš„åŸºç¡€.

Zuulå’ŒEurekaè¿›è¡Œæ•´åˆï¼Œå°†Zuulè‡ªèº«æ³¨å†Œä¸ºEurekaæœåŠ¡æ²»ç†ä¸‹çš„åº”ç”¨ï¼ŒåŒæ—¶ä»Eurekaä¸­è·å¾—å…¶ä»–å¾®æœåŠ¡çš„æ¶ˆæ¯ï¼Œä¹Ÿå³ä»¥åçš„è®¿é—®å¾®æœåŠ¡éƒ½æ˜¯é€šè¿‡Zuulè·³è½¬åè·å¾—ã€‚

æ³¨æ„ï¼šZuulæœåŠ¡æœ€ç»ˆè¿˜æ˜¯ä¼šæ³¨å†Œè¿›Eureka

æä¾›=ä»£ç†+è·¯ç”±+è¿‡æ»¤ä¸‰å¤§åŠŸèƒ½
```

 

 

#### Configåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ

> æ˜¯ä»€ä¹ˆ

```
SpringCloud Configä¸ºå¾®æœåŠ¡æ¶æ„ä¸­çš„å¾®æœåŠ¡æä¾›é›†ä¸­åŒ–çš„å¤–éƒ¨é…ç½®æ”¯æŒï¼Œé…ç½®æœåŠ¡å™¨ä¸ºå„ä¸ªä¸åŒå¾®æœåŠ¡åº”ç”¨çš„æ‰€æœ‰ç¯å¢ƒæä¾›äº†ä¸€ä¸ªä¸­å¿ƒåŒ–çš„å¤–éƒ¨é…ç½®ã€‚
```



> æ€ä¹ˆç©

```
SpringCloud Configåˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ä¸¤éƒ¨åˆ†ã€‚

æœåŠ¡ç«¯ä¹Ÿç§°ä¸ºåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒï¼Œå®ƒæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„å¾®æœåŠ¡åº”ç”¨ï¼Œç”¨æ¥è¿æ¥é…ç½®æœåŠ¡å™¨å¹¶ä¸ºå®¢æˆ·ç«¯æä¾›è·å–é…ç½®ä¿¡æ¯,åŠ å¯†/è§£å¯†ä¿¡æ¯ç­‰è®¿é—®æ¥å£

å®¢æˆ·ç«¯åˆ™æ˜¯é€šè¿‡æŒ‡å®šçš„é…ç½®ä¸­å¿ƒæ¥ç®¡ç†åº”ç”¨èµ„æºï¼Œä»¥åŠä¸ä¸šåŠ¡ç›¸å…³çš„é…ç½®å†…å®¹,å¹¶åœ¨å¯åŠ¨çš„æ—¶å€™ä»é…ç½®ä¸­å¿ƒè·å–å’ŒåŠ è½½é…ç½®ä¿¡æ¯
é…ç½®æœåŠ¡å™¨é»˜è®¤é‡‡ç”¨gitæ¥å­˜å‚¨é…ç½®ä¿¡æ¯,è¿™æ ·å°±æœ‰åŠ©äºå¯¹ç¯å¢ƒé…ç½®è¿›è¡Œç‰ˆæœ¬ç®¡ç†,å¹¶ä¸”å¯ä»¥é€šè¿‡gitå®¢æˆ·ç«¯å·¥å…·æ¥æ–¹ä¾¿çš„ç®¡ç†å’Œè®¿é—®é…ç½®å†…å®¹ã€‚
```



> åˆ†å¸ƒå¼é¢ä¸´çš„é…ç½®é—®é¢˜

```
å¾®æœåŠ¡æ„å‘³ç€è¦å°†å•ä½“åº”ç”¨ä¸­çš„ä¸šåŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸ª å­æœåŠ¡ï¼Œæ¯ä¸ªæœåŠ¡çš„ç²’åº¦ç›¸å¯¹è¾ƒå°ï¼Œå› æ­¤ç³»ç»Ÿä¸­ä¼šå‡ºç°å¤§é‡çš„æœåŠ¡ã€‚ç”±äºæ¯ä¸ª
æœåŠ¡éƒ½éœ€è¦å¿…è¦çš„é…ç½®ä¿¡æ¯æ‰èƒ½è¿è¡Œï¼Œæ‰€ä»¥ä¸€é›†ä¸­å¼çš„ã€åŠ¨æ€çš„é…ç½®ç®¡ç†è®¾æ–½æ˜¯å¿…ä¸å¯å°‘çš„ã€‚SpringCloudæä¾› äº†
ConfigServeræ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¯ä¸€ä¸ªå¾®æœåŠ¡è‡ªå·±å¸¦ç€ä¸€ ä¸ªapplication.yml,. ä¸Šç™¾ä¸ªé…ç½®æ–‡ä»¶çš„ç®¡ç†...

ConfigæŸ¥çœ‹é…ç½®ä¿¡æ¯ï¼šhttp://127.0.0.1:3344/application-dev.yml
```



> bootstrap.yml

```
applicaiton.ymlæ˜¯ç”¨æˆ·çº§çš„èµ„æºé…ç½®é¡¹
bootstrap.ymlæ˜¯ç³»ç»Ÿçº§çš„ï¼Œä¼˜å…ˆçº§æ›´åŠ é«˜

Spring Cloudä¼šåˆ›å»ºä¸€ä¸ªBootstrap Context',ä½œä¸ºSpringåº”ç”¨çš„Application Context'çš„çˆ¶ä¸Šä¸‹æ–‡ã€‚
åˆå§‹åŒ–çš„æ—¶å€™,Bootstrap Contextè´Ÿè´£ä»å¤–éƒ¨æºåŠ è½½é…ç½®å±æ€§å¹¶è§£æé…ç½®ã€‚è¿™ä¸¤ä¸ªä¸Šä¸‹æ–‡å…±äº«ä¸€ä¸ªä»å¤–éƒ¨è·å–çš„â€œEnvironment'ã€‚
Bootstrap'å±æ€§æœ‰é«˜ä¼˜å…ˆçº§,é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä»¬ä¸ä¼šè¢«æœ¬åœ°é…ç½®è¦†ç›–ã€‚'Bootstrap context'å’ŒApplication Context'æœ‰ç€ä¸åŒçš„çº¦å®š,æ‰€ä»¥æ–°å¢äº†ä¸€ä¸ªbootstrap.ymlæ–‡ä»¶, ä¿è¯Bootstrap Context'å’ŒApplication Context'é…ç½®çš„åˆ†ç¦»ã€‚
```



### Spring Cloud Alibaba

```
SpringCloudçš„å‡ å¤§ç—›ç‚¹
    SpringCloudéƒ¨åˆ†ç»„ä»¶åœæ­¢ç»´æŠ¤æ›´æ–°ï¼Œéƒ¨åˆ†ä¸å†å¼€æºï¼Œç»™å¼€å‘å¸¦æ¥ä¸ä¾¿;
    SpringCloudéƒ¨åˆ†ç¯å¢ƒæ­å»ºå¤æ‚ï¼Œæ²¡æœ‰å®Œå–„çš„å¯è§†åŒ–ç•Œé¢ï¼Œæˆ‘ä»¬éœ€è¦å¤§é‡çš„äºŒæ¬¡å¼€å‘å’Œå®šåˆ¶
    SpringCloudé…ç½®å¤æ‚ï¼Œéš¾ä»¥ä¸Šæ‰‹ï¼Œéƒ¨åˆ†é…ç½®å·®åˆ«éš¾ä»¥åŒºåˆ†å’Œåˆç†åº”ç”¨

SpringCloud Alibabaçš„ä¼˜åŠ¿:
    é˜¿é‡Œä½¿ç”¨è¿‡çš„ç»„ä»¶ç»å†äº†è€ƒéªŒï¼Œæ€§èƒ½å¼ºæ‚ï¼Œè®¾è®¡åˆç†ï¼Œç°åœ¨å¼€æºå‡ºæ¥å¤§å®¶ç”¨
    æˆå¥—çš„äº§å“æ­é…å®Œå–„çš„å¯è§†åŒ–ç•Œé¢ç»™å¼€å‘è¿ç»´å¸¦æ¥æå¤§çš„ä¾¿åˆ©
    æ­å»ºç®€å•ï¼Œå­¦ä¹ æ›²çº¿ä½ã€‚
    
SpringCloud Alibaba æœ€ç»ˆæŠ€æœ¯æ­é…æ–¹æ¡ˆ
    SpringCloud Alibaba - Nacos:æ³¨å†Œä¸­å¿ƒ(æœåŠ¡å‘ç°/æ³¨å†Œ)
    SpringCloud Alibaba - Nacos:é…ç½®ä¸­å¿ƒ(åŠ¨æ€é…ç½®ç®¡ç†)
    SpringCloud - Ribbon: è´Ÿè½½å‡è¡¡
    SpringCloud - Feign: å£°æ˜å¼httPå®¢æˆ·ç«¯(è°ƒç”¨è¿œç¨‹æœåŠ¡ï¼Œfeigné—­æºï¼Œä½¿ç”¨çš„openFeign)
    SpringCloud Alibaba - Sentinel: æœåŠ¡å®¹é”™(é™æµã€é™çº§ã€ç†”æ–­)
    SpringCloud - Gateway: APIç½‘å…³(webflux ç¼–ç¨‹æ¨¡å¼)
    SpringCloud - Sleuth: è°ƒç”¨é“¾ç›‘æ§
    SpringCloud Alibaba - Seata: åŸFescar, å³åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ

ç‰ˆæœ¬é€‰æ‹©
    Spring Cloud Version		Spring Cloud Alibaba 	Version Spring Boot Version
    -----						-----					-----
    Spring Cloud Greenwich		2.1.x.RELEASE			2.1.x. RELEASE
    Spring Cloud Finchley		2.0.x.RELEASE			2.0.x.RELEASE
    Spring Cloud Edgware		1 5.x.RELEASE			1 5.x.RELEASE
    
    
ä¾èµ–ç»Ÿä¸€ç®¡ç†ï¼Œç„¶ååœ¨æ–°åˆ›å»ºdependenciesæ ‡ç­¾ä¸­æ·»åŠ è‡ªå·±æ‰€éœ€è¦çš„ä»¥æ¥ï¼Œæ— éœ€å†™ç‰ˆæœ¬å·
	<dependencyManagement>
        <dependencies>
            <dependency>
                <groupId>com.alibaba.cloud</groupId>
                <artifactId>spring-cloud-alibaba-dependencies</artifactId>
                <version>2.1.0.RELEASE</version>
                <type>pom</type>
                <scope>import</scope>
            </dependency>
        </dependencies>
    </dependencyManagement>
```



#### Nacos

> Nacosæ³¨å†Œé…ç½®ä¸­å¿ƒ

```
è®°å½•æ‰€æœ‰çš„æœåŠ¡ä¿¡æ¯ï¼Œä»¥Map<String,List<Object>>å­˜å‚¨ä¸ªæœåŠ¡ä¿¡æ¯ï¼Œkeyä¸ºæœåŠ¡åï¼Œæˆ‘ä»¬é€šè¿‡æœåŠ¡åå°±å¯ä»¥å–ã€‚
è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡ï¼Œè·å–æ‰€æœ‰æœåŠ¡ï¼Œå®ƒé‡‡ç”¨ç­–ç•¥æ¨¡å¼ï¼Œå°±æ˜¯å£°æ˜æ¥å£ï¼Œæˆ‘ä»¬åªéœ€è¦å»ç»§æ‰¿è¯¥æ¥å£ï¼Œå®ç°è¿”å›æœåŠ¡çš„æ–¹æ³•å°±å¯ä»¥ã€‚
```



```
1.å¼•å…¥ä¾èµ–
    <dependency>
        <groupId>com.alibaba.cloud</groupId>
        <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>
    </dependency>
    
2.åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œé…ç½®Nacos Serveråœ°å€
	#ä¸€ã€
	spring.cloud.nacos.discovery.server-addr=127.0.0.1:8848
	spring.application.name=gulimall-coupon
	
	#äºŒã€
	#spring:
    #  cloud:
    #    nacos:
    #      discovery:
    #        server-addr: 127.0.0.1:8848
    #  application:
    #    name: gulimall-coupon

3.ä½¿ç”¨@EnableDiscoveryClientæ³¨è§£å¼€å¯æœåŠ¡æ³¨å†Œä¸å‘ç°åŠŸèƒ½
    @EnableDiscoveryClient
    @SpringBootApplication
    public class Application{
        public static void main(String[] args) {
            SpringApplication.run(Application.class, args);
        }
    }

4.å¯åŠ¨NacosæœåŠ¡ï¼Œå¯åŠ¨å¾®æœåŠ¡
```



> Nacosé…ç½®ä¸­å¿ƒç®¡ç†

```
æœ¬åœ°åº”ç”¨è¯»å–æˆ‘ä»¬äº‘ç«¯åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒæ–‡ä»¶(ç¬¬ä¸€æ¬¡å»ºç«‹é•¿è¿æ¥)ã€‚
æœ¬åœ°åº”ç”¨è¯»å–åˆ°é…ç½®æ–‡ä»¶ä¹‹åï¼Œæœ¬åœ°jvmå’Œç¡¬ç›˜ä¸­éƒ½ä¼šç¼“å­˜ä¸€ä»½ã€‚
æœ¬åœ°åº”ç”¨ä¸åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒæœåŠ¡å™¨ç«¯ä¸€ç›´ä¿æŒé•¿è¿æ¥.
å½“æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶å‘ç”Ÿå˜åŒ–(MD5|ç‰ˆæœ¬å·)å®ç°åŒºåˆ†ï¼Œå°†å˜åŒ–ç»“æœé€šçŸ¥ç»™æˆ‘ä»¬çš„æœ¬åœ°åº”ç”¨ï¼ŒåŠæ—¶çš„åˆ·æ–°æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶
```



```
1.å¼•å…¥ä¾èµ–
    <dependency>
        <groupId>com.alibaba.cloud</groupId>
        <artifactId>spring-cloud-starter-alibaba-nacos-config</artifactId>
    </dependency>

2.åˆ›å»ºbootstrap.propertiesæ–‡ä»¶(ä¼˜å…ˆçº§åˆ«é«˜)
	# é»˜è®¤æ ¹æ®æœåŠ¡å è·å–Nacosä¸­propertiesæ–‡ä»¶åŠ è½½é…ç½® å¦‚æœæ²¡æœ‰ åˆ™åŠ è½½ç¨‹åºçš„application.properties
    spring.application.name=gulimall-coupon
    spring.cloud.nacos.config.server-addr=127.0.0.1:8848

3.ç»™åœ¨Nacosé…ç½®ä¸­å¿ƒæ·»åŠ æ•°æ®é›†(Data Id) gulimall-coupon.properties
	è®¾ç½®è¯¥æœåŠ¡çš„ç›¸å…³é…ç½®ä¿¡æ¯

4.åŠ¨æ€åˆ·æ–°é…ç½®
    @RefreshScope: åŠ¨æ€è·å–å¹¶åˆ·æ–°é…ç½®ï¼Œç»™ç±»æ·»åŠ 
    @Value("${é…ç½®é¡¹å}"): è·å–é…ç½®
```



> Nacosåˆ†å¸ƒå¼é…ç½®ç®¡ç†ç»†èŠ‚

```
1ï¼‰ã€å‘½åç©ºé—´ï¼šé…ç½®éš”ç¦»ï¼›
	é»˜è®¤ï¼špublic(ä¿ç•™ç©ºé—´)ï¼›é»˜è®¤æ–°å¢çš„æ‰€æœ‰é…ç½®éƒ½åœ¨publicç©ºé—´ã€‚
	1ã€å¼€å‘ï¼Œæµ‹è¯•ï¼Œç”Ÿäº§ï¼šåˆ©ç”¨å‘½åç©ºé—´æ¥åšç¯å¢ƒéš”ç¦»ã€‚
		æ³¨æ„ï¼šåœ¨bootstrap.properties; éœ€è¦ä½¿ç”¨å“ªä¸ªå‘½åç©ºé—´ä¸‹çš„é…ç½®
		spring.cloud.nacos.config.namespace=9de62e44-cd2a-4a82-bf5c-95878bd5e871
	2ã€æ¯ä¸€ä¸ªå¾®æœåŠ¡ä¹‹é—´äº’ç›¸éš”ç¦»é…ç½®ï¼Œæ¯ä¸€ä¸ªå¾®æœåŠ¡éƒ½åˆ›å»ºè‡ªå·±çš„å‘½åç©ºé—´ï¼ŒåªåŠ è½½è‡ªå·±å‘½åç©ºé—´ä¸‹çš„æ‰€æœ‰é…ç½®

2ï¼‰ã€é…ç½®é›†ï¼šæ‰€æœ‰çš„é…ç½®çš„é›†åˆ

3ï¼‰ã€é…ç½®é›†IDï¼šç±»ä¼¼æ–‡ä»¶åã€‚
	 Data IDï¼šç±»ä¼¼æ–‡ä»¶å

4ï¼‰ã€é…ç½®åˆ†ç»„ï¼šé»˜è®¤æ‰€æœ‰çš„é…ç½®é›†éƒ½å±äºï¼šDEFAULT_GROUPï¼›
	1111ï¼Œ618ï¼Œ1212
	spring.cloud.nacos.config.group=prod
	
* é¡¹ç›®ä¸­çš„ä½¿ç”¨ï¼šæ¯ä¸ªå¾®æœåŠ¡åˆ›å»ºè‡ªå·±çš„å‘½åç©ºé—´ï¼Œä½¿ç”¨é…ç½®åˆ†ç»„åŒºåˆ†ç¯å¢ƒï¼Œdevï¼Œtestï¼Œprod
    spring.application.name=gulimall-coupon
    spring.cloud.nacos.config.server-addr=127.0.0.1:8848
	spring.cloud.nacos.config.namespace=9de62e44-cd2a-4a82-bf5c-95878bd5e871
	spring.cloud.nacos.config.group=prod

* åŒæ—¶åŠ è½½å¤šä¸ªé…ç½®é›†
 * 1)ã€å¾®æœåŠ¡ä»»ä½•é…ç½®ä¿¡æ¯ï¼Œä»»ä½•é…ç½®æ–‡ä»¶éƒ½å¯ä»¥æ”¾åœ¨é…ç½®ä¸­å¿ƒä¸­
 * 2ï¼‰ã€åªéœ€è¦åœ¨bootstrap.propertiesè¯´æ˜åŠ è½½é…ç½®ä¸­å¿ƒä¸­å“ªäº›é…ç½®æ–‡ä»¶å³å¯
 * 3ï¼‰ã€@Valueï¼Œ@ConfigurationPropertiesã€‚ã€‚ã€‚
 * ä»¥å‰SpringBootä»»ä½•æ–¹æ³•ä»é…ç½®æ–‡ä»¶ä¸­è·å–å€¼ï¼Œéƒ½èƒ½ä½¿ç”¨ã€‚
 * é…ç½®ä¸­å¿ƒæœ‰çš„ä¼˜å…ˆä½¿ç”¨é…ç½®ä¸­å¿ƒä¸­çš„
 
	spring.cloud.nacos.config.server-addr=127.0.0.1:8848
    spring.cloud.nacos.config.namespace=1986f4f3-69e0-43bb-859c-abe427b19f3a
    # å¦‚æœä¸æŒ‡å®šåˆ†ç»„ï¼Œé»˜è®¤DEFAULT_GROUPï¼Œå¦‚æœnaocsæ²¡æœ‰ï¼Œåˆ™åŠ è½½ç¨‹åºçš„application.properties
    spring.cloud.nacos.config.group=prod 

    spring.cloud.nacos.config.ext-config[0].data-id=datasource.yml
    spring.cloud.nacos.config.ext-config[0].group=dev
    spring.cloud.nacos.config.ext-config[0].refresh=true

    spring.cloud.nacos.config.ext-config[1].data-id=mybatis.yml
    spring.cloud.nacos.config.ext-config[1].group=dev
    spring.cloud.nacos.config.ext-config[1].refresh=true

    spring.cloud.nacos.config.ext-config[2].data-id=other.yml
    spring.cloud.nacos.config.ext-config[2].group=dev
    spring.cloud.nacos.config.ext-config[2].refresh=true
```



> æ•°æ®æŒä¹…åŒ–

å‚è€ƒï¼š[Nacos]( https://nacos.io/zh-cn/docs/deployment.html)

```
é»˜è®¤çš„æƒ…å†µä¸‹ï¼Œåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒçš„æ•°æ®å­˜æ”¾åˆ°æœ¬åœ°dataç›®å½•ä¸‹ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µå¦‚æœnacosé›†ç¾¤çš„è¯æ— æ³•ä¿è¯æ•°æ®çš„åŒæ­¥æ€§ã€‚

åœ¨0.7ç‰ˆæœ¬ä¹‹å‰ï¼Œåœ¨å•æœºæ¨¡å¼æ—¶nacosä½¿ç”¨åµŒå…¥å¼æ•°æ®åº“å®ç°æ•°æ®çš„å­˜å‚¨ï¼Œä¸æ–¹ä¾¿è§‚å¯Ÿæ•°æ®å­˜å‚¨çš„åŸºæœ¬æƒ…å†µã€‚0.7ç‰ˆæœ¬å¢åŠ äº†æ”¯æŒmysqlæ•°æ®æºèƒ½åŠ›ï¼Œå…·ä½“çš„æ“ä½œæ­¥éª¤ï¼š

1.å®‰è£…æ•°æ®åº“ï¼Œç‰ˆæœ¬è¦æ±‚ï¼š5.6.5+
2.åˆå§‹åŒ–mysqlæ•°æ®åº“ï¼Œæ•°æ®åº“åˆå§‹åŒ–æ–‡ä»¶ï¼šnacos-mysql.sql
3.ä¿®æ”¹conf/application.propertiesæ–‡ä»¶ï¼Œå¢åŠ æ”¯æŒmysqlæ•°æ®æºé…ç½®ï¼ˆç›®å‰åªæ”¯æŒmysqlï¼‰ï¼Œæ·»åŠ mysqlæ•°æ®æºçš„urlã€ç”¨æˆ·åå’Œå¯†ç ã€‚

spring.datasource.platform=mysql
db.num=1
db.url.0=jdbc:mysql://127.0.0.1:3306/nacos?characterEncoding=utf8&connectTimeout=1000&socketTimeout=3000&autoReconnect=true
db.user=root
db.password=root
```



> é›†ç¾¤é…ç½®

<img src="image\Nacosé›†ç¾¤.png" style="zoom: 50%;" />

```
ç›¸å…³é›†ç¾¤é…ç½®


åˆ›å»ºclusteræ–‡ä»¶å¤¹
---nacos-server-8848
---nacos-server-8849
---nacos-server-8850

cluster.conf
###ipå’Œç«¯å£å· ä¸è¦ç”¨127.0.0.1
192.168.1.22:8848
192.168.1.22:8849
192.168.1.22:8850


Nginxç›¸å…³é…ç½®
è½®è¯¢åˆ†å‘ç»™ä¸‰å°,å…³äºsessionå…±äº«Nacosè‡ªå·±è§£å†³äº†

å®¢æˆ·ç«¯è¿æ¥ 
spring.cloud.nacos.config.server-addr=192.168.1.22:8848

æ³¨æ„ï¼š 
1.nacosåœ¨windowsç‰ˆæœ¬ä¸‹è¿è¡Œé»˜è®¤æ˜¯å•æœºç‰ˆæœ¬ éœ€è¦æŒ‡å®šstartup.cmd -m cluster
2.nacosåœ¨linuxç‰ˆæœ¬ä¸‹è¿è¡Œé»˜è®¤æ˜¯é›†ç¾¤ç‰ˆæœ¬ å¦‚æœæƒ³è¿æ¥å•æœºç‰ˆæœ¬ startup.cmd â€“m standalone

```



> Zookeeper Eureka NacosåŒºåˆ«

```
Zookeeperé‡‡ç”¨CPä¿è¯æ•°æ®çš„ä¸€è‡´æ€§çš„é—®é¢˜ï¼ŒåŸç†é‡‡ç”¨ZabåŸå­å¹¿æ’­åè®®ï¼Œå½“æˆ‘ä»¬çš„zké¢†å¯¼å› ä¸ºæŸç§åŸå› å®•æœºçš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨å‡ºå‘é‡æ–°é€‰ä¸€ä¸ªæ–°çš„é¢†å¯¼è§’è‰²ï¼Œæ•´ä¸ªé€‰ä¸¾çš„è¿‡ç¨‹ä¸ºäº†ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§çš„é—®é¢˜ï¼Œåœ¨é€‰ä¸¾çš„è¿‡ç¨‹ä¸­æ•´ä¸ªzkç¯å¢ƒæ˜¯ä¸å¯ä»¥ä½¿ç”¨ï¼Œå¯ä»¥çŸ­æš‚å¯èƒ½æ— æ³•ä½¿ç”¨åˆ°zkï¼Œä»¥ä¸ºè€…å¾®æœåŠ¡é‡‡ç”¨è¯¥æ¨¡å¼çš„æƒ…å†µä¸‹ï¼Œå¯èƒ½æ— æ³•å®ç°é€šè®¯ã€‚(æœ¬åœ°æœ‰ç¼“å­˜é™¤å¤–)ã€‚
æ³¨æ„ï¼šå¯è¿è¡ŒèŠ‚ç‚¹å¿…é¡»æ»¡è¶³è¿‡åŠæœºåˆ¶ï¼Œæ•´ä¸ªzké‡‡ç”¨ä½¿ç”¨ã€‚
ä¸‰å°é›†ç¾¤ï¼šä¸¤å°å®•æœºï¼Œä¸€å°æ­£å¸¸ï¼Œè¿˜æ˜¯æ²¡æ³•ä½¿ç”¨éœ€è¦è¿‡åŠé€‰ä¸¾ã€‚
zadåè®®é€šè¿‡æ¯”è¾ƒmyid è°æœ€å¤§è°ä¸ºé¢†å¯¼è§’è‰²ï¼Œåªè¦æ»¡è¶³è¿‡åŠæœºåˆ¶å°±å¯ä»¥ç§°ä¸ºé¢†å¯¼è€…ã€‚
å¦‚ä½•åŠè¯æ•°æ®ä¸€è‡´æ€§ï¼Œæ‰€æœ‰å†™çš„è¯·æ±‚éƒ½äº¤ç»™æˆ‘ä»¬é¢†å¯¼è§’è‰²å®ç°ï¼Œé¢†å¯¼å†™å®Œï¼Œå†å°†æ•°æ®åŒæ­¥æ¯ä¸ªèŠ‚ç‚¹(ä¹Ÿå°±æ˜¯è¯´,é€‰ä¸¾è¿‡ç¨‹ä¸­ä¸èƒ½æ³¨å†ŒæœåŠ¡)


Eurekaé‡‡ç”¨apçš„è®¾è®¡ç†å¿µæ¶æ„æ³¨å†Œä¸­å¿ƒï¼Œå®Œå…¨å»ä¸­å¿ƒåŒ–æ€æƒ³ï¼Œä¹Ÿå°±æ˜¯æ²¡æœ‰ä¸»ä»ä¹‹åˆ†ã€‚æ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯å‡ç­‰ï¼Œé‡‡ç”¨ç›¸äº’æ³¨å†ŒåŸç†ï¼Œä½ ä¸­æœ‰æˆ‘æˆ‘ä¸­ä½ ï¼Œåªè¦æœ€åæœ‰ä¸€ä¸ªeurekaèŠ‚ç‚¹å­˜åœ¨å°±å¯ä»¥ä¿è¯æ•´ä¸ªå¾®æœåŠ¡å¯ä»¥å®ç°é€šè®¯ã€‚ç›¸äº’æ³¨å†Œ


Nacosä¸EurekaåŒºåˆ«.

Nacos.ä»1.0ç‰ˆæœ¬æ”¯æŒCPå’ŒAPæ··åˆæ¨¡å¼é›†ç¾¤ï¼Œé»˜è®¤æ˜¯é‡‡ç”¨Apä¿è¯æœåŠ¡å¯ç”¨æ€§ï¼ŒCPçš„å½¢å¼åº•å±‚é›†ç¾¤raftåè®®ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§çš„é—®é¢˜ã€‚
å¦‚æœæˆ‘ä»¬é‡‡ç”¨Apæ¨¡å¼æ³¨å†ŒæœåŠ¡çš„å®ä¾‹ä»…æ”¯æŒä¸´æ—¶æ³¨å†Œå½¢å¼ï¼Œåœ¨ç½‘ç»œåˆ†åŒºäº§ç”ŸæŠ–åŠ¨çš„æƒ…å†µæ­£ä»»ç„¶è¿˜å¯ä»¥ç»§ç»­æ³¨å†Œæˆ‘ä»¬çš„æœåŠ¡åˆ—è¡¨ã€‚
é‚£ä¹ˆé€‰æ‹©CPæ¨¡å¼å¿…é¡»ä¿è¯æ•°æ®çš„å¼ºä¸€è‡´æ€§çš„é—®é¢˜ï¼Œå¦‚æœç½‘ç»œåˆ†åŒºäº§ç”ŸæŠ–åŠ¨çš„æƒ…å†µä¸‹ï¼Œæ˜¯æ— æ³•æ³¨å†Œæˆ‘ä»¬çš„æœåŠ¡åˆ—è¡¨ã€‚é€‰æ‹©CPæ¨¡å¼å¯ä»¥æ”¯æŒæ³¨å†Œå®ä¾‹æŒä¹…ã€‚

```



#### Feign

> Feignè¿œç¨‹è°ƒç”¨(openFeign)

```
1.å¼•å…¥ä¾èµ–
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-openfeign</artifactId>
    </dependency>

2.å¼€å¯feignåŠŸèƒ½
	@EnableFeignClients(basePackages = "com.atguigu.gulimall.member.feign")
    @EnableDiscoveryClient
    @SpringBootApplication
    public class Application {
        public static void main(String[] args) {
            SpringApplication.run(Application.class, args);
        }
    }
    
3.å£°æ˜è¿œç¨‹æ¥å£
    @FeignClient("gulimall-coupon")
    public interface CouponFeignService {
        @RequestMapping("/coupon/coupon/member/list")
        public R membercoupons();
    }
```



#### GateWay

> Spring Cloud GateWay

```
å¾®æœåŠ¡
å¾®æœåŠ¡ç½‘å…³æ˜¯æ•´ä¸ªå¾®æœåŠ¡APIè¯·æ±‚çš„å…¥å£ï¼Œå¯ä»¥å®ç°æ—¥å¿—æ‹¦æˆªã€æƒé™æ§åˆ¶ã€è§£å†³è·¨åŸŸé—®é¢˜ã€é™æµã€ç†”æ–­ã€è´Ÿè½½å‡è¡¡ã€é»‘åå•ä¸ç™½åå•æ‹¦æˆªã€æˆæƒç­‰
    
è¿‡æ»¤å™¨ä¸ç½‘å…³çš„åŒºåˆ«    
è¿‡æ»¤å™¨ç”¨äºæ‹¦æˆªå•ä¸ªæœåŠ¡
ç½‘å…³æ‹¦æˆªæ•´ä¸ªçš„å¾®æœåŠ¡

Zuulä¸Gatewayæœ‰é‚£äº›åŒºåˆ«
Zuulç½‘å…³å±äºnetfixå…¬å¸å¼€æºçš„äº§å“å±äºç¬¬ä¸€ä»£å¾®æœåŠ¡ç½‘å…³
Gatewayå±äºSpringCloudè‡ªç ”å‘çš„ç¬¬äºŒä»£å¾®æœåŠ¡ç½‘å…³
ç›¸æ¯”æ¥è¯´SpringCloud Gatewayæ€§èƒ½æ¯”Zuulæ€§èƒ½è¦å¥½ï¼š
æ³¨æ„ï¼šZuulåŸºäºServletå®ç°çš„ï¼Œé˜»å¡å¼çš„Apiï¼Œä¸æ”¯æŒé•¿è¿æ¥ã€‚
SpringCloudGatewayåŸºäºSpring5æ„å»ºï¼Œèƒ½å¤Ÿå®ç°å“åº”å¼éé˜»å¡å¼çš„Apiï¼Œæ”¯æŒé•¿è¿æ¥ï¼Œèƒ½å¤Ÿæ›´å¥½çš„æ•´åˆSpringä½“ç³»çš„äº§å“ã€‚

keep+keepAlived
Nignx Nignx Nignx
Gateway Gateway Gateway
è®¢å•æœåŠ¡ ä¼šå‘˜æœåŠ¡ ç§¯åˆ†æœåŠ¡ å•†å“æœåŠ¡
```



```
æ„æˆ
    1.route		è·¯ç”±
    2.predicate æ–­è¨€
    3.Filter	è¿‡æ»¤
    * æ–­è¨€æ¡ä»¶åˆ¤æ–­æˆåŠŸ è·¯ç”±å†ç»è¿‡ä¸€äº›è¿‡æ»¤ï¼Œæœ€ç»ˆåˆ°ç›¸å¯¹åº”çš„è¯·æ±‚
    
    
ä½¿ç”¨

	1.å¼•å…¥ä¾èµ–
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-starter-gateway</artifactId>
        </dependency>
        
	2.æ³¨å†ŒæœåŠ¡
		@EnableDiscoveryClient
        @SpringBootApplication(exclude = {DataSourceAutoConfiguration.class}) #æ’é™¤æ•°æ®æº
        public class Application {
            public static void main(String[] args) {
                SpringApplication.run(Application.class, args);
            }
        }
        
	3.æ·»åŠ bootstrap.propertiesé…ç½®
		spring.application.name=gulimall-coupon
        spring.cloud.nacos.config.server-addr=127.0.0.1:8848
        spring.cloud.nacos.config.namespace=b5d62415-0dea-4747-a65d-874cc6203bf2
        
	4.application.ymlç½‘å…³é…ç½®
		spring:
      cloud:
        gateway:
          routes:
    #        - id: test_route
    #          uri: https://www.baidu.com
    #          predicates:
    #            - Query=url,baidu
    #
    #        - id: qq_route
    #          uri: https://www.qq.com
    #          predicates:
    #            - Query=url,qq
	
```



#### Sentinel

> æœåŠ¡é™æµ/ç†”æ–­

```
æœåŠ¡é™æµç›®çš„æ˜¯ä¸ºäº†æ›´å¥½çš„ä¿æŠ¤æˆ‘ä»¬çš„æœåŠ¡ï¼Œåœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå¦‚æœå®¢æˆ·ç«¯è¯·æ±‚çš„æ•°é‡è¾¾åˆ°ä¸€å®šæé™ï¼ˆåå°å¯ä»¥é…ç½®é˜ˆå€¼ï¼‰ï¼Œè¯·æ±‚çš„æ•°é‡è¶…å‡ºäº†è®¾ç½®çš„é˜ˆå€¼ï¼Œå¼€å¯è‡ªæˆ‘çš„ä¿æŠ¤ï¼Œç›´æ¥è°ƒç”¨æˆ‘ä»¬çš„æœåŠ¡é™çº§çš„æ–¹æ³•ï¼Œä¸ä¼šæ‰§è¡Œä¸šåŠ¡é€»è¾‘æ“ä½œï¼Œç›´æ¥èµ°æœ¬åœ°falbackçš„æ–¹æ³•ï¼Œè¿”å›ä¸€ä¸ªå‹å¥½çš„æç¤ºã€‚
```



> æœåŠ¡é™çº§

```
åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œé˜²æ­¢ç”¨æˆ·ä¸€ç›´ç­‰å¾…ï¼Œé‡‡ç”¨é™æµ/ç†”æ–­æ–¹æ³•ï¼Œä½¿ç”¨æœåŠ¡é™çº§çš„æ–¹å¼è¿”å›ä¸€ä¸ªå‹å¥½çš„æç¤ºç»™å®¢æˆ·ç«¯ï¼Œä¸ä¼šæ‰§è¡Œä¸šåŠ¡é€»è¾‘è¯·æ±‚ï¼Œç›´æ¥èµ°æœ¬åœ°çš„falbackçš„æ–¹æ³•ã€‚
æç¤ºè¯­ï¼šå½“å‰æ’é˜Ÿäººæ•°è¿‡å¤šï¼Œç¨åé‡è¯•~
```



> æœåŠ¡çš„é›ªå´©æ•ˆåº”

```
é»˜è®¤çš„æƒ…å†µä¸‹ï¼ŒTomcatæˆ–è€…æ˜¯JettyæœåŠ¡å™¨åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ± å»å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œ
è¿™æ ·çš„è¯å°±æ˜¯åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œå¦‚æœå®¢æˆ·ç«¯æ‰€æœ‰çš„è¯·æ±‚éƒ½å †ç§¯åˆ°åŒä¸€ä¸ªæœåŠ¡æ¥å£ä¸Šï¼Œ 
é‚£ä¹ˆå°±ä¼šäº§ç”ŸtomcatæœåŠ¡å™¨æ‰€æœ‰çš„çº¿ç¨‹éƒ½åœ¨å¤„ç†è¯¥æ¥å£ï¼Œå¯èƒ½ä¼šå¯¼è‡´å…¶ä»–çš„æ¥å£æ— æ³•è®¿é—®ã€‚


å‡è®¾æˆ‘ä»¬çš„tomcatçº¿ç¨‹æœ€å¤§çš„çº¿ç¨‹æ•°é‡æ˜¯ä¸º20ï¼Œè¿™æ—¶å€™å®¢æˆ·ç«¯å¦‚æœåŒæ—¶å‘é€100ä¸ªè¯·æ±‚ä¼šå¯¼è‡´æœ‰80ä¸ªè¯·æ±‚æš‚æ—¶æ— æ³•è®¿é—®ï¼Œå°±ä¼šè½¬åœˆã€‚
```



>æœåŠ¡çš„éš”ç¦»çš„æœºåˆ¶

```
æœåŠ¡çš„éš”ç¦»æœºåˆ¶åˆ†ä¸ºä¿¡å·é‡å’Œçº¿ç¨‹æ± éš”ç¦»æ¨¡å¼
æœåŠ¡çš„çº¿ç¨‹æ± éš”ç¦»æœºåˆ¶ï¼šæ¯ä¸ªæœåŠ¡æ¥å£éƒ½æœ‰è‡ªå·±ç‹¬ç«‹çš„çº¿ç¨‹æ± ï¼Œäº’ä¸å½±å“ï¼Œç¼ºç‚¹å°±æ˜¯å ç”¨cpuèµ„æºéå¸¸å¤§ã€‚
æœåŠ¡çš„ä¿¡å·é‡éš”ç¦»æœºåˆ¶ï¼šæœ€å¤šåªæœ‰ä¸€å®šçš„é˜ˆå€¼çº¿ç¨‹æ•°å¤„ç†æˆ‘ä»¬çš„è¯·æ±‚ï¼Œè¶…è¿‡è¯¥é˜ˆå€¼ä¼šæ‹’ç»è¯·æ±‚ã€‚
```



### SOA

```
SOAåªæ˜¯ä¸€ç§æ¶æ„è®¾è®¡æ¨¡å¼ï¼Œè€ŒSOAPã€RESTã€RPCå°±æ˜¯æ ¹æ®è¿™ç§è®¾è®¡æ¨¡å¼æ„å»ºå‡ºæ¥çš„è§„èŒƒï¼Œ
å…¶ä¸­SOAPé€šä¿—ç†è§£å°±æ˜¯http+xmlçš„å½¢å¼ï¼Œ
RESTå°±æ˜¯http+jsonçš„å½¢å¼ï¼Œ
RPCæ˜¯åŸºäºsocketçš„å½¢å¼ã€‚
ä¸Šæ–‡æåˆ°çš„CXFå°±æ˜¯å…¸å‹çš„SOAP/RESTæ¡†æ¶ï¼Œdubboå°±æ˜¯å…¸å‹çš„RPCæ¡†æ¶ï¼Œè€ŒSpringCloudå°±æ˜¯éµå®ˆRESTè§„èŒƒçš„ç”Ÿæ€ç³»ç»Ÿã€‚
```



### RPC

```
RPCã€Remote Procedure Callã€‘æ˜¯æŒ‡è¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼Œæ˜¯ä¸€ç§è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ï¼Œä»–æ˜¯ä¸€ç§æŠ€æœ¯çš„æ€æƒ³ï¼Œè€Œä¸æ˜¯è§„èŒƒã€‚å®ƒå…è®¸ç¨‹åºè°ƒç”¨å¦ä¸€ä¸ªåœ°å€ç©ºé—´ï¼ˆé€šå¸¸æ˜¯å…±äº«ç½‘ç»œçš„å¦ä¸€å°æœºå™¨ä¸Šï¼‰çš„è¿‡ç¨‹æˆ–å‡½æ•°ï¼Œè€Œä¸ç”¨ç¨‹åºå‘˜æ˜¾å¼ç¼–ç è¿™ä¸ªè¿œç¨‹è°ƒç”¨çš„ç»†èŠ‚ã€‚å³ç¨‹åºå‘˜æ— è®ºæ˜¯è°ƒç”¨æœ¬åœ°çš„è¿˜æ˜¯è¿œç¨‹çš„å‡½æ•°ï¼Œæœ¬è´¨ä¸Šç¼–å†™çš„è°ƒç”¨ä»£ç åŸºæœ¬ç›¸åŒã€‚

RPCä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ï¼šé€šè®¯ï¼Œåºåˆ—åŒ–
```

![1588055070462](\image\RPCæµç¨‹.png)

![1588055177701](\image\RPCæ ¸å¿ƒæµç¨‹.png)







### Dubbo + Zookeeper

```
Apache Dubboæ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ã€è½»é‡çº§çš„å¼€æºJava RPCæ¡†æ¶ï¼Œå®ƒæä¾›äº†ä¸‰å¤§æ ¸å¿ƒèƒ½åŠ›ï¼šé¢å‘æ¥å£çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œæ™ºèƒ½å®¹é”™å’Œè´Ÿè½½å‡è¡¡ï¼Œä»¥åŠæœåŠ¡è‡ªåŠ¨æ³¨å†Œå’Œå‘ç°ã€‚
é˜¿é‡Œ2014å¹´åœæ›´ï¼Œåæ¥ä¸å½“å½“ç½‘çš„ç‰ˆæœ¬DubboXæ•´åˆï¼Œåœ¨2018å¹´å¼€æºç»™äº†apache

ç‰¹æ€§
1.é¢å‘æ¥å£ä»£ç†çš„é«˜æ€§èƒ½RPCè°ƒç”¨
2.æœåŠ¡è‡ªåŠ¨æ³¨å†Œä¸å‘ç°
3.æ™ºèƒ½è´Ÿè½½å‡è¡¡
4.é«˜åº¦å¯æ‰©å±•
5.è¿è¡ŒæœŸé—´æµé‡è°ƒåº¦(å¤šç‰ˆæœ¬)
6.å¯è§†åŒ–çš„æœåŠ¡æ²»ç†ä¸è¿ç»´
```

<img src="\image\DubboåŸºæœ¬æ¦‚å¿µ.png" alt=" " style="zoom:60%;" />

> åŸºæœ¬æ¦‚å¿µ

```
æœåŠ¡æä¾›è€…(Provider): æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ï¼ŒæœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚

æœåŠ¡æ¶ˆè´¹è€…(Consumer): è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ï¼ŒæœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚

æ³¨å†Œä¸­å¿ƒ(Registry): æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…

ç›‘æ§ä¸­å¿ƒ(Monitor): æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒ
```



> è°ƒç”¨å…³ç³»

```
1.æœåŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚
2.æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚
3.æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚
4.æ³¨å†Œä¸­å¿ƒè¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚
5.æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚
6.æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚
```



> zookeeperå®•æœºä¸dubboç›´è¿

```
zookeeperæ³¨å†Œä¸­å¿ƒå®•æœºï¼Œè¿˜å¯ä»¥æ¶ˆè´¹dubboæš´éœ²çš„æœåŠ¡ã€‚

1.ç›‘æ§ä¸­å¿ƒå®•æ‰ä¸å½±å“ä½¿ç”¨ï¼Œåªæ˜¯ä¸¢å¤±éƒ¨åˆ†é‡‡æ ·æ•°æ®
2.æ•°æ®åº“å®•æ‰åï¼Œæ³¨å†Œä¸­å¿ƒä»èƒ½é€šè¿‡ç¼“å­˜æä¾›æœåŠ¡åˆ—è¡¨æŸ¥è¯¢ï¼Œä½†ä¸èƒ½æ³¨å†Œæ–°æœåŠ¡
3.æ³¨å†Œä¸­å¿ƒå¯¹ç­‰é›†ç¾¤ï¼Œä»»æ„ä¸€å°å®•æ‰åï¼Œå°†è‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€å°
4.æ³¨å†Œä¸­å¿ƒå…¨éƒ¨å®•æ‰åï¼ŒæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ä»èƒ½é€šè¿‡æœ¬åœ°ç¼“å­˜é€šè®¯
5.æœåŠ¡æä¾›è€…æ— çŠ¶æ€ï¼Œä»»æ„ä¸€å°å®•æ‰åï¼Œä¸å½±å“ä½¿ç”¨
6.æœåŠ¡æä¾›è€…å…¨éƒ¨å®•æ‰åï¼ŒæœåŠ¡æ¶ˆè´¹è€…åº”ç”¨å°†æ— æ³•ä½¿ç”¨ï¼Œå¹¶æ— é™æ¬¡é‡è¿ç­‰å¾…æœåŠ¡æä¾›è€…æ¢å¤


æ²¡æœ‰æ³¨å†Œä¸­å¿ƒçš„dubboç›´è¿

@Reference(url="127.0.0.1:20882")
UserSerice userSerice;
```



> é›†ç¾¤ä¸‹dubboè´Ÿè½½å‡è¡¡é…ç½®

```
Random LoadBalance
éšæœºï¼ŒæŒ‰æƒé‡è®¾ç½®éšæœºæ¦‚ç‡ã€‚
åœ¨ä¸€ä¸ªæˆªé¢ä¸Šç¢°æ’çš„æ¦‚ç‡é«˜ï¼Œä½†è°ƒç”¨é‡è¶Šå¤§åˆ†å¸ƒè¶Šå‡åŒ€ï¼Œè€Œä¸”æŒ‰æ¦‚ç‡ä½¿ç”¨æƒé‡åä¹Ÿæ¯”è¾ƒå‡åŒ€ï¼Œæœ‰åˆ©äºåŠ¨æ€è°ƒæ•´æä¾›è€…æƒé‡ã€‚

RoundRobin LoadBalance
è½®å¾ªï¼ŒæŒ‰å…¬çº¦åçš„æƒé‡è®¾ç½®è½®å¾ªæ¯”ç‡ã€‚
å­˜åœ¨æ…¢çš„æä¾›è€…ç´¯ç§¯è¯·æ±‚çš„é—®é¢˜ï¼Œæ¯”å¦‚ï¼šç¬¬äºŒå°æœºå™¨å¾ˆæ…¢ï¼Œä½†æ²¡æŒ‚ï¼Œå½“è¯·æ±‚è°ƒåˆ°ç¬¬äºŒå°æ—¶å°±å¡åœ¨é‚£ï¼Œä¹…è€Œä¹…ä¹‹ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½å¡åœ¨è°ƒåˆ°ç¬¬äºŒå°ä¸Šã€‚

LeastActive LoadBalance
æœ€å°‘æ´»è·ƒè°ƒç”¨æ•°ï¼Œç›¸åŒæ´»è·ƒæ•°çš„éšæœºï¼Œæ´»è·ƒæ•°æŒ‡è°ƒç”¨å‰åè®¡æ•°å·®ã€‚
ä½¿æ…¢çš„æä¾›è€…æ”¶åˆ°æ›´å°‘è¯·æ±‚ï¼Œå› ä¸ºè¶Šæ…¢çš„æä¾›è€…çš„è°ƒç”¨å‰åè®¡æ•°å·®ä¼šè¶Šå¤§ã€‚

ConsistentHash LoadBalance
ä¸€è‡´æ€§ Hashï¼Œç›¸åŒå‚æ•°çš„è¯·æ±‚æ€»æ˜¯å‘åˆ°åŒä¸€æä¾›è€…ã€‚
å½“æŸä¸€å°æä¾›è€…æŒ‚æ—¶ï¼ŒåŸæœ¬å‘å¾€è¯¥æä¾›è€…çš„è¯·æ±‚ï¼ŒåŸºäºè™šæ‹ŸèŠ‚ç‚¹ï¼Œå¹³æ‘Šåˆ°å…¶å®ƒæä¾›è€…ï¼Œä¸ä¼šå¼•èµ·å‰§çƒˆå˜åŠ¨ã€‚ç®—æ³•å‚è§ï¼šhttp://en.wikipedia.org/wiki/Consistent_hashing
ç¼ºçœåªå¯¹ç¬¬ä¸€ä¸ªå‚æ•° Hashï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® <dubbo:parameter key="hash.arguments" value="0,1" />
ç¼ºçœç”¨ 160 ä»½è™šæ‹ŸèŠ‚ç‚¹ï¼Œå¦‚æœè¦ä¿®æ”¹ï¼Œè¯·é…ç½® <dubbo:parameter key="hash.nodes" value="320" />
```



### WebSocket 

å‚è€ƒï¼š[WebSocket](http://www.ruanyifeng.com/blog/2017/05/websocket.html) [WebSocket](https://www.runoob.com/html/html5-websocket.html)

```
HTTP åè®®æœ‰ä¸€ä¸ªç¼ºé™·ï¼šé€šä¿¡åªèƒ½ç”±å®¢æˆ·ç«¯å‘èµ·ã€‚

WebSocketå®ƒçš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯ï¼ŒæœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¨é€ä¿¡æ¯ï¼Œå®¢æˆ·ç«¯ä¹Ÿå¯ä»¥ä¸»åŠ¨å‘æœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œæ˜¯çœŸæ­£çš„åŒå‘å¹³ç­‰å¯¹è¯ï¼Œå±äºæœåŠ¡å™¨æ¨é€æŠ€æœ¯çš„ä¸€ç§ã€‚
```





### Mycatåˆ†åº“åˆ†è¡¨

> ä¸ºä»€ä¹ˆä½¿ç”¨Mycat  ->  æµç¨‹å›¾ç±»ä¼¼Nginx

```
1.Javaä¸æ•°æ®åº“ç´§è€¦åˆ
2.é«˜è®¿é—®é‡é«˜å¹¶å‘å¯¹æ•°æ®åº“å‹åŠ›
3.è¯»å†™è¯·æ±‚æ•°æ®ä¸ä¸€è‡´


1.è¯»å†™åˆ†ç¦»
2.æ•°æ®åˆ†ç‰‡(æ•°æ®åº“åˆ†å¸ƒå¼)
	å‚ç›´æ‹†åˆ†:åˆ†åº“
	æ°´å¹³æ‹†åˆ†:åˆ†è¡¨
3.å¤šæ•°æ®æºæ•´åˆ
```



> åŸç†

![](./image\mycatåŸç†.png)

```
Mycat çš„åŸç†ä¸­æœ€é‡è¦çš„ä¸€ä¸ªåŠ¨è¯æ˜¯â€œæ‹¦æˆªâ€ï¼Œå®ƒæ‹¦æˆªäº†ç”¨æˆ·å‘é€è¿‡æ¥çš„ SQL è¯­å¥
é¦–å…ˆå¯¹SQLè¯­å¥åšäº†ä¸€äº›ç‰¹å®šçš„åˆ†æï¼šå¦‚åˆ†ç‰‡åˆ†æã€è·¯ç”±åˆ†æã€è¯»å†™åˆ†ç¦»åˆ†æã€ç¼“å­˜åˆ†æç­‰
ç„¶åå°†æ­¤ SQLå‘å¾€åç«¯çš„çœŸå®æ•°æ®åº“ï¼Œå¹¶å°†è¿”å›çš„ç»“æœåšé€‚å½“çš„å¤„ç†ï¼Œæœ€ç»ˆå†è¿”å›ç»™ç”¨æˆ·ã€‚

è¿™ç§æ–¹å¼æŠŠæ•°æ®åº“çš„åˆ†å¸ƒå¼ä»ä»£ç ä¸­è§£è€¦å‡ºæ¥ï¼Œç¨‹åºå‘˜å¯Ÿè§‰ä¸å‡ºæ¥åå°ä½¿ç”¨Mycatè¿˜æ˜¯MySQL
```





### ElasticSearch

#### 2.1.ä»‹ç»

```
1.ESæ˜¯ä¸€ä¸ªä½¿ç”¨Javaè¯­è¨€å¹¶ä¸”åŸºäºLuceneç¼–å†™çš„æœç´¢å¼•æ“æ¡†æ¶ï¼Œä»–æä¾›äº†åˆ†å¸ƒå¼çš„å…¨æ–‡æœç´¢åŠŸèƒ½ï¼Œæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„åŸºäºRESTfulé£æ ¼çš„WEBæ¥å£ï¼Œå®˜æ–¹å®¢æˆ·ç«¯ä¹Ÿå¯¹å¤šç§è¯­è¨€éƒ½æä¾›äº†ç›¸åº”çš„APIã€‚

2.Lucene: Luceneæœ¬èº«å°±æ˜¯ä¸€ä¸ªæœç´¢å¼•æ“çš„åº•å±‚ã€‚

3.åˆ†å¸ƒå¼:ESä¸»è¦æ˜¯ä¸ºäº†çªå‡ºä»–çš„æ¨ªå‘æ‰©å±•èƒ½åŠ›ã€‚

4.å…¨æ–‡æ£€ç´¢:å°†ä¸€æ®µè¯è¯­è¿›è¡Œåˆ†è¯ï¼Œå¹¶ä¸”å°†åˆ†å‡ºçš„å•ä¸ªè¯è¯­ç»Ÿä¸€çš„æ”¾åˆ°ä¸€ä¸ªåˆ†è¯åº“ä¸­ï¼Œåœ¨æœç´¢æ—¶ï¼Œæ ¹æ®å…³é”®å­—å»åˆ†è¯åº“ä¸­æ£€ç´¢ï¼Œæ‰¾åˆ°åŒ¹é…çš„å†…å®¹ã€‚(å€’æ’ç´¢å¼•)

5.RESTfulé£æ ¼çš„WEBæ¥å£ï¸°æ“ä½œESå¾ˆç®€å•ï¼Œåªéœ€è¦å‘é€ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œå¹¶ä¸”æ ¹æ®è¯·æ±‚æ–¹å¼çš„ä¸åŒï¼Œæºå¸¦å‚æ•°çš„åŒï¼Œæ‰§è¡Œç›¸åº”çš„åŠŸèƒ½ã€‚

6.åº”ç”¨å¹¿æ³›:Github.comï¼ŒWIKI,Gold Manç”¨ESæ¯å¤©ç»´æŠ¤å°†è¿‘10TBçš„æ•°æ®ã€‚
```



#### 2.2.ä¸Solrå¯¹æ¯”

```
Solråœ¨æŸ¥è¯¢æ­»æ•°æ®æ—¶ï¼Œé€Ÿåº¦ç›¸å¯¹ESæ›´å¿«ä¸€äº›ã€‚ä½†æ˜¯æ•°æ®å¦‚æœæ˜¯å®æ—¶æ”¹å˜çš„ï¼ŒSolrçš„æŸ¥è¯¢é€Ÿåº¦ä¼šé™ä½å¾ˆå¤šï¼ŒESçš„æŸ¥è¯¢çš„æ•ˆç‡åŸºæœ¬æ²¡æœ‰å˜åŒ–ã€‚

Solræ­å»ºåŸºäºéœ€è¦ä¾èµ–Zookeeperæ¥å¸®åŠ©ç®¡ç†ã€‚ESæœ¬èº«å°±æ”¯æŒé›†ç¾¤çš„æ­å»ºï¼Œä¸éœ€è¦ç¬¬ä¸‰æ–¹çš„ä»‹å…¥ã€‚

æœ€å¼€å§‹Solrçš„ç¤¾åŒºå¯ä»¥è¯´æ˜¯éå¸¸ç«çˆ†ï¼Œé’ˆå¯¹å›½å†…çš„æ–‡æ¡£å¹¶ä¸æ˜¯å¾ˆå¤šã€‚åœ¨ESå‡ºç°ä¹‹åï¼ŒESçš„ç¤¾åŒºç«çˆ†ç¨‹åº¦ç›´çº¿ä¸Šå‡ï¼ŒESçš„æ–‡æ¡£éå¸¸å¥å…¨ã€‚

ESå¯¹ç°åœ¨äº‘è®¡ç®—å’Œå¤§æ•°æ®æ”¯æŒçš„ç‰¹åˆ«å¥½ã€‚
```



#### 2.3.å€’æ’ç´¢å¼•

```
å°†å­˜æ”¾çš„æ•°æ®ï¼Œä»¥ä¸€å®šçš„æ–¹å¼è¿›è¡Œåˆ†è¯ï¼Œå¹¶ä¸”å°†åˆ†è¯çš„å†…å®¹å­˜æ”¾åˆ°ä¸€ä¸ªå•ç‹¬çš„åˆ†è¯åº“ä¸­ã€‚

å½“ç”¨æˆ·å»æŸ¥è¯¢æ•°æ®æ—¶ï¼Œä¼šå°†ç”¨æˆ·çš„æŸ¥è¯¢å…³é”®å­—è¿›è¡Œåˆ†è¯ã€‚

ç„¶åå»åˆ†è¯åº“ä¸­åŒ¹é…å†…å®¹ï¼Œæœ€ç»ˆå¾—åˆ°æ•°æ®çš„idæ ‡è¯†ã€‚

æ ¹æ®idæ ‡è¯†å»å­˜æ”¾æ•°æ®çš„ä½ç½®æ‹‰å–åˆ°æŒ‡å®šçš„æ•°æ®ã€‚
```



> docker-compose.yml

åœ¨docker-compose.ymlåŒç›®å½•ä¸‹æ‰§è¡Œ `docker-compose up -d`

```yml
version: "3.1"
services: 
  elasticsearch: 
    image: daocloud.io/library/elasticsearch:6.5.4
    restart: always
    container_name: elasticsearch
    ports:
     - 9200:9200
  kibana: 
    image: daocloud.io/library/kibana:6.5.4
    restart: always
    container_name: kibana
    ports: 
     - 5601:5601
    environment: 
     - elasticsearch_url=http://192.168.199.109:9200
    depends_on:
     - elasticsearch
```

















***

æŠ€â€ƒæœ¯â€ƒæ— â€ƒä»– ï¼Œå”¯â€ƒæœ‰â€ƒç†Ÿâ€ƒå°”ã€‚
çŸ¥â€ƒå…¶â€ƒç„¶		 ï¼Œä¹Ÿâ€ƒçŸ¥â€ƒå…¶â€ƒæ‰€â€ƒä»¥â€ƒç„¶ã€‚
è¸â€ƒå®â€ƒä¸€â€ƒäº› ï¼Œä¸â€ƒè¦â€ƒç€â€ƒæ€¥ï¼Œ ä½ â€ƒæƒ³â€ƒè¦â€ƒçš„â€ƒå²â€ƒæœˆâ€ƒéƒ½â€ƒä¼šâ€ƒç»™â€ƒä½ ã€‚

***